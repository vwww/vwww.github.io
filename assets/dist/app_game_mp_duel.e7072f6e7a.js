(()=>{"use strict";var e,t,s,i,r={151(e,t,s){s(1);var i,r,o,l,a,n,c,h,p=s(2),d=s(108),u=s(127),m=s(128),g=s(130),f=s(131),v=s(132),y=s(133),b=s(134),S=s(139);function x(e){return(e=e.replace(/[^\w ]/,"").replace(/ {2,}/," ").trim().slice(0,20))||"unnamed"}function w(){let e=new S.k(new Uint8Array([0,1,2,3,4,5,6,7]));console.log("%cMultiplayer Game Bug Report Guide","font-family:helvetica; font-size:20px"),console.log("You're probably trying to debug a network error or file a bug report for it."),console.log("If you see an error like this, your report must contain the packet values:"),console.log("example",e.debugBuf,e),console.log("In the example above, you would have to submit at least [0, 1, 2, 3, 4, 5, 6, 7] (expand stuff as needed)")}function E(e,t){return e?`${e.name} (${e.cn})`:`<unknown${void 0===t?"":` (${t})`}>`}var T=s(141);class k{#e=p.state(-1);get cn(){return p.get(this.#e)}set cn(e){p.set(this.#e,e,!0)}#t=p.state("unnamed");get name(){return p.get(this.#t)}set name(e){p.set(this.#t,e,!0)}#s=p.state(!1);get active(){return p.get(this.#s)}set active(e){p.set(this.#s,e,!0)}#i=p.state(0);get rank(){return p.get(this.#i)}set rank(e){p.set(this.#i,e,!0)}#r=p.state(-1);get ping(){return p.get(this.#r)}set ping(e){p.set(this.#r,e,!0)}formatName(){return`${this.name} (${this.cn})`}processJoin(e,t){this.cn=e,this.ping=t.getInt(),this.name=x(t.getString(20))}readWelcome(e){let t=e.getInt();this.active=!!(1&t),this.name=x(e.getString(20)),this.ping=t>>1}}class A{#o;get canReset(){return p.get(this.#o)}set canReset(e){p.set(this.#o,e)}chat;PROTOCOL_VERSION=0;#l=p.state();get room(){return p.get(this.#l)}set room(e){p.set(this.#l,e,!0)}localClient;clients=[];#a=p.state(p.proxy([]));get leaderboard(){return p.get(this.#a)}set leaderboard(e){p.set(this.#a,e,!0)}#n=p.state(p.proxy([]));get spectators(){return p.get(this.#n)}set spectators(e){p.set(this.#n,e,!0)}constructor(e){this.chat=e,this.localClient=this.newClient(),this.#o=p.derived(()=>this.room&&this.localClient.canResetScore()),setTimeout(w,100)}setupGame(e){this.room?.disconnect(),this.room=e,e.registerRecv(t=>{if(this.room===e){let e=new S.k(t);try{for(;e.remaining>0;){let t=e.getInt(),s=this.MESSAGE_HANDLERS[t];if(!s)throw Error("tag type "+t);s.call(this,e)}}catch(t){console.error("neterr",t),console.log(e.debugBuf,e),this.room.disconnect()}}}),e.registerDisc(()=>{this.room===e?(this.chat.addSysMessage("You disconnected."),this.room=void 0):this.chat.addSysMessage("You disconnected from the old room.")}),this.chat.addSysMessage("You are joining the game.")}leaveGame(){this.room?.disconnect()}sendf(e,...t){this.room?.send(new T.U().putFmt(e,...t).toArray())}updatePlayers(){var e,t;let s,i;this.leaderboard=(e=this.clients,t=this.playersSortProps,s=e.filter(e=>e).sort((e,s)=>{for(let i of t){let t=i(e),r=i(s);if(t<r)return 1;if(t>r)return -1}return e.cn-s.cn}),i=1,s.forEach((e,r)=>{if(r){let o=s[r-1];t.some(t=>t(e)!==t(o))&&(i=r+1)}s[r].rank=i}),s.sort((e,t)=>t.active-e.active))}processWelcome(e){let t=e.getInt();t!==this.PROTOCOL_VERSION&&alert(`different protocol version (client: ${this.PROTOCOL_VERSION}, server: ${t})
refresh the page for updates?`),this.clients.length=0;let s=e.getCN();this.processWelcomeMode(e);for(let t=0;t<=64;t++){let t=e.getCN();if(t<0)break;let i=t===s?this.localClient:this.newClient();i.cn=t,i.readWelcome(e),this.clients[t]=i}this.processWelcomeGame(e),this.spectators=this.clients.filter(e=>!e.active),this.updatePlayers()}processJoin(e){let t=e.getCN();if(this.clients[t])throw Error("invalid join cn "+t);let s=this.newClient();s.processJoin(t,e),this.clients[t]=s,this.chat.playerJoined(s.formatName()),this.updatePlayers()}processLeave(e){let t=e.getCN(),s=this.clients[t];if(!s)throw Error("invalid leave cn "+t);s.active&&this.playerDeactivated(s),this.chat.playerLeft(s.formatName()),delete this.clients[t],this.updatePlayers()}processReset(e){let t=e.getCN(),s=this.clients[t];if(!s)throw Error("invalid reset cn "+t);s.resetScore(),this.updatePlayers(),this.chat.playerReset(s.formatName())}processRename(e){let t=e.getCN(),s=x(e.getString(20)),i=this.clients[t];if(!i)throw Error("invalid rename cn "+t);this.chat.playerRename(i.formatName(),s),i.name=s}processPing(e){this.sendPong(e.getInt())}processPingTime(e){for(let t=0;t<=64;t++){let t=e.getCN();if(t<0)break;let s=e.getInt(),i=this.clients[t];if(!i)throw Error("invalid ping cn "+t);i.ping=s}}processChat(e){let t=e.getCN(),s=e.getInt(),i=1==(3&s)?e.getInt():-1,r=e.getString(100),o=E(this.clients[t],t),l=this.clients[i],a=l?l===this.localClient?"you":E(l,i):void 0;this.chat.addChatMessage(o,r,s,a)}processActive(e){let t=e.getCN(),s=this.clients[t];if(!s)throw Error("invalid active cn "+t);if(s.active=!s.active)this.playerActivated(s),this.spectators=this.spectators.filter(e=>e!==s);else{this.playerDeactivated(s);let e=0,t=this.spectators.length;for(;e<t;){let i=e+t>>>1;this.spectators[i].cn<s.cn?e=i+1:t=i}this.spectators.splice(e,0,s)}this.updatePlayers()}}let M=k;class N extends A{sendReady(){}#c=p.state(p.proxy([]));get roundPlayers(){return p.get(this.#c)}set roundPlayers(e){p.set(this.#c,e,!0)}processWelcomeGame(e){this.roundPlayers=this.clients.filter(e=>e.active),this.processRoundInfo(e)}playerActivated(e){this.roundPlayers.push(e)}playerDeactivated(e){this.roundPlayers=this.roundPlayers.filter(t=>t!==e)}lastUpdate=Date.now();smoothDelay=1e3;update(e){let t=Date.now()-this.lastUpdate;e&&t<1e3||(this.smoothDelay=(4*this.smoothDelay+t)/5,this.updateGameState(t,this.lastUpdate=Date.now()))}}let R=[["optBotBalance","i",16,"Bot Balance","balance total players to this number",0,64],["optSkill","i",80,"Skill / %","allocation of luck and skill",0,100],["optBotWin","i",90,"Bot Win Rate / %","portion of auto-win against bots",0,100],["optTransfer","i",75,"Mass Transfer / %","portion of loser's mass transferred to winner",0,100],["optOverlap","i",0,"Overlap / %","overlap needed to collide (0% = touch, 50% = smaller center is within larger, 100% = complete overlap)",0,100],["optDimension","i",2e6,"Dimension / ppm","number of dimensions (2 = circle, 3 = sphere)",0,1e8]];function C(e){return`${e.optSkill}% skill, ${100-e.optSkill}% luck, ${e.optBotWin}% bot-factor, ${e.optOverlap}% overlap, ${e.optTransfer}% transfer, ${e.optDimension/1e6}D, ${e.optBotBalance} botbalance`}(i=a||(a={}))[i.WELCOME=0]="WELCOME",i[i.JOIN=1]="JOIN",i[i.LEAVE=2]="LEAVE",i[i.RESET=3]="RESET",i[i.RENAME=4]="RENAME",i[i.PING=5]="PING",i[i.PING_TIME=6]="PING_TIME",i[i.CHAT=7]="CHAT",i[i.ACTIVE=8]="ACTIVE",i[i.ADD_BOT=9]="ADD_BOT",i[i.DEL_BOT=10]="DEL_BOT",i[i.WORLDSTATE=11]="WORLDSTATE",i[i.KILL=12]="KILL",(r=n||(n={}))[r.RESET=0]="RESET",r[r.RENAME=1]="RENAME",r[r.PONG=2]="PONG",r[r.CHAT=3]="CHAT",r[r.ACTIVE=4]="ACTIVE",r[r.MOVE=5]="MOVE";class P extends M{hue=0;#h=p.state(0n);get kills(){return p.get(this.#h)}set kills(e){p.set(this.#h,e,!0)}#p=p.state(0n);get deaths(){return p.get(this.#p)}set deaths(e){p.set(this.#p,e,!0)}#d=p.state(0n);get score(){return p.get(this.#d)}set score(e){p.set(this.#d,e,!0)}resetScore(){this.kills=0n,this.deaths=0n,this.score=0n}canResetScore(){return this.kills||this.deaths}readWelcome(e){super.readWelcome(e),this.hue=e.get(),this.kills=e.getUint64(),this.deaths=e.getUint64(),this.score=e.getUint64()}processJoin(e,t){super.processJoin(e,t),this.hue=t.get()}}class O extends N{#u=p.state(p.proxy((0,y.q)(R)));get mode(){return p.get(this.#u)}set mode(e){p.set(this.#u,e,!0)}lastPhysFrame=0;players=Array.from({length:I},(e,t)=>new U(t));player1;moveX=0;moveY=0;lastSentX=-1;lastSentY=-1;showFPS=!0;drawDev=!0;#m=p.state(p.proxy(c.MASS));get topType(){return p.get(this.#m)}set topType(e){p.set(this.#m,e,!0)}topSize=5;#g=p.derived(()=>["m","score","kills"][this.topType]);get topProp(){return p.get(this.#g)}set topProp(e){p.set(this.#g,e)}duelTop=[];newClient(){return new P}enterGame(e,t,s){let i=parseInt(s,16);Number.isNaN(i)&&(i=256*Math.random()),this.setupGame(e),this.sendf("isc",this.PROTOCOL_VERSION,t,255&i)}sendReset(){this.sendf("i",n.RESET)}sendRename(e){this.sendf("is",n.RENAME,e)}sendPong(e){this.sendf("i2",n.PONG,e)}sendChat(e,t,s=-1){this.sendf("i3s",n.CHAT,t,s,e.slice(0,100))}sendActive(){this.sendf("i",n.ACTIVE)}sendMove(e,t){e=65535*e|0,t=65535*t|0,this.sendf("ic4",n.MOVE,e>>8,255&e,t>>8,255&t)}MESSAGE_HANDLERS={[a.WELCOME]:this.processWelcome,[a.JOIN]:this.processJoin,[a.LEAVE]:this.processLeave,[a.RESET]:this.processReset,[a.RENAME]:this.processRename,[a.PING]:this.processPing,[a.PING_TIME]:this.processPingTime,[a.CHAT]:this.processChat,[a.ACTIVE]:this.processActive,[a.ADD_BOT]:this.processAddBot,[a.DEL_BOT]:this.processDelBot,[a.WORLDSTATE]:this.processWorldState,[a.KILL]:this.processKill};playerActivated(e){super.playerActivated(e);let t=this.players[e.cn];t.type=h.HUMAN,t.kills=0n,t.deaths=0n,t.combo=0n,t.score=0n,t.alive=!1,t.color=B(e.hue,e===this.localClient?0:t.type),e===this.localClient&&(this.player1=t)}playerDeactivated(e){super.playerDeactivated(e),this.players[e.cn].type=h.UNUSED,e===this.localClient&&(this.player1=void 0)}processWelcomeMode(e){this.mode.optBotBalance=Math.min(Number(e.getUint64()),64),this.mode.optSkill=Math.min(e.get(),100),this.mode.optBotWin=Math.min(e.get(),100),this.mode.optTransfer=Math.min(e.get(),100),this.mode.optOverlap=Math.min(e.get(),100),this.mode.optDimension=Math.min(Number(e.getUint64()),1e8)}processRoundInfo(e){for(let e of this.players)e.type=h.UNUSED;this.player1=void 0;for(let t=0;t<=I;t++){let t=e.getUint64();if(!t)break;let s=Number(t>>1n)-1,i=1n&t,r=e.getUint64(),o=e.getUint64(),l=e.getUint64(),a=e.getUint64(),n=i?e.get():this.clients[s]?.hue??0,c=i?h.BOT:h.HUMAN,p=this.players[s];p.kills=r,p.deaths=o,p.combo=l,p.score=a,p.alive=!1,p.color=B(n,p.type=c)}this.topType!==c.MASS&&this.calcTop()}processAddBot(e){let t=Number(e.getUint64()),s=e.get(),i=this.players[t];i.kills=0n,i.deaths=0n,i.combo=0n,i.score=0n,i.alive=!1,i.color=B(s,i.type=h.BOT),this.topType!==c.MASS&&this.calcTop()}processDelBot(e){let t=Number(e.getUint64());this.players[t].type=h.UNUSED,this.topType!==c.MASS&&this.calcTop()}processWorldState(e){for(let t=0;t<=I;t++){let t=e.getUint64();if(!t)break;let s=e.getUint16()*D/65535,i=e.getUint16()*_/65535,r=e.getUint16()*D/65535,o=e.getUint16()*_/65535,l=e.getFloat64(),a=this.players[Number(t)-1];a.m=l,2e6===this.mode.optDimension?a.r=Math.sqrt(l):a.r=l**(1e6/this.mode.optDimension),a.alive?(a.ex+=a.x-s,a.ey+=a.y-i):(a.alive=!0,a.ex=0,a.ey=0),a.x=s,a.y=i,a.dx=r,a.dy=o}this.lastPhysFrame=Date.now(),this.topType===c.MASS&&this.calcTop()}processKill(e){let t=Number(e.getUint64()),s=Number(e.getUint64()),i=this.players[t],r=this.players[s];i.kills++,i.combo++,r.deaths++,r.alive=!1,r.combo=0n,t===s?i.score--:i.score+=i.combo;let o=i.type===h.HUMAN&&this.clients[t],l=r.type===h.HUMAN&&this.clients[s];o&&(o.kills++,t===s?o.score--:o.score+=i.combo),l&&l.deaths++,this.updatePlayers(),this.topType!==c.MASS&&this.calcTop()}calcTop(){this.duelTop=this.players.filter(e=>e.type).sort((e,t)=>Number(t[this.topProp]-e[this.topProp]))}updateNetwork(){this.room&&this.localClient.active&&(Math.abs(this.moveX-this.lastSentX)>.01||Math.abs(this.moveY-this.lastSentY)>.01)&&this.sendMove(this.lastSentX=this.moveX,this.lastSentY=this.moveY)}updateGameState(e,t){if(!this.room||(this.updateNetwork(),!e))return;let s=Math.pow(.001,e/1e3);for(let e of this.players)e.alive&&(e.ex*=s,e.ey*=s);let i=1e3/L,r=Math.floor((t-this.lastPhysFrame)/i);if(r){for(let e of this.players){let t=e.dx-e.x,s=e.dy-e.y,i=200/L*r,o=t*t+s*s;if(o>i*i){let e=i/Math.sqrt(o);t*=e,s*=e}e.x+=t,e.y+=s}this.lastPhysFrame+=r*i}}drawClear(e,t,s){e.fillStyle="#37c",e.fillRect(0,0,t,s)}drawPlayer(e,t,s,i,r){let o=i.x+i.ex,l=i.y+i.ey;if(e.beginPath(),e.arc(o/D*t,l/_*s,i.r/D*t,0,2*Math.PI),e.closePath(),e.fillStyle=i.color,e.fill(),this.drawDev){e.beginPath(),e.arc(i.x/D*t,i.y/_*s,i.r/D*t,0,2*Math.PI),e.closePath(),e.lineWidth=2,e.strokeStyle="red",e.stroke();let r=e.createLinearGradient(i.x/D*t,i.y/_*s,i.dx/D*t,i.dy/_*s);r.addColorStop(0,"red"),r.addColorStop(1,"rgba(255,0,0,0.25)"),e.strokeStyle=r,e.moveTo(i.x/D*t,i.y/_*s),e.lineTo(i.dx/D*t,i.dy/_*s),e.stroke()}if(this.player1&&this.player1.alive&&i!==this.player1){let r=this.player1.x+this.player1.ex-o,a=this.player1.y+this.player1.ey-l,n=r*r+a*a;if(n>i.r*i.r){let e=i.r/Math.sqrt(n);r*=e,a*=e}let c=(100-this.mode.optSkill)/2+this.player1.m/(this.player1.m+i.m)*this.mode.optSkill;i.type===h.BOT&&(c=this.mode.optBotWin+c*(1-this.mode.optBotWin/100)),e.font=.015*t+"px Verdana, sans-serif",e.textAlign="center",e.textBaseline="middle",e.fillStyle=c>70?"#0f0":c<40?"#f00":"#aaa",e.fillText(Math.round(c)+"%",(o+r)/D*t,(l+a)/_*s)}e.font=.015*t+"px Verdana, sans-serif",e.textAlign="center",e.textBaseline="middle",r&&(e.fillStyle="#ccc",e.fillText(r.formatName(),o/D*t,(l/_-.01)*s)),e.fillStyle="#eee",e.fillText(i.m.toLocaleString(),o/D*t,(l/_+.01)*s)}drawStatus(e,t,s,i){e.font=.04*t+"px sans-serif",e.textAlign="center",e.fillStyle="#ddd",e.fillText(i,.5*t,.15*s)}drawFPS(e,t,s){e.font=.02*t+"px monospace",e.textAlign="left",e.fillStyle="#fa0",e.fillText(Math.round(1e3/Math.max(this.smoothDelay,.5))+" fps",.01*t,.97*s)}render(e){let t,s=e.canvas.height,i=e.canvas.width;for(let t of(this.drawClear(e,i,s),this.mode.optOverlap?this.players.filter(e=>e.type&&e.alive).sort((e,t)=>e.m-t.m):this.players))t.type&&t.alive&&this.drawPlayer(e,i,s,t,t.type===h.HUMAN&&this.clients[t.pn]);if(this.topSize&&this.duelTop.length){let t=Number(this.duelTop[0][this.topProp]),r=.045*s|0,o=.015*s|0;for(let l=Math.min(this.duelTop.length,this.topSize)-1;l>=0;l--){let a=this.duelTop[l],n=Number(a[this.topProp]),c=.2*i*(l&&t?n/t:1),p=l*r+1,d=p+r-o;e.fillStyle=a.color,e.fillRect(1,d,c+1,o),e.strokeStyle="#000",e.strokeRect(1,d,c+1,o);let u=Math.round(n).toLocaleString(),m=e.measureText(u).width<.9*c;e.fillStyle=a.type===h.HUMAN?"#eee":"#ccc",e.font=.007*i+"px Verdana, sans-serif",e.textAlign=m?"right":"left",e.textBaseline="middle",e.fillText(u,m?c-.003*i:c+2+.003*i,d+1+(o>>1)),e.textAlign="left",e.textBaseline="top",e.font=(a===this.player1?"bold ":"")+.01*i+"px Verdana, sans-serif";let g=a.type===h.HUMAN?this.clients[a.pn].formatName():`<bot ${a.pn}>`;e.fillText(g,2,p+1+.005*s)}}this.room?this.player1&&(t=this.player1.score+" ("+this.player1.kills+"/"+this.player1.deaths+") ["+this.player1.combo+"x COMBO]"):t="Disconnected",t&&this.drawStatus(e,i,s,t),this.showFPS&&this.drawFPS(e,i,s)}attachCanvas(e){let t=this;function s(s,i){t.moveX=(s-e.getBoundingClientRect().left)/e.width,t.moveY=(i-e.getBoundingClientRect().top)/e.height}function i(){t.player1&&(t.moveX=t.player1.x/D,t.moveY=t.player1.y/_)}function r(e){if(e.targetTouches.length<1)return;e.preventDefault();let t=e.targetTouches.item(0);s(t.clientX,t.clientY)}e.addEventListener("mousemove",function(e){s(e.clientX,e.clientY)}),e.addEventListener("touchstart",r),e.addEventListener("touchmove",r),e.addEventListener("mouseleave",i),e.addEventListener("touchend",i),e.addEventListener("touchcancel",i)}playersSortProps=[e=>e.score,e=>e.kills]}let D=1600,_=900,I=64,L=40;(o=c||(c={}))[o.MASS=0]="MASS",o[o.SCORE=1]="SCORE",o[o.KILLS=2]="KILLS",(l=h||(h={}))[l.UNUSED=0]="UNUSED",l[l.HUMAN=1]="HUMAN",l[l.BOT=2]="BOT";class U{pn;type=h.UNUSED;color="black";kills=0n;deaths=0n;combo=0n;score=0n;alive=!1;x=0;y=0;ex=0;ey=0;dx=0;dy=0;m=1e3;r=10;constructor(e){this.pn=e}}function B(e,t){return"hsl("+1.40625*e+","+(t?1===t?"80%,40%":"40%,20%":"90%,60%")+")"}var W=s(5),G=p.from_html('<div style="border: solid black 2px; container-type: inline-size"><canvas></canvas></div>'),H=s(142),$=p.from_html('<div class="input-group mb-3"><span class="input-group-text">Leaderboard Type</span> <select class="form-select"><option>Mass</option><option>Score</option><option>Kills</option></select> <span class="input-group-text">Leaderboard Size</span> <input type="number" class="form-control" min="0" max="23"/> <span class="input-group-text flex-grow-1"><label class="form-check mx-auto"><input type="checkbox" class="form-check-input" checked disabled/> Show FPS</label></span> <span class="input-group-text flex-grow-1"><label class="form-check mx-auto"><input type="checkbox" class="form-check-input" checked disabled/> Dev Mode</label></span> <span class="input-group-text flex-grow-1"><label class="form-check mx-auto"><input type="checkbox" class="form-check-input"/> <span class="form-check-label">Full-Screen</span></label></span></div> <!> <div class="mt-3"> </div> <b>Lobby</b> <!>',1);p.delegate(["click"]);var V=p.from_html('<div class="row"><div class="col-7 col-sm-8 col-md-9 col-lg-10"><!></div> <div class="col-5 col-sm-4 col-md-3 col-lg-2"><div class="input-group mb-3"><span class="input-group-text">Hue</span> <input type="text" class="form-control" placeholder="42" maxlength="2"/></div></div> <div class="col mb-3"><div id="hue" class="svelte-xj9bf4"></div></div></div> <!> <!> <div class="row"><div class="col-12 col-xl-8"><!></div> <div class="col-12 col-xl-4 mb-3"><!></div></div>',1);let F={hash:"svelte-xj9bf4",code:"#hue.svelte-xj9bf4 {width:100%;height:36px;background:linear-gradient(to right, #f00 0%, #ff0 17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);border:solid #ccc 2px;}"};p.delegate(["click"]),(0,s(102).A)(function(e,t){let s;p.push(t,!0),p.append_styles(e,F);let i=new m.Ay,r=new O(i),o=p.derived(()=>r.room),l=p.derived(()=>r.canReset),a=p.derived(()=>r.leaderboard),n=p.derived(()=>r.localClient),c=(0,d.C)("game/mp/_shared/name",""),h=(0,d.C)("game/mp/duel/hue","42");var S=V(),x=p.first_child(S),w=p.child(x),E=p.child(w);(0,f.A)(E,{onchange:()=>r.sendRename(c.value),get value(){return c.value},set value($$value){c.value=$$value}}),p.reset(w);var T=p.sibling(w,2),k=p.child(T),A=p.sibling(p.child(k),2);p.remove_input_defaults(A),p.reset(k),p.reset(T);var M=p.sibling(T,2);p.child(M).__click=function(e){let t=e.target;h.value=("0"+(255*((e.clientX-t.getBoundingClientRect().left)/t.clientWidth)|0).toString(16)).slice(-2)},p.reset(M),p.reset(x);var N=p.sibling(x,2);p.bind_this((0,b.A)(N,{gameId:"duel-tfbkn9e0umxmt1xrxv4g",roomType:"DuelRoom",get gameRoom(){return r.room},onJoinedRoom:e=>r.enterGame(e,c.value,h.value),formatGameMode:e=>C((0,y.e)(R,e)),get roomCreateOptions(){return R}}),e=>s=e,()=>s);var P=p.sibling(N,2);(0,v.A)(P,{get inGame(){return p.get(o)},get isActive(){return r.localClient.active},canReady:!1,isReady:!1,onActive:()=>r.sendActive(),onReady:()=>r.sendReady(),onDisconnect:()=>(r.leaveGame(),s.refreshRooms()),children:(e,t)=>{var s,i,o,l,a,n,c,h,u,m,g,f,v,y;let b,S,x,w;s={get gameState(){return r}},p.push(s,!0),S=p.prop(s,"gameState",7),x=(0,d.C)("game/mp/duel/t",0),w=(0,d.C)("game/mp/duel/s",10),p.user_effect(()=>{S().topType=x.value,S().topSize=w.value,S().calcTop()}),i=$(),o=p.first_child(i),l=p.sibling(p.child(o),2),(a=p.child(l)).value=a.__value=0,(n=p.sibling(a)).value=n.__value=1,(c=p.sibling(n)).value=c.__value=2,p.reset(l),h=p.sibling(l,4),p.remove_input_defaults(h),u=p.sibling(h,6),m=p.child(u),p.child(m).__click=function(){this.checked=!1,b.requestFullscreen()},p.next(2),p.reset(m),p.reset(u),p.reset(o),g=p.sibling(o,2),p.bind_this(function(e,t){let s,i;p.push(t,!0);let r=p.prop(t,"aspect",3,2);function o(){window.innerWidth===window.screen.width&&window.innerHeight===window.screen.height?(s.width=Math.min(window.innerWidth,window.innerHeight*r()),s.height=Math.min(window.innerHeight,window.innerWidth/r())):(s.width=Math.floor(s.clientWidth*window.devicePixelRatio),s.height=Math.floor(s.clientHeight*window.devicePixelRatio))}(0,W.Rc)(()=>{let e;t.gameState.attachCanvas(s),i=s.getContext("2d"),document.addEventListener("fullscreenchange",o),window.addEventListener("resize",o),o(),!function s(){t.gameState.update(),t.gameState.render(i),e=requestAnimationFrame(s)}();let r=setInterval(()=>t.gameState.update(!0),1e3);return()=>{document.removeEventListener("fullscreenchange",o),window.removeEventListener("resize",o),cancelAnimationFrame(e),clearInterval(r)}});var l=G(),a=p.child(l);return p.bind_this(a,e=>s=e,()=>s),p.reset(l),p.template_effect(()=>p.set_style(a,`width: min(100cqw, ${100*r()}cqh); height: min(${100/r()}cqw, 100cqh)`)),p.append(e,l),p.pop({requestFullscreen:function(e){return s.requestFullscreen(e)}})}(g,{get gameState(){return S()},aspect:16/9}),e=>b=e,()=>b),f=p.sibling(g,2),v=p.child(f),p.reset(f),y=p.sibling(f,4),(0,H.A)(y,{get localClient(){return S().localClient},get inGame(){return S().roundPlayers},get spectators(){return S().spectators}}),p.template_effect(e=>p.set_text(v,`Game Mode: ${e??""}`),[()=>C(S().mode)]),p.bind_select_value(l,()=>x.value,e=>x.value=e),p.bind_value(h,()=>w.value,e=>w.value=e),p.append(e,i),p.pop()},$$slots:{default:!0}});var D=p.sibling(P,2),_=p.child(D),I=p.child(_);(0,g.A)(I,{get leaderboard(){return p.get(a)},get localClient(){return p.get(n)},get inGame(){return p.get(o)},get canReset(){return p.get(l)},onReset:()=>r.sendReset(),columns:[["Score",e=>e.score],["Kills",e=>e.kills],["Deaths",e=>e.deaths]]}),p.reset(_);var L=p.sibling(_,2),U=p.child(L);(0,u.A)(U,{get chatState(){return i},get canSend(){return r.room},onInput:e=>(0,m.Oo)(r,e)}),p.reset(L),p.reset(D),p.template_effect(e=>p.set_style(A,`background-color:hsl(${e??""},95%,65%)`),[()=>1.40625*parseInt(h.value,16)]),p.bind_value(A,()=>h.value,e=>h.value=e),p.append(e,S),p.pop()})},122(e,t,s){s.d(t,{JY:()=>i});function i(e){let t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",s="";for(;e--;)s+=t[Math.random()*t.length|0];return s}}},o={};function l(e){var t=o[e];if(void 0!==t)return t.exports;var s=o[e]={exports:{}};return r[e](s,s.exports,l),s.exports}l.m=r,l.d=(e,t)=>{for(var s in t)l.o(t,s)&&!l.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"u">typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e=[],l.O=(t,s,i,r)=>{if(s){r=r||0;for(var o=e.length;o>0&&e[o-1][2]>r;o--)e[o]=e[o-1];e[o]=[s,i,r];return}for(var a=1/0,o=0;o<e.length;o++){for(var[s,i,r]=e[o],n=!0,c=0;c<s.length;c++)(!1&r||a>=r)&&Object.keys(l.O).every(e=>l.O[e](s[c]))?s.splice(c--,1):(n=!1,r<a&&(a=r));if(n){e.splice(o--,1);var h=i();void 0!==h&&(t=h)}}return t},l.rv=()=>"1.7.3",t={97:0},l.O.j=e=>0===t[e],s=(e,s)=>{var i,r,[o,a,n]=s,c=0;if(o.some(e=>0!==t[e])){for(i in a)l.o(a,i)&&(l.m[i]=a[i]);if(n)var h=n(l)}for(e&&e(s);c<o.length;c++)r=o[c],l.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return l.O(h)},(i=self.webpackChunkvwww=self.webpackChunkvwww||[]).forEach(s.bind(null,0)),i.push=s.bind(null,i.push.bind(i)),l.ruid="bundler=rspack@1.7.3";var a=l.O(void 0,["14","21","37","22","43","36"],()=>l(151));a=l.O(a)})();