"use strict";(self.webpackChunkvwww=self.webpackChunkvwww||[]).push([["36"],{128(e,t,n){n.d(t,{Ay:()=>o,Oo:()=>a,xF:()=>r});var r,i=n(2);!function(e){e[e.None=0]="None",e[e.AfterNext=1]="AfterNext",e[e.All=2]="All"}(r||(r={}));class o{maxChatMessages;messageBuf=[];queue=[];holdMode=r.None;#e=i.state(i.proxy(this.messageBuf));get messages(){return i.get(this.#e)}set messages(e){i.set(this.#e,e,!0)}#t=i.state(0);get queueLength(){return i.get(this.#t)}set queueLength(e){i.set(this.#t,e,!0)}constructor(e=100){this.maxChatMessages=e}clear(){this.messageBuf.length=0,this.queue.length=0,this.holdMode=r.None,this.queueLength=0,this.invalidate()}addEntry(e){switch(this.holdMode){case r.None:this.messageBuf.length>=this.maxChatMessages&&this.messageBuf.shift(),this.messageBuf.push(e),this.invalidate();break;case r.AfterNext:this.messageBuf.push(e),this.invalidate(),this.holdMode=r.All;break;case r.All:this.queue.length>=this.maxChatMessages&&this.queue.shift(),this.queue.push(e),this.queueLength++}}setHoldMode(e){if(e===r.AfterNext&&this.queueLength>this.maxChatMessages&&(e=r.All),this.holdMode=e,this.queue.length)if(e===r.None){let e=Math.max(0,this.messageBuf.length+this.queue.length-this.maxChatMessages);e&&this.messageBuf.splice(0,e),this.messageBuf.push(...this.queue),this.queue.length=0,this.invalidate(),this.queueLength=0}else e===r.AfterNext&&(this.messageBuf.push(this.queue.shift()),this.invalidate(),this.queueLength--);else if(e===r.None){let e=this.messageBuf.length-this.maxChatMessages;e>0&&this.messageBuf.splice(0,e),this.invalidate()}}playerJoined(e){this.addEntry({type:"join",name:e})}playerLeft(e){this.addEntry({type:"left",name:e})}playerReset(e){this.addEntry({type:"reset",name:e})}playerRename(e,t){this.addEntry({type:"rename",oldName:e,newName:t})}addChatMessage(e,t,n,r){this.addEntry({type:"chat",name:e,msg:t,flags:n,targetName:r})}addSysMessage(e){this.addEntry({type:"sys",msg:e})}invalidate(){this.messages=this.messageBuf}}function a(e,t){let n=0,r=1,i=2,o=4;function a(t,n,r){e.room?e.sendChat(t,n,r):e.chat.addSysMessage("cannot send chat message: not connected to game room")}if(t.length>0&&"/"===t[0]){let s=t.indexOf(" ",1),[l,c]=s<0?[t.slice(1),""]:[t.slice(1,s),t.slice(s+1)],u=!1;switch(l){case"me":u=!0;case"say":c&&a(c,(u?o:0)|n);break;case"meteam":u=!0;case"sayteam":c&&a(c,(u?o:0)|i);break;case"mew":case"mewhisper":case"mepm":u=!0;case"w":case"whisper":case"pm":{if(!c)break;let e=-1,t=0,n=/^(\d+)\s+/.exec(c);if(n){let r=n[1];e=+r,t=r.length}c.length>t&&a(c.slice(t),(u?o:0)|r,e);break}case"leave":case"disconnect":e.leaveGame();break;case"":case"help":"say"===c?e.chat.addSysMessage("without / prefix, use shorthand prefixes: *?(@\\d+|%|) say (*me) @pm|%team|all"):e.chat.addSysMessage("supported commands: say, me, sayteam, meteam, w, whisper, pm, mew, mewhisper, mepm, leave, disconnect, help");break;default:e.chat.addSysMessage(`command not recognized: ${t}`)}}else{let e=0,n=-1,s=0;if(t.length>1&&"*"===t[0]&&(s++,e|=o),t.length>s)switch(t[s]){case"@":if(t.length>s+1){let i=/^(\d+)\s+/.exec(t.slice(s+1));if(i){let t=i[1];n=+t,s=s+1+t.length,e|=r}}break;case"%":e|=i,s++}t.length>s&&a(t.slice(s),e,n)}}},108(e,t,n){n.d(t,{C:()=>i});var r=n(2);function i(e,t,n=!1){let o=r.state(r.proxy(t));function a(e){return"undefined"===e?void 0:JSON.parse(e)}if(window.localStorage){let i=localStorage.getItem(e);null!==i&&r.set(o,a(i),!0),r.user_effect(()=>localStorage.setItem(e,void 0===r.get(o)?"undefined":JSON.stringify(r.get(o)))),n&&window.addEventListener("storage",n=>n.storageArea===localStorage&&n.key===e&&r.set(o,null==n.newValue?t:a(n.newValue),!0))}return{get value(){return r.get(o)},set value(newVal){r.set(o,newVal,!0)}}}},127(e,t,n){n.d(t,{A:()=>y}),n(1);var r=n(2),i=n(5),o=n(128),a=r.from_html("<span><strong> </strong> joined the game.</span>"),s=r.from_html("<span><strong> </strong> left the game.</span>"),l=r.from_html("<span><strong> </strong> reset stats.</span>"),c=r.from_html("<span> <strong> </strong>.</span>"),u=r.from_html('<span class="badge text-bg-secondary"> </span>'),d=r.from_html('<small class="text-muted"><del> </del></small> <span class="text-danger">(do not spam!)</span>',1),h=r.from_html('(to <span class="badge text-bg-primary"> </span>)',1),f=r.from_html('(to <span class="badge text-bg-info">TEAM</span>)',1),p=r.from_html("<span><!> <!> <!></span>"),g=r.from_html("<span><em> </em></span>"),m=r.from_html("<span> </span>"),v=r.from_html('<li class="list-group-item"><!></li>'),b=r.from_html('<div class="card"><div class="card-header"><h4 class="float-start"> </h4> <div class="float-end"><button> </button> <button>Clear</button></div></div> <ul class="list-group list-group-flush"><!> <li>Scroll down to resume autoscroll</li></ul> <div class="card-footer"><div class="input-group"><input type="text" class="form-control" placeholder="Enter a message here…"/> <button>Send</button></div></div></div>');function y(e,t){let n,y,_;r.push(t,!0);let w=r.prop(t,"title",3,"Chat"),k=r.prop(t,"height",3,"20rem"),I=r.prop(t,"onInput",19,()=>console.log),x=r.derived(()=>t.chatState.queueLength),C=r.derived(()=>t.chatState.messages),R=r.state(void 0),E=r.state(void 0),S=r.state(r.proxy(o.xF.None)),A=r.state("");function N(){let e=r.get(R)&&r.get(E)&&r.get(R).offsetHeight+r.get(R).scrollTop>r.get(R).scrollHeight-r.get(E).offsetHeight?r.get(R).offsetHeight+r.get(R).scrollTop>r.get(R).scrollHeight-1?o.xF.None:o.xF.AfterNext:o.xF.All;r.get(S)!==e&&(r.set(S,e,!0),t.chatState.setHoldMode(e))}function P(){r.get(S)||r.get(R)?.scrollTo(0,r.get(R).scrollHeight)}function T(){I()(r.get(A)),r.set(A,"")}function O(e){13===e.which&&T()}r.user_pre_effect(()=>{r.get(C),(0,i.io)().then(P)});var B=b(),j=r.child(B),D=r.child(j),U=r.child(D,!0);r.reset(D);var V=r.sibling(D,2),L=r.child(V);L.__click=()=>t.chatState.setHoldMode(r.set(S,0));var F=r.child(L);r.reset(L);var M=r.sibling(L,2);M.__click=()=>(t.chatState.clear(),r.set(S,0)),r.reset(V),r.reset(j);var q=r.sibling(j,2),G=r.child(q);r.each(G,17,()=>r.get(C),r.index,(e,t)=>{var n=v(),i=r.child(n),o=e=>{var n=a(),i=r.child(n),o=r.child(i,!0);r.reset(i),r.next(),r.reset(n),r.template_effect(()=>r.set_text(o,r.get(t).name)),r.append(e,n)},b=e=>{var n=r.comment(),i=r.first_child(n),o=e=>{var n=s(),i=r.child(n),o=r.child(i,!0);r.reset(i),r.next(),r.reset(n),r.template_effect(()=>r.set_text(o,r.get(t).name)),r.append(e,n)},a=e=>{var n=r.comment(),i=r.first_child(n),o=e=>{var n=l(),i=r.child(n),o=r.child(i,!0);r.reset(i),r.next(),r.reset(n),r.template_effect(()=>r.set_text(o,r.get(t).name)),r.append(e,n)},a=e=>{var n=r.comment(),i=r.first_child(n),o=e=>{var n=c(),i=r.child(n),o=r.sibling(i),a=r.child(o,!0);r.reset(o),r.next(),r.reset(n),r.template_effect(()=>{r.set_text(i,`${r.get(t).oldName??""} is now known as `),r.set_text(a,r.get(t).newName)}),r.append(e,n)},a=e=>{var n=r.comment(),i=r.first_child(n),o=e=>{var n=p(),i=r.child(n),o=e=>{var n=r.text();r.template_effect(()=>r.set_text(n,`* ${r.get(t).name??""}`)),r.append(e,n)},a=e=>{var n=u(),i=r.child(n,!0);r.reset(n),r.template_effect(()=>r.set_text(i,r.get(t).name)),r.append(e,n)};r.if(i,e=>{4&r.get(t).flags?e(o):e(a,!1)});var s=r.sibling(i,2),l=e=>{var n=d(),i=r.first_child(n),o=r.child(i),a=r.child(o,!0);r.reset(o),r.reset(i),r.next(2),r.template_effect(()=>r.set_text(a,r.get(t).msg)),r.append(e,n)},c=e=>{var n=r.text();r.template_effect(()=>r.set_text(n,r.get(t).msg)),r.append(e,n)};r.if(s,e=>{8&r.get(t).flags?e(l):e(c,!1)});var g=r.sibling(s,2),m=e=>{var n=h(),i=r.sibling(r.first_child(n)),o=r.child(i,!0);r.reset(i),r.next(),r.template_effect(()=>r.set_text(o,r.get(t).targetName)),r.append(e,n)},v=e=>{var n=r.comment(),i=r.first_child(n),o=e=>{var t=f();r.next(2),r.append(e,t)};r.if(i,e=>{(3&r.get(t).flags)==2&&e(o)},!0),r.append(e,n)};r.if(g,e=>{r.get(t).targetName?e(m):e(v,!1)}),r.reset(n),r.append(e,n)},a=e=>{var n=r.comment(),i=r.first_child(n),o=e=>{var n=g(),i=r.child(n),o=r.child(i,!0);r.reset(i),r.reset(n),r.template_effect(()=>r.set_text(o,r.get(t).msg)),r.append(e,n)},a=e=>{var n=m(),i=r.child(n,!0);r.reset(n),r.template_effect(()=>r.set_text(i,r.get(t))),r.append(e,n)};r.if(i,e=>{"sys"===r.get(t).type?e(o):e(a,!1)},!0),r.append(e,n)};r.if(i,e=>{"chat"===r.get(t).type?e(o):e(a,!1)},!0),r.append(e,n)};r.if(i,e=>{"rename"===r.get(t).type?e(o):e(a,!1)},!0),r.append(e,n)};r.if(i,e=>{"reset"===r.get(t).type?e(o):e(a,!1)},!0),r.append(e,n)};r.if(i,e=>{"left"===r.get(t).type?e(o):e(a,!1)},!0),r.append(e,n)};r.if(i,e=>{"join"===r.get(t).type?e(o):e(b,!1)}),r.reset(n),r.append(e,n)});var $=r.sibling(G,2);r.bind_this($,e=>r.set(E,e),()=>r.get(E)),r.reset(q),r.bind_this(q,e=>r.set(R,e),()=>r.get(R));var K=r.sibling(q,2),z=r.child(K),H=r.child(z);r.remove_input_defaults(H),H.__keydown=O;var J=r.sibling(H,2);J.__click=T,r.reset(z),r.reset(K),r.reset(B),r.template_effect(()=>{r.set_text(U,w()),n=r.set_class(L,1,"btn btn-sm btn-info",null,n,{"d-none":!r.get(x)&&!r.get(S)}),r.set_text(F,`${r.get(x)??""} new`),y=r.set_class(M,1,"btn btn-sm btn-danger",null,y,{"d-none":!r.get(C).length}),r.set_style(q,`overflow-y: scroll; height: ${k()??""}`),_=r.set_class($,1,"list-group-item text-bg-warning text-center",null,_,{"d-none":!r.get(S)}),r.set_class(J,1,`btn btn-${t.canSend?"":"outline-"}primary`)}),r.event("scroll",q,N),r.bind_value(H,()=>r.get(A),e=>r.set(A,e)),r.append(e,B),r.pop()}r.delegate(["click","keydown"])},130(e,t,n){n.d(t,{A:()=>u}),n(1);var r=n(2),i=r.from_html("<button>Reset My Score</button>"),o=r.from_html('<th scope="col"> </th>'),a=r.from_html("<td> </td>"),s=r.from_html('<tr><th scope="row"> </th><td> </td><!><td> </td></tr>'),l=r.from_html('<tr class="table-secondary"><td class="text-center">nobody</td></tr>'),c=r.from_html('<div class="card mb-3"><div class="card-header"><h4 class="float-start">Leaderboard</h4> <div class="float-end"><div class="input-group float-end"><!> <span class="input-group-text"><label class="form-check mx-auto"><input type="checkbox" class="form-check-input"/> show spectators</label></span></div></div></div> <div class="table-responsive" style="max-height: 20rem"><table class="table table-sm"><tbody><tr><th scope="col">Name</th><th scope="col">Rank</th><!><th scope="col">Ping</th></tr><!></tbody></table></div></div>');function u(e,t){r.push(t,!0);let n=r.prop(t,"columns",19,()=>[]);function u(e){if("object"==typeof e){if(!e[1])return e[0];let t="bigint"==typeof e[0]?Number(1000000n*e[0]/e[1])/1e4:100*e[0]/e[1];return`${e[0]} (${t.toPrecision(3)}%)`}return e}let d=r.state(!0);var h=c(),f=r.child(h),p=r.sibling(r.child(f),2),g=r.child(p),m=r.child(g),v=e=>{var n=i();n.__click=function(...e){t.onReset?.apply(this,e)},r.template_effect(()=>r.set_class(n,1,`btn btn-sm btn-${t.canReset?"warning":"outline-secondary"}`)),r.append(e,n)};r.if(m,e=>{t.inGame&&e(v)});var b=r.sibling(m,2),y=r.child(b),_=r.child(y);r.remove_input_defaults(_),r.next(),r.reset(y),r.reset(b),r.reset(g),r.reset(p),r.reset(f);var w=r.sibling(f,2),k=r.child(w),I=r.child(k),x=r.child(I),C=r.sibling(r.child(x),2);r.each(C,17,n,r.index,(e,t)=>{var n=o(),i=r.child(n,!0);r.reset(n),r.template_effect(()=>r.set_text(i,r.get(t)[0])),r.append(e,n)}),r.next(),r.reset(x);var R=r.sibling(x);r.each(R,17,()=>t.leaderboard,r.index,(e,i)=>{let o=r.derived(()=>r.get(i)===t.localClient),l=r.derived(()=>{let{active:e}=r.get(i);return{active:e}});var c=r.comment(),h=r.first_child(c),f=e=>{let t;var c=s(),d=r.child(c),h=r.child(d);r.reset(d);var f=r.sibling(d),p=r.child(f,!0);r.reset(f);var g=r.sibling(f);r.each(g,17,n,r.index,(e,t)=>{var n=a(),o=r.child(n,!0);r.reset(n),r.template_effect(e=>r.set_text(o,e),[()=>u(r.get(t)[1](r.get(i)))]),r.append(e,n)});var m=r.sibling(g),v=r.child(m,!0);r.reset(m),r.reset(c),r.template_effect(()=>{t=r.set_class(c,1,"",null,t,{"table-info":r.get(o)&&r.get(l).active,"table-warning":r.get(o)&&!r.get(l).active,"table-secondary":!r.get(o)&&!r.get(l).active}),r.set_text(h,`${r.get(i).name??""} (${r.get(i).cn??""})`),r.set_text(p,r.get(i).rank),r.set_text(v,r.get(i).ping<0?"?":r.get(i).ping)}),r.append(e,c)};r.if(h,e=>{(r.get(d)||r.get(o)||r.get(l).active)&&e(f)}),r.append(e,c)},e=>{var t=l(),i=r.child(t);r.reset(t),r.template_effect(()=>r.set_attribute(i,"colspan",3+n().length)),r.append(e,t)}),r.reset(I),r.reset(k),r.reset(w),r.reset(h),r.bind_checked(_,()=>r.get(d),e=>r.set(d,e)),r.append(e,h),r.pop()}r.delegate(["click"])},131(e,t,n){n.d(t,{A:()=>o}),n(1);var r=n(2),i=r.from_html('<div class="input-group mb-3"><span class="input-group-text">Name</span> <input type="text" class="form-control"/></div>');function o(e,t){r.push(t,!0);let n=r.prop(t,"value",15),o=r.prop(t,"placeholder",3,"unnamed"),a=r.prop(t,"maxlength",3,20);var s=i(),l=r.sibling(r.child(s),2);r.remove_input_defaults(l),l.__change=function(...e){t.onchange?.apply(this,e)},r.reset(s),r.template_effect(()=>{r.set_attribute(l,"placeholder",o()),r.set_attribute(l,"maxlength",a())}),r.bind_value(l,n),r.append(e,s),r.pop()}r.delegate(["change"])},134(e,t,n){n.d(t,{A:()=>O}),n(1);var r=n(2),i=r.from_html("<small>*</small>"),o=r.from_html('<div><label><span> <!></span> <span class="form-check form-switch"><input type="checkbox"/> <small class="form-check-label text-muted"> </small></span></label></div>');function a(e,t){let n;r.push(t,!0);let a=r.prop(t,"store",7),s=r.derived(()=>r.to_array(t.option,5)),l=(r.derived(()=>r.get(s)[0]),r.derived(()=>r.get(s)[1]),r.derived(()=>r.get(s)[2])),c=r.derived(()=>r.get(s)[3]),u=r.derived(()=>r.get(s)[4]),d=r.derived(()=>a().value!==r.get(l));var h=o(),f=r.child(h),p=r.child(f),g=r.child(p,!0),m=r.sibling(g),v=e=>{var t=i();r.append(e,t)};r.if(m,e=>{r.get(d)&&e(v)}),r.reset(p);var b=r.sibling(p,2),y=r.child(b);r.remove_input_defaults(y);var _=r.sibling(y,2),w=r.child(_,!0);r.reset(_),r.reset(b),r.reset(f),r.reset(h),r.template_effect(()=>{r.set_text(g,r.get(c)),n=r.set_class(y,1,"form-check-input",null,n,{"bg-info":r.get(d)}),r.set_text(w,r.get(u))}),r.bind_checked(y,()=>a().value,e=>a().value=e),r.append(e,h),r.pop()}var s=r.from_html("<small>*</small>"),l=r.from_html('<label class="form-check form-check-inline"><input type="radio"/> <span class="form-check-label"> </span></label>'),c=r.from_html('<div><span> <!></span> <div><small class="text-muted"> </small></div> <!></div>');function u(e,t){r.push(t,!0);let n=[],i=r.prop(t,"store",7),o=r.derived(()=>r.to_array(t.option,6)),a=(r.derived(()=>r.get(o)[0]),r.derived(()=>r.get(o)[1]),r.derived(()=>r.get(o)[2])),u=r.derived(()=>r.get(o)[3]),d=r.derived(()=>r.get(o)[4]),h=r.derived(()=>r.get(o)[5]),f=r.derived(()=>i().value!==r.get(a));var p=c(),g=r.child(p),m=r.child(g,!0),v=r.sibling(m),b=e=>{var t=s();r.append(e,t)};r.if(v,e=>{r.get(f)&&e(b)}),r.reset(g);var y=r.sibling(g,2),_=r.child(y),w=r.child(_,!0);r.reset(_),r.reset(y);var k=r.sibling(y,2);r.each(k,17,()=>r.get(h),r.index,(e,t,o)=>{let s;var c=l(),u=r.child(c);r.remove_input_defaults(u),u.value=u.__value=o;var d=r.sibling(u,2),h=r.child(d,!0);r.reset(d),r.reset(c),r.template_effect(()=>{s=r.set_class(u,1,"form-check-input",null,s,{"bg-info":r.get(f)&&o===r.get(a)}),r.set_text(h,r.get(t))}),r.bind_group(n,[],u,()=>i().value,e=>i().value=e),r.append(e,c)}),r.reset(p),r.template_effect(()=>{r.set_text(m,r.get(u)),r.set_text(w,r.get(d))}),r.append(e,p),r.pop()}var d=r.from_html("<small>*</small>"),h=r.from_html('<div><label class="w-100"><span> <small class="text-muted"> <!>]</small><!></span> <small class="text-muted d-block"> </small> <input/> <input/></label></div>');function f(e,t){r.push(t,!0);let n=r.prop(t,"store",7),i=r.derived(()=>r.to_array(t.option,8)),o=(r.derived(()=>r.get(i)[0]),r.derived(()=>r.get(i)[1]),r.derived(()=>r.get(i)[2])),a=r.derived(()=>r.get(i)[3]),s=r.derived(()=>r.get(i)[4]),l=r.derived(()=>r.get(i)[5]),c=r.derived(()=>r.get(i)[6]),u=r.derived(()=>r.get(i)[7]),f=r.derived(()=>n().value!==r.get(o));var p=h(),g=r.child(p),m=r.child(g),v=r.child(m),b=r.sibling(v),y=r.child(b),_=r.sibling(y),w=e=>{var t=r.text();r.template_effect(()=>r.set_text(t,`, default ${r.get(o)??""}`)),r.append(e,t)};r.if(_,e=>{r.get(f)&&e(w)}),r.next(),r.reset(b);var k=r.sibling(b),I=e=>{var t=d();r.append(e,t)};r.if(k,e=>{r.get(f)&&e(I)}),r.reset(m);var x=r.sibling(m,2),C=r.child(x,!0);r.reset(x);var R=r.sibling(x,2);r.attribute_effect(R,()=>({type:"number",class:"form-control",min:r.get(l),max:r.get(c),...r.get(u)}),void 0,void 0,void 0,void 0,!0);var E=r.sibling(R,2);r.attribute_effect(E,()=>({type:"range",class:"form-range",min:r.get(l),max:r.get(c),...r.get(u)}),void 0,void 0,void 0,void 0,!0),r.reset(g),r.reset(p),r.template_effect(()=>{r.set_text(v,`${r.get(a)??""} `),r.set_text(y,`[${r.get(l)??""} to ${r.get(c)??""}`),r.set_text(C,r.get(s))}),r.bind_value(R,()=>n().value,e=>n().value=e),r.bind_value(E,()=>n().value,e=>n().value=e),r.append(e,p),r.pop()}function p(e,t){let n=r.derived(()=>r.to_array(t.optionStore,2)),i=r.derived(()=>r.get(n)[0]),o=r.derived(()=>r.get(n)[1]);var s=r.comment(),l=r.first_child(s),c=e=>{a(e,{get option(){return r.get(i)},get store(){return r.get(o)}})},d=e=>{var t=r.comment(),n=r.first_child(t),a=e=>{f(e,{get option(){return r.get(i)},get store(){return r.get(o)}})},s=e=>{var t=r.comment(),n=r.first_child(t),a=e=>{u(e,{get option(){return r.get(i)},get store(){return r.get(o)}})},s=e=>{var t=r.text();r.template_effect(()=>r.set_text(t,`unknown option type ${r.get(i)[1]??""} (${r.get(i)??""})`)),r.append(e,t)};r.if(n,e=>{"e"===r.get(i)[1]?e(a):e(s,!1)},!0),r.append(e,t)};r.if(n,e=>{"i"===r.get(i)[1]||"I"===r.get(i)[1]?e(a):e(s,!1)},!0),r.append(e,t)};r.if(l,e=>{"b"===r.get(i)[1]?e(c):e(d,!1)}),r.append(e,s)}var g=n(135),m=n(5),v=r.from_html('<div class="modal-footer"><button class="btn btn-danger me-auto">Reset</button> <button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button> <button class="btn btn-primary" data-bs-dismiss="modal">Create</button></div>'),b=r.from_html('<div class="card mb-3"><div class="card-header"><h4 class="float-start"> </h4> <div class="float-end"><button> </button> <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#newRoomModal">New</button></div></div> <div style="overflow-y: scroll; height: 50vh"><div class="d-flex align-items-center"><div class="flex-grow-1 me-2"><!></div> <button class="btn btn-sm btn-secondary"><div></div> Refresh</button></div> <!></div></div> <div class="modal" id="newRoomModal" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-dialog-centered" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">New room</h5> <div class="ms-auto"><button class="btn btn-sm btn-danger">Reset</button> <button class="btn btn-sm btn-primary" data-bs-dismiss="modal">Create</button> <button class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div></div> <div class="modal-body"><!></div> <!></div></div></div>',1);function y(e,t){let n,i,o;r.push(t,!0);let a=r.prop(t,"disableNew",3,!1),s=r.prop(t,"showNewRoomFooter",3,!1),l=r.prop(t,"refreshTimeoutBase",3,15e3),c=r.prop(t,"refreshTimeoutJitter",3,15e3),u=r.state(!1),d=r.state(0),h=r.state(1);function f(){return l()+Math.random()*c()}function p(){clearTimeout(n);let e=f();r.set(d,Date.now(),!0),r.set(h,Date.now()+e),n=setTimeout(()=>{t.onRefresh(),p()},e)}p(),(0,m.sA)(()=>clearTimeout(n));var y=b(),_=r.first_child(y),w=r.child(_),k=r.child(w),I=r.child(k);r.reset(k);var x=r.sibling(k,2),C=r.child(x);C.__click=()=>r.set(u,!r.get(u));var R=r.child(C,!0);r.reset(C);var E=r.sibling(C,2);r.reset(x),r.reset(w);var S=r.sibling(w,2),A=r.child(S),N=r.child(A),P=r.child(N);(0,g.A)(P,{get startTime(){return r.get(d)},get endTime(){return r.get(h)},active:!0}),r.reset(N);var T=r.sibling(N,2);T.__click=()=>(p(),t.onRefresh());var O=r.child(T);r.next(),r.reset(T),r.reset(A);var B=r.sibling(A,2);r.snippet(B,()=>t.children),r.reset(S),r.reset(_);var j=r.sibling(_,2),D=r.child(j),U=r.child(D),V=r.child(U),L=r.sibling(r.child(V),2),F=r.child(L);F.__click=function(...e){t.onResetRoomOptions?.apply(this,e)},r.sibling(F,2).__click=function(...e){t.onNewRoom?.apply(this,e)},r.next(2),r.reset(L),r.reset(V);var M=r.sibling(V,2),q=r.child(M);r.snippet(q,()=>t.newRoom),r.reset(M);var G=r.sibling(M,2),$=e=>{var n=v(),i=r.child(n);i.__click=function(...e){t.onResetRoomOptions?.apply(this,e)},r.sibling(i,4).__click=function(...e){t.onNewRoom?.apply(this,e)},r.reset(n),r.append(e,n)};r.if(G,e=>{s()&&e($)}),r.reset(U),r.reset(D),r.reset(j),r.template_effect(()=>{r.set_text(I,`Rooms (showing ${t.rooms.length??""}/${t.rooms.length??""})`),r.set_class(C,1,`btn btn-sm btn-${r.get(u)?"secondary":"warning"}`),r.set_text(R,r.get(u)?"Show":"Hide"),E.disabled=a(),i=r.set_class(S,1,"card-body",null,i,{"d-none":r.get(u)}),o=r.set_class(O,1,"spinner-border spinner-border-sm",null,o,{"d-none":!t.isRefreshing})}),r.append(e,y),r.pop()}r.delegate(["click"]);class _{c;id;constructor(e,t){this.c=e,this.id=t}get connected(){return this.c.connected}disconnect(){this.c.disconnect()}}class w{room;msgCallbacks=[];discCallbacks=[];constructor(e){this.room=e;const t=t=>{let n;if(!t.length){console.log("neterr: empty message",t),e.disconnect();return}try{n=t.getByteArray(0)}catch{console.log("neterr: first item is not byte array",t),e.disconnect();return}let r=Uint8Array.from(n);this.msgCallbacks.forEach(e=>e(r))},n=()=>{this.discCallbacks.forEach(e=>e()),e.c.removeMessageCallback(t),setTimeout(()=>e.c.removeDisconnectCallback(n),1)};e.c.addMessageCallback("",t),e.c.addDisconnectCallback(n)}get id(){return this.room.id}get connected(){return this.room.connected}disconnect(){this.room.disconnect()}send(e){this.room.c.send("",e)}registerRecv(e){this.msgCallbacks.push(e)}registerDisc(e){this.discCallbacks.push(e)}}n(136);class k{curConn;curConnId;static thenDisconnect(e){e.then(e=>e.disconnect())}async connect(e,t){if(t)for(;this.curConn&&t===this.curConnId;)try{return await this.curConn}catch{}this.curConnId=t;try{let t=this.curConn,n=await (this.curConn=e());return t&&k.thenDisconnect(t),n}catch(e){throw this.curConn=this.curConnId=void 0,e}}cancel(){this.curConn&&(k.thenDisconnect(this.curConn),this.curConn=this.curConnId=void 0)}}class I{client;cm=new k;constructor(e,t){this.client=e,this.client.multiplayer.useSecureConnections=!0,t&&(this.client.multiplayer.developmentServer=t)}createRoom(e,t,n=!0,r=null){return new Promise((i,o)=>this.client.multiplayer.createRoom(e,t,n,r,i,o))}createJoinRoom(e,t,n=!0,r=null,i=null){return this.cm.connect(()=>new Promise((o,a)=>this.client.multiplayer.createJoinRoom(e,t,n,r,i,t=>o(new _(t,e)),a)))}joinRoom(e,t=null){return this.cm.connect(()=>new Promise((n,r)=>this.client.multiplayer.joinRoom(e,t,t=>n(new _(t,e)),r)))}listRooms(e,t={},n=0,r=0){return new Promise((i,o)=>this.client.multiplayer.listRooms(e,t,n,r,i,o))}async disconnect(){}}class x{gameId;defaultConnectionID;cm=new k;constructor(e,t="public"){this.gameId=e,this.defaultConnectionID=t,PlayerIO.useSecureApiRequests=!0}async connect(e=this.defaultConnectionID,t={userId:"guest"},n={}){let r=()=>new Promise((r,i)=>PlayerIO.authenticate(this.gameId,e,t,n,e=>r(new I(e)),i));return await this.cm.connect(r,void 0)}cancel(){this.cm.cancel()}}var C=n(122),R=n(108),E=r.from_html("<div></div>"),S=r.from_html('<th scope="col"> </th>'),A=r.from_html("<td> </td>"),N=r.from_html('<tr><td><button class="btn btn-outline-primary btn-small">Join</button></td><!></tr>'),P=r.from_html('<tr><td class="text-center">No rooms</td></tr>'),T=r.from_html('<table class="table table-sm"><tbody><tr><th scope="col">Action</th><!></tr><!></tbody></table>');function O(e,t){r.push(t,!0);let n=r.prop(t,"joinData",3,null),i=r.prop(t,"columns",19,()=>[["Players",e=>o(e)],["ID",e=>e.id.slice(0,8)+"…",e=>e.id],["Game Mode",e=>t.formatGameMode(e.roomData)]]);function o(e){let t=e.onlineUsers,n=+e.roomData.activeCount||0,r=t-n;return r?`${n}+${r}`:t+""}let a=new x(t.gameId),s=t.roomCreateOptions.map(e=>[e,(0,R.C)(`game/mp/_roomCreate/${t.roomType}/${e[0]}`,e[2])]);function l(){return s.length?Object.fromEntries(s.map(([e,t])=>[e[0],t.value])):null}function c(){s.forEach(e=>e[1].value=e[0][2])}let u=r.state(r.proxy([])),d=r.state(!1),h=r.state(!1);async function f(){r.set(d,!0);try{let e=await m();r.set(u,await e.listRooms(t.roomType),!0)}catch(e){console.log(e),alert(e)}finally{r.set(d,!1)}}async function g(e){try{let n=await m(),r=await e(n);return f(),t.onJoinedRoom(new w(r)),r}catch(e){console.log(e),alert(e);return}}function m(){let e=a.connect();return r.set(h,!0),e}f();var v={refreshRooms:f};{let o=e=>{var t=E();r.each(t,21,()=>s,r.index,(e,t)=>{p(e,{get optionStore(){return r.get(t)}})}),r.reset(t),r.append(e,t)},a=r.derived(()=>!r.get(h)),m=r.derived(()=>s.length>8);y(e,{get isRefreshing(){return r.get(d)},get rooms(){return r.get(u)},get disableNew(){return r.get(a)},get showNewRoomFooter(){return r.get(m)},onRefresh:f,onResetRoomOptions:c,onNewRoom:()=>g(async e=>e.createJoinRoom((0,C.JY)(50),t.roomType,!0,l(),n())),newRoom:o,children:(e,o)=>{var a=T(),s=r.child(a),l=r.child(s),c=r.sibling(r.child(l));r.each(c,17,i,r.index,(e,t)=>{var n=S(),i=r.child(n,!0);r.reset(n),r.template_effect(()=>r.set_text(i,r.get(t)[0])),r.append(e,n)}),r.reset(l);var d=r.sibling(l);r.each(d,17,()=>r.get(u),r.index,(e,o)=>{let a;var s=N(),l=r.child(s);r.child(l).__click=()=>g(async e=>e.joinRoom(r.get(o).id,n())),r.reset(l);var c=r.sibling(l);r.each(c,17,i,r.index,(e,t)=>{var n=A(),i=r.child(n,!0);r.reset(n),r.template_effect((e,t)=>{r.set_attribute(n,"title",e),r.set_text(i,t)},[()=>r.get(t)[2]?r.get(t)[2](r.get(o)):"",()=>r.get(t)[1](r.get(o))]),r.append(e,n)}),r.reset(s),r.template_effect(()=>a=r.set_class(s,1,"",null,a,{"table-info":r.get(o).id==t.gameRoom?.id})),r.append(e,s)},e=>{var t=P(),n=r.child(t);r.reset(t),r.template_effect(()=>r.set_attribute(n,"colspan",1+i().length)),r.append(e,t)}),r.reset(s),r.reset(a),r.append(e,a)},$$slots:{newRoom:!0,default:!0}})}return r.pop(v)}r.delegate(["click"])},132(e,t,n){n.d(t,{A:()=>u}),n(1);var r=n(2),i=r.from_html('<button class="btn btn-sm btn-success">Unready</button>'),o=r.from_html('<button class="btn btn-sm btn-info">Ready</button>'),a=r.from_html('<!> <button class="btn btn-sm btn-secondary">Spectate</button>',1),s=r.from_html('<button class="btn btn-sm btn-primary">Unspectate</button>'),l=r.from_html('<div class="float-end"><!> <div class="btn-group"><button class="btn btn-sm btn-danger">Disconnect</button></div></div>'),c=r.from_html('<div role="alert"><h4 class="alert-heading">Disconnected</h4> Join or create a room above!</div> <div role="alert"><h4 class="alert-heading">Spectating</h4> <span class="badge text-bg-primary">Unspectate</span> if you want to play!</div> <div role="alert"><h4 class="alert-heading">Unready</h4> If all players are <span class="badge text-bg-info">Ready</span>, the intermission ends early.</div> <div class="card mb-3"><div class="card-header"><h4 class="float-start">Play</h4> <!></div> <div class="card-body"><!></div></div>',1);function u(e,t){let n,u,d;r.push(t,!0);let h=r.prop(t,"inGame",3,!1),f=r.prop(t,"isActive",3,!1),p=r.prop(t,"canReady",3,!1),g=r.prop(t,"isReady",3,!1);var m=c(),v=r.first_child(m),b=r.sibling(v,2),y=r.sibling(b,2),_=r.sibling(y,2),w=r.child(_),k=r.sibling(r.child(w),2),I=e=>{var n=l(),c=r.child(n),u=e=>{var n=a(),s=r.first_child(n),l=e=>{var n=r.comment(),a=r.first_child(n),s=e=>{var n=i();n.__click=()=>t.onReady(),r.append(e,n)},l=e=>{var n=o();n.__click=()=>t.onReady(),r.append(e,n)};r.if(a,e=>{g()?e(s):e(l,!1)}),r.append(e,n)};r.if(s,e=>{p()&&e(l)}),r.sibling(s,2).__click=()=>t.onActive(),r.append(e,n)},d=e=>{var n=s();n.__click=()=>t.onActive(),r.append(e,n)};r.if(c,e=>{f()?e(u):e(d,!1)});var h=r.sibling(c,2);r.child(h).__click=function(...e){t.onDisconnect?.apply(this,e)},r.reset(h),r.reset(n),r.append(e,n)};r.if(k,e=>{h()&&e(I)}),r.reset(w);var x=r.sibling(w,2),C=r.child(x);r.snippet(C,()=>t.children),r.reset(x),r.reset(_),r.template_effect(()=>{n=r.set_class(v,1,"alert alert-danger",null,n,{"d-none":h()}),u=r.set_class(b,1,"alert alert-warning",null,u,{"d-none":!h()||f()}),d=r.set_class(y,1,"alert alert-info",null,d,{"d-none":!h()||!f()||!p()||g()})}),r.append(e,m),r.pop()}r.delegate(["click"])},135(e,t,n){n.d(t,{A:()=>a}),n(1);var r=n(2),i=n(5),o=r.from_html('<div class="progress"><div> </div></div>');function a(e,t){r.push(t,!0);let n=r.prop(t,"start",3,0),a=r.prop(t,"end",3,1),s=r.state(0),l=r.state("0.0 s");(0,i.Rc)(()=>{let e;return!function i(){if(e=requestAnimationFrame(i),t.active){let e=Date.now();r.set(s,n()+(a()-n())*Math.min(1,(e-t.startTime)/(t.endTime-t.startTime))),r.set(l,Math.max((t.endTime-e)/1e3,0).toFixed(1)+" s")}}(),()=>cancelAnimationFrame(e)});var c=o(),u=r.child(c),d=r.child(u,!0);r.reset(u),r.reset(c),r.template_effect(()=>{r.set_class(u,1,`progress-bar${t.active?" progress-bar-striped progress-bar-animated":""}`),r.set_style(u,`transition: none; width:${100*r.get(s)}%`),r.set_text(d,r.get(l))}),r.append(e,c),r.pop()}},142(e,t,n){n.d(t,{A:()=>l}),n(1);var r=n(2),i=r.from_html("<span> </span>"),o=r.from_html("<div>Queue: <!></div>"),a=r.from_html("<div>Spectating: <!></div>"),s=r.from_html("<div>In game: <!></div> <!> <!>",1);function l(e,t){r.push(t,!0);let n=(e,n=r.noop,o=r.noop)=>{var a=i(),s=r.child(a);r.reset(a),r.template_effect(()=>{r.set_class(a,1,`badge text-bg${n()==t.localClient?"":"-outline"}-${o()??""} me-1`),r.set_text(s,`${n().name??""} (${n().cn??""})`)}),r.append(e,a)};var l=s(),c=r.first_child(l),u=r.sibling(r.child(c));r.each(u,17,()=>t.inGame,r.index,(e,t)=>{n(e,()=>r.get(t),()=>r.get(t).ready?"info":"primary")},e=>{r.next();var t=r.text("nobody");r.append(e,t)}),r.reset(c);var d=r.sibling(c,2),h=e=>{var i=o(),a=r.sibling(r.child(i));r.each(a,17,()=>t.inQueue,r.index,(e,t)=>{n(e,()=>r.get(t),()=>r.get(t).ready?"info":"secondary")},e=>{r.next();var t=r.text("nobody");r.append(e,t)}),r.reset(i),r.append(e,i)};r.if(d,e=>{t.inQueue&&e(h)});var f=r.sibling(d,2),p=e=>{var i=a(),o=r.sibling(r.child(i));r.each(o,17,()=>t.spectators,r.index,(e,t)=>{n(e,()=>r.get(t),()=>"secondary")}),r.reset(i),r.append(e,i)};r.if(f,e=>{t.spectators?.length&&e(p)}),r.append(e,l),r.pop()}},133(e,t,n){function r(e){return Object.fromEntries(e.map(e=>{let[t,n,r]=e;return[t,"I"==n?BigInt(r):r]}))}function i(e,t){let n=t;return Object.fromEntries(e.map(e=>{let[t,r]=e;switch(r){case"b":return[t,"true"===n[t]];case"I":return[t,BigInt(n[t])];case"e":case"i":return[t,+n[t]]}}))}n.d(t,{e:()=>i,q:()=>r})},139(e,t,n){n.d(t,{k:()=>r});class r{buf;v;pos=0;constructor(e){this.buf=e,this.v=new DataView(e.buffer,e.byteOffset,e.byteLength)}get debugBuf(){return this.v}get remaining(){return this.v.byteLength-this.pos}get(){return this.v.getUint8(this.pos++)}getUint16(){return this.get()<<8|this.get()}getCN(){let e=this.get();return 128&e?-1:63&e}getInt(){let e=this.v.getInt8(this.pos++);return -128===e?this.v.getInt16((this.pos+=2)-2,!0):-127===e?this.v.getInt32((this.pos+=4)-4,!0):e}getFloat64(){return this.v.getFloat64((this.pos+=8)-8)}static UINT64_BIAS=[567382630219904n,4432676798592n,34630287488n,270549120n,2113664n,16512n,128n];getUint64(){let e=this.get();if(e<128)return BigInt(e);if(255==e)return this.v.getBigUint64((this.pos+=8)-8);let t=31-Math.clz32(255^e),n=7-t,i=new Uint8Array(8);return i[t]=e&255>>n,i.set(this.buf.subarray(this.pos,this.pos+=n),t+1),new DataView(i.buffer).getBigUint64(0)+r.UINT64_BIAS[t]}getInt64(){let e=this.getUint64();return e>>1n^-(1n&e)}getString(e){let t=[];for(;t.length<=e;){let n=this.get();if(!n)break;if(t.length===e)throw Error("too long");t.push(n>127?63:n)}return String.fromCharCode(...t)}}},141(e,t,n){n.d(t,{U:()=>r});class r{buf=[];put(...e){return this.buf.push(...e),this}putInt(e){return e>-127&&e<128?this.put(e):e>=-32768&&e<32768?this.put(128,e,e>>8):this.put(129,e,e>>8,e>>16,e>>24),this}putFloat64(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e),this.put(...t)}putUint64(e){let t;if(e<0)throw Error("bad Uint64");if(e<128n)return this.put(Number(e));e<0x810204080?e<2113664?e<16512?(t=6,e-=128n):(t=5,e-=16512n):e<0x10204080?(t=4,e-=2113664n):(t=3,e-=270549120n):e<0x2040810204080?e<0x40810204080?(t=2,e-=34630287488n):(t=1,e-=4432676798592n):(t=0,e<0x102040810204080n?e=e-567382630219904n|0xfe00000000000000n:this.put(255));let n=new Uint8Array(8);return new DataView(n.buffer).setBigUint64(0,e),t&&(n[t]|=254<<t),this.put(...n.subarray(t))}putInt64(e){return this.putUint64(e<<1n^e>>63n)}putString(e){for(let t=0;t<e.length;t++){let n=e.charCodeAt(t),r=n>127?63:n;if(!r)break;this.put(r)}return this.put(0)}putFmt(e,...t){for(let n=0,r=0;n<e.length;n++){let i=e[n],o=e[n+1]>="0"&&e[n+1]<="9"?+e[++n]:1;switch(i){case"s":for(;o--;)this.putString(t[r++]);break;case"c":for(;o--;)this.put(t[r++]);break;case"i":for(;o--;)this.putInt(t[r++]);break;case"U":for(;o--;)this.putUint64(t[r++]);break;case"d":for(;o--;)this.putFloat64(t[r++])}}return this}toArray(){return Uint8Array.from(this.buf)}}},102(e,t,n){n.d(t,{A:()=>o});var r=n(5);let i=!1;function o(e){let t=document.getElementById("app"),n=(0,r.Or)(e,{target:t});i&&(window.app=n),document.getElementById("appLoading")?.remove()}},136(){var JSON;void 0===window._pio&&(window._pio={}),function(){_pio.channel=function(){},_pio.channel.prototype.call=function(e,t,n,r,i){var o="u">typeof PLAYERIO_API_HOST?PLAYERIO_API_HOST:(PlayerIO.useSecureApiRequests?"https":"http")+"://api.playerio.com/json/",a=new XMLHttpRequest;"withCredentials"in a?a.open("post",o,!0):"u">typeof XDomainRequest?(a=new XDomainRequest).open("post",o):a=new _pio.flashWebRequest("post",o);var s=Error();null!=a?(a.send("["+e+"|"+(this.token||"")+"]"+JSON.stringify(t)),a.onload=function(){var e=null;try{var t=a.response||a.responseText;if("["==t[0]){var o=t.indexOf("]");this.token=t.substring(1,o),t=t.substring(o+1)}e=JSON.parse(t)}catch(e){_pio.handleError(s,r,PlayerIOErrorCode.GeneralError,"Error decoding response from webservice: "+e);return}if(void 0===e.errorcode&&void 0===e.message){var l=e;if(i)try{l=i(e)}catch(e){_pio.handleError(s,r,PlayerIOErrorCode.GeneralError,e.message)}n&&n(l)}else _pio.handleError(s,r,e.errorcode,e.message)},a.onerror=function(e){_pio.handleError(s,r,PlayerIOErrorCode.GeneralError,"Error talking to webservice: "+JSON.stringify(e))}):_pio.handleError(s,r,PlayerIOErrorCode.GeneralError,"Need to implement flash calling")},_pio.runCallback=function(e,t,n){try{e&&e(t)}catch(e){var r="Unhandled error in callback: "+e.message;r+="\nStack:\n",r+=e.stack||e.stacktrace||e.StackTrace,n&&(r+="\nCallsite stack:\n",r+=n.stack||n.stacktrace||n.StackTrace),console.log(r)}},_pio.handleError=function(e,t,n,r){var i=_pio.error(n,r);e&&(e.stack&&(i.stack=e.stack),e.stacktrace&&(i.stacktrace=e.stacktrace),e.StackTrace&&(i.StackTrace=e.StackTrace)),t?_pio.runCallback(t,i,e):"u">typeof console?console.log("No error callback specified for: "+i.code+": "+i.message+"\n"+(i.stack||i.stacktrace||i.StackTrace)):alert("No error callback specified for: "+i.code+": "+i.message+"\n"+(i.stack||i.stacktrace||i.StackTrace))},_pio.error=function(e,t){if(1==arguments.length&&(t=e,e=PlayerIOErrorCode.GeneralError),"number"==typeof e&&(e=PlayerIOErrorCode.codes[e]),"string"!=typeof e)throw console.log(e,t,Error().stack),"Code must be a string!";var n=Error();return new PlayerIOError(e,t,n.stack||n.stacktrace||n.StackTrace)},_pio.debugLog=function(e){"u">typeof console&&console.log(e)},_pio.convertToKVArray=function(e){var t=[];if(e)for(var n in e)t.push({key:""+n,value:""+e[n]});return t},_pio.convertFromKVArray=function(e){var t={};if(e&&e.length)for(var n in e)t[e[n].key]=e[n].value;return t},_pio.convertToSegmentArray=function(e){var t=[];if(e)for(var n in e)t.push(n+":"+e[n]);return t}}(),window.PlayerIO={useSecureApiRequests:!1,authenticate:function(e,t,n,r,i,o){if("auto"==n.publishingnetworklogin)return void 0===window.PublishingNetwork?void o(new PlayerIOError(PlayerIOErrorCode.GeneralError,"Could not find the PublishingNetwork object on the current page. Did you include the PublishingNetwork.js script?")):void PublishingNetwork.dialog("login",{gameId:e,connectionId:t,__use_usertoken__:!0},function(n){n.error?o(new PlayerIOError(PlayerIOErrorCode.GeneralError,n.error)):void 0===n.userToken?o(new PlayerIOError(PlayerIOErrorCode.GeneralError,"Missing userToken value in result, but no error message given.")):PlayerIO.authenticate(e,t,{userToken:n.userToken},r,i,o)});var a=new _pio.channel;a.authenticate(e,t,_pio.convertToKVArray(n),_pio.convertToSegmentArray(r),"javascript",_pio.convertToKVArray({}),null,i,o,function(t){return a.token=t.token,new _pio.client(a,e,t.gamefsredirectmap,t.userid)})},quickConnect:null,gameFS:function(e){return new _pio.gameFS(e)}},JSON||(JSON={}),function(){function f(e){return e<10?"0"+e:e}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var gap,indent,rep,cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,o,a,s=gap,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(l)){for(n=0,o=l.length;n<o;n+=1)a[n]=str(n,l)||"null";return i=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+s+"]":"["+a.join(",")+"]",gap=s,i}if(rep&&"object"==typeof rep)for(n=0,o=rep.length;n<o;n+=1)"string"==typeof rep[n]&&(i=str(r=rep[n],l))&&a.push(quote(r)+(gap?": ":":")+i);else for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(i=str(r,l))&&a.push(quote(r)+(gap?": ":":")+i);return i=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+s+"}":"{"+a.join(",")+"}",gap=s,i}}"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var r;if(gap="",indent="","number"==typeof n)for(r=0;r<n;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){var j;function walk(e,t){var n,r,i=e[t];if(i&&"object"==typeof i)for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(void 0!==(r=walk(i,n))?i[n]=r:delete i[n]);return reviver.call(e,t,i)}if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw SyntaxError("JSON.parse")})}(),function(){var e={},t=0,n="http://192.168.30.154/html5client/FlashFallback/bin-debug/FlashFallback.swf";window.__pio_flashfallback_callback__=function(){var t=e[arguments[0]];if(t){for(var n=[],r=1;r!=arguments.length;r++)n[r-1]=arguments[r];t.apply(null,n)}},_pio.flashWebRequest=function(n,r){var i=this;this.response=null,this.onload=function(){},this.onerror=function(){},this.send=function(o){a(function(a){if(null==a)i.onerror("Browser does not support Cross-Origin (CORS) webrequest or Flash as a fallback method");else{var s="cb"+t++;e[s]=function(t,n){delete e[s],t?(i.response=n,i.onload()):i.onerror(n)},a.webrequest(s,n,r,o)}})}},_pio.flashSocketConnection=function(n,r,i,o,s){var l="cb"+t++,c=this,u=new _pio.messageSerializer,d=!1,h=!1,f=setTimeout(function(){d||(d=!0,i(!1,"Connect attempt timed out"))},r);this.disconnect=function(){console.log("... this shouldn't happen")},this.sendMessage=function(e){console.log("... send msg. this shouldn't happen")},a(function(t){null==t?(d=!0,i(!1,"Browser does not support WebSocket connections and the Flash fallback failed.")):(e[l]=function(e,n){switch(e){case"onopen":d||(clearTimeout(f),d=!0,h=!0,t.socketSend(l,[0]),i(h));break;case"onclose":case"onerror":c.disconnect();break;case"onmessage":s(u.deserializeMessage(n,0,n.length))}},c.disconnect=function(){if(h){h=!1,o();try{t.socketClose(l)}catch(e){_pio.debugLog(e)}}},c.sendMessage=function(e){var n=u.serializeMessage(e);t.socketSend(l,n)},t.socketConnection(l,n))})},_pio.isFlashFallbackEnabled=function(e){a(function(t){e(null!=t)})};var r=null,i=!1,o=null;function a(e){if(null!=r)e(r);else if(i)e(null);else if(null==o){o=[e];var t=setInterval(function(){var e=s();null!=e&&n(e)},50);setTimeout(function(){null==r&&n(null)},3e4);var n=function(e){r=e,i=null==e,clearInterval(t);for(var n=0;n!=o.length;n++)o[n](e)}}else o.push(e)}function s(){var e="__pio_flashfallback__",t="";t+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="10" height="10" style="$style$" id="$id$">',t+='	<param name="movie" value="$src$" />',t+='	<param name="allowNetworking" value="all" />',t+='	<param name="allowScriptAccess" value="always" />',t+="	\x3c!--[if !IE]>--\x3e",t+='	<object type="application/x-shockwave-flash" data="$src$" width="10" height="10" style="$style$">',t+='		<param name="allowNetworking" value="all" />',t+='		<param name="allowScriptAccess" value="always" />',t+="	</object>",t+="	\x3c!--<![endif]--\x3e",t+="</object>",t=(t=(t=t.replace(/\$id\$/gi,e)).replace(/\$src\$/gi,n)).replace(/\$style\$/gi,"width:10px;height:10px");var r=document.getElementById("containerId");if(!r){var i=document.createElement("div");i.setAttribute("id",r),i.setAttribute("style","position:absolute;top:-20px;left:-20px"),i.innerHTML=t;try{document.body.appendChild(i)}catch(e){}}var o=function(e){for(var t=document.getElementsByTagName(e),n=0;n!=t.length;n++)if(t[n].ping&&"pong"==t[n].ping())return t[n]};return o("embed")||o("object")}}(),function(){var e=_pio.channel.prototype;e.connect=function(e,t,n,r,i,o,a,s,l,c,u){this.call(10,{gameid:e,connectionid:t,userid:n,auth:r,partnerid:i,playerinsightsegments:o,clientapi:a,clientinfo:s},l,c,u)},_pio.ApiSecurityRule={RespectClientSetting:0,UseHttp:1,UseHttps:2},e.authenticate=function(e,t,n,r,i,o,a,s,l,c){this.call(13,{gameid:e,connectionid:t,authenticationarguments:n,playerinsightsegments:r,clientapi:i,clientinfo:o,playcodes:a},s,l,c)},e.createRoom=function(e,t,n,r,i,o,a,s){this.call(21,{roomid:e,roomtype:t,visible:n,roomdata:r,isdevroom:i},o,a,s)},e.joinRoom=function(e,t,n,r,i,o,a){this.call(24,{roomid:e,joindata:t,isdevroom:n,serverdomainnameneeded:r},i,o,a)},e.createJoinRoom=function(e,t,n,r,i,o,a,s,l,c){this.call(27,{roomid:e,roomtype:t,visible:n,roomdata:r,joindata:i,isdevroom:o,serverdomainnameneeded:a},s,l,c)},e.listRooms=function(e,t,n,r,i,o,a,s){this.call(30,{roomtype:e,searchcriteria:t,resultlimit:n,resultoffset:r,onlydevrooms:i},o,a,s)},e.userLeftRoom=function(e,t,n,r,i,o){this.call(40,{extendedroomid:e,newplayercount:t,closed:n},r,i,o)},e.writeError=function(e,t,n,r,i,o,a,s){this.call(50,{source:e,error:t,details:n,stacktrace:r,extradata:i},o,a,s)},e.updateRoom=function(e,t,n,r,i,o){this.call(53,{extendedroomid:e,visible:t,roomdata:n},r,i,o)},_pio.ValueType={String:0,Int:1,UInt:2,Long:3,Bool:4,Float:5,Double:6,ByteArray:7,DateTime:8,Array:9,Obj:10},e.createObjects=function(e,t,n,r,i){this.call(82,{objects:e,loadexisting:t},n,r,i)},e.loadObjects=function(e,t,n,r){this.call(85,{objectids:e},t,n,r)},_pio.LockType={NoLocks:0,LockIndividual:1,LockAll:2},e.saveObjectChanges=function(e,t,n,r,i,o){this.call(88,{locktype:e,changesets:t,createifmissing:n},r,i,o)},e.deleteObjects=function(e,t,n,r){this.call(91,{objectids:e},t,n,r)},e.loadMatchingObjects=function(e,t,n,r,i,o,a){this.call(94,{table:e,index:t,indexvalue:n,limit:r},i,o,a)},e.loadIndexRange=function(e,t,n,r,i,o,a,s){this.call(97,{table:e,index:t,startindexvalue:n,stopindexvalue:r,limit:i},o,a,s)},e.deleteIndexRange=function(e,t,n,r,i,o,a){this.call(100,{table:e,index:t,startindexvalue:n,stopindexvalue:r},i,o,a)},e.loadMyPlayerObject=function(e,t,n){this.call(103,{},e,t,n)},e.payVaultReadHistory=function(e,t,n,r,i,o){this.call(160,{page:e,pagesize:t,targetuserid:n},r,i,o)},e.payVaultRefresh=function(e,t,n,r,i){this.call(163,{lastversion:e,targetuserid:t},n,r,i)},e.payVaultConsume=function(e,t,n,r,i){this.call(166,{ids:e,targetuserid:t},n,r,i)},e.payVaultCredit=function(e,t,n,r,i,o){this.call(169,{amount:e,reason:t,targetuserid:n},r,i,o)},e.payVaultDebit=function(e,t,n,r,i,o){this.call(172,{amount:e,reason:t,targetuserid:n},r,i,o)},e.payVaultBuy=function(e,t,n,r,i,o){this.call(175,{items:e,storeitems:t,targetuserid:n},r,i,o)},e.payVaultGive=function(e,t,n,r,i){this.call(178,{items:e,targetuserid:t},n,r,i)},e.payVaultPaymentInfo=function(e,t,n,r,i,o){this.call(181,{provider:e,purchasearguments:t,items:n},r,i,o)},e.payVaultUsePaymentInfo=function(e,t,n,r,i){this.call(184,{provider:e,providerarguments:t},n,r,i)},e.partnerPayTrigger=function(e,t,n,r,i){this.call(200,{key:e,count:t},n,r,i)},e.partnerPaySetTag=function(e,t,n,r){this.call(203,{partnerid:e},t,n,r)},e.notificationsRefresh=function(e,t,n,r){this.call(213,{lastversion:e},t,n,r)},e.notificationsRegisterEndpoints=function(e,t,n,r,i){this.call(216,{lastversion:e,endpoints:t},n,r,i)},e.notificationsSend=function(e,t,n,r){this.call(219,{notifications:e},t,n,r)},e.notificationsToggleEndpoints=function(e,t,n,r,i,o){this.call(222,{lastversion:e,endpoints:t,enabled:n},r,i,o)},e.notificationsDeleteEndpoints=function(e,t,n,r,i){this.call(225,{lastversion:e,endpoints:t},n,r,i)},e.gameRequestsSend=function(e,t,n,r,i,o){this.call(241,{requesttype:e,requestdata:t,requestrecipients:n},r,i,o)},e.gameRequestsRefresh=function(e,t,n,r){this.call(244,{playcodes:e},t,n,r)},e.gameRequestsDelete=function(e,t,n,r){this.call(247,{requestids:e},t,n,r)},e.achievementsRefresh=function(e,t,n,r){this.call(271,{lastversion:e},t,n,r)},e.achievementsLoad=function(e,t,n,r){this.call(274,{userids:e},t,n,r)},e.achievementsProgressSet=function(e,t,n,r,i){this.call(277,{achievementid:e,progress:t},n,r,i)},e.achievementsProgressAdd=function(e,t,n,r,i){this.call(280,{achievementid:e,progressdelta:t},n,r,i)},e.achievementsProgressMax=function(e,t,n,r,i){this.call(283,{achievementid:e,progress:t},n,r,i)},e.achievementsProgressComplete=function(e,t,n,r){this.call(286,{achievementid:e},t,n,r)},e.playerInsightRefresh=function(e,t,n){this.call(301,{},e,t,n)},e.playerInsightSetSegments=function(e,t,n,r){this.call(304,{segments:e},t,n,r)},e.playerInsightTrackInvitedBy=function(e,t,n,r,i){this.call(307,{invitinguserid:e,invitationchannel:t},n,r,i)},e.playerInsightTrackEvents=function(e,t,n,r){this.call(311,{events:e},t,n,r)},e.playerInsightTrackExternalPayment=function(e,t,n,r,i){this.call(314,{currency:e,amount:t},n,r,i)},e.playerInsightSessionKeepAlive=function(e,t,n){this.call(317,{},e,t,n)},e.playerInsightSessionStop=function(e,t,n){this.call(320,{},e,t,n)},e.oneScoreLoad=function(e,t,n,r){this.call(351,{userids:e},t,n,r)},e.oneScoreSet=function(e,t,n,r){this.call(354,{score:e},t,n,r)},e.oneScoreAdd=function(e,t,n,r){this.call(357,{score:e},t,n,r)},e.oneScoreRefresh=function(e,t,n){this.call(360,{},e,t,n)},e.simpleConnect=function(e,t,n,r,i,o,a,s,l){this.call(400,{gameid:e,usernameoremail:t,password:n,playerinsightsegments:r,clientapi:i,clientinfo:o},a,s,l)},e.simpleRegister=function(e,t,n,r,i,o,a,s,l,c,u,d,h,f){this.call(403,{gameid:e,username:t,password:n,email:r,captchakey:i,captchavalue:o,extradata:a,partnerid:s,playerinsightsegments:l,clientapi:c,clientinfo:u},d,h,f)},e.simpleRecoverPassword=function(e,t,n,r,i){this.call(406,{gameid:e,usernameoremail:t},n,r,i)},e.kongregateConnect=function(e,t,n,r,i,o,a,s,l){this.call(412,{gameid:e,userid:t,gameauthtoken:n,playerinsightsegments:r,clientapi:i,clientinfo:o},a,s,l)},e.simpleGetCaptcha=function(e,t,n,r,i,o){this.call(415,{gameid:e,width:t,height:n},r,i,o)},e.facebookOAuthConnect=function(e,t,n,r,i,o,a,s,l){this.call(418,{gameid:e,accesstoken:t,partnerid:n,playerinsightsegments:r,clientapi:i,clientinfo:o},a,s,l)},e.steamConnect=function(e,t,n,r,i,o,a,s,l){this.call(421,{gameid:e,steamappid:t,steamsessionticket:n,playerinsightsegments:r,clientapi:i,clientinfo:o},a,s,l)},e.simpleUserGetSecureLoginInfo=function(e,t,n){this.call(424,{},e,t,n)},e.leaderboardsGet=function(e,t,n,r,i,o,a,s,l){this.call(431,{group:e,leaderboard:t,index:n,count:r,neighbouruserid:i,filteruserids:o},a,s,l)},e.leaderboardsSet=function(e,t,n,r,i,o){this.call(434,{group:e,leaderboard:t,score:n},r,i,o)},e.leaderboardsCount=function(e,t,n,r,i){this.call(437,{group:e,leaderboard:t},n,r,i)},e.joinCluster=function(e,t,n,r,i,o,a,s,l,c,u,d,h,f,p,g,m){this.call(504,{clusteraccesskey:e,isdevelopmentserver:t,ports:n,machinename:r,version:i,machineid:o,os:a,cpu:s,cpucores:l,cpulogicalcores:c,cpuaddresswidth:u,cpumaxclockspeed:d,rammegabytes:h,ramspeed:f},p,g,m)},e.serverHeartbeat=function(e,t,n,r,i,o,a,s,l,c,u,d,h,f,p,g,m,v,b,y){this.call(510,{serverid:e,appdomains:t,servertypes:n,machinecpu:r,processcpu:i,memoryusage:o,avaliablememory:a,freememory:s,runningrooms:l,usedresources:c,apirequests:u,apirequestserror:d,apirequestsfailed:h,apirequestsexecuting:f,apirequestsqueued:p,apirequeststime:g,serverunixtimeutc:m},v,b,y)},e.getGameAssemblyUrl=function(e,t,n,r,i,o){this.call(513,{clusteraccesskey:e,gamecodeid:t,machineid:n},r,i,o)},e.devServerLogin=function(e,t,n,r,i){this.call(524,{username:e,password:t},n,r,i)},e.webserviceOnlineTest=function(e,t,n){this.call(533,{},e,t,n)},e.getServerInfo=function(e,t,n,r){this.call(540,{machineid:e},t,n,r)},e.socialRefresh=function(e,t,n){this.call(601,{},e,t,n)},e.socialLoadProfiles=function(e,t,n,r){this.call(604,{userids:e},t,n,r)}}(),window.PlayerIOError=function(e,t,n){if(this.code=e,this.message=t,this.stack=n,!this.stack){var r=Error();this.stack=r.stack||r.stacktrace||r.StackTrace}this.toString=function(){return"PlayerIOError["+e+"]: "+t}},PlayerIOError.prototype=Error(),window.PlayerIOErrorCode={UnsupportedMethod:"UnsupportedMethod",GeneralError:"GeneralError",InternalError:"InternalError",AccessDenied:"AccessDenied",InvalidMessageFormat:"InvalidMessageFormat",MissingValue:"MissingValue",GameRequired:"GameRequired",ExternalError:"ExternalError",ArgumentOutOfRange:"ArgumentOutOfRange",GameDisabled:"GameDisabled",UnknownGame:"UnknownGame",UnknownConnection:"UnknownConnection",InvalidAuth:"InvalidAuth",NoServersAvailable:"NoServersAvailable",RoomDataTooLarge:"RoomDataTooLarge",RoomAlreadyExists:"RoomAlreadyExists",UnknownRoomType:"UnknownRoomType",UnknownRoom:"UnknownRoom",MissingRoomId:"MissingRoomId",RoomIsFull:"RoomIsFull",NotASearchColumn:"NotASearchColumn",QuickConnectMethodNotEnabled:"QuickConnectMethodNotEnabled",UnknownUser:"UnknownUser",InvalidPassword:"InvalidPassword",InvalidRegistrationData:"InvalidRegistrationData",InvalidBigDBKey:"InvalidBigDBKey",BigDBObjectTooLarge:"BigDBObjectTooLarge",BigDBObjectDoesNotExist:"BigDBObjectDoesNotExist",UnknownTable:"UnknownTable",UnknownIndex:"UnknownIndex",InvalidIndexValue:"InvalidIndexValue",NotObjectCreator:"NotObjectCreator",KeyAlreadyUsed:"KeyAlreadyUsed",StaleVersion:"StaleVersion",CircularReference:"CircularReference",HeartbeatFailed:"HeartbeatFailed",InvalidGameCode:"InvalidGameCode",VaultNotLoaded:"VaultNotLoaded",UnknownPayVaultProvider:"UnknownPayVaultProvider",DirectPurchaseNotSupportedByProvider:"DirectPurchaseNotSupportedByProvider",BuyingCoinsNotSupportedByProvider:"BuyingCoinsNotSupportedByProvider",NotEnoughCoins:"NotEnoughCoins",ItemNotInVault:"ItemNotInVault",InvalidPurchaseArguments:"InvalidPurchaseArguments",InvalidPayVaultProviderSetup:"InvalidPayVaultProviderSetup",UnknownPartnerPayAction:"UnknownPartnerPayAction",InvalidType:"InvalidType",IndexOutOfBounds:"IndexOutOfBounds",InvalidIdentifier:"InvalidIdentifier",InvalidArgument:"InvalidArgument",LoggedOut:"LoggedOut",InvalidSegment:"InvalidSegment",GameRequestsNotLoaded:"GameRequestsNotLoaded",AchievementsNotLoaded:"AchievementsNotLoaded",UnknownAchievement:"UnknownAchievement",NotificationsNotLoaded:"NotificationsNotLoaded",InvalidNotificationsEndpoint:"InvalidNotificationsEndpoint",NetworkIssue:"NetworkIssue",OneScoreNotLoaded:"OneScoreNotLoaded",PublishingNetworkNotAvailable:"PublishingNetworkNotAvailable",PublishingNetworkNotLoaded:"PublishingNetworkNotLoaded",DialogClosed:"DialogClosed",AdTrackCheckCookie:"AdTrackCheckCookie",codes:{0:"UnsupportedMethod",1:"GeneralError",2:"InternalError",3:"AccessDenied",4:"InvalidMessageFormat",5:"MissingValue",6:"GameRequired",7:"ExternalError",8:"ArgumentOutOfRange",9:"GameDisabled",10:"UnknownGame",11:"UnknownConnection",12:"InvalidAuth",13:"NoServersAvailable",14:"RoomDataTooLarge",15:"RoomAlreadyExists",16:"UnknownRoomType",17:"UnknownRoom",18:"MissingRoomId",19:"RoomIsFull",20:"NotASearchColumn",21:"QuickConnectMethodNotEnabled",22:"UnknownUser",23:"InvalidPassword",24:"InvalidRegistrationData",25:"InvalidBigDBKey",26:"BigDBObjectTooLarge",27:"BigDBObjectDoesNotExist",28:"UnknownTable",29:"UnknownIndex",30:"InvalidIndexValue",31:"NotObjectCreator",32:"KeyAlreadyUsed",33:"StaleVersion",34:"CircularReference",40:"HeartbeatFailed",41:"InvalidGameCode",50:"VaultNotLoaded",51:"UnknownPayVaultProvider",52:"DirectPurchaseNotSupportedByProvider",54:"BuyingCoinsNotSupportedByProvider",55:"NotEnoughCoins",56:"ItemNotInVault",57:"InvalidPurchaseArguments",58:"InvalidPayVaultProviderSetup",70:"UnknownPartnerPayAction",80:"InvalidType",81:"IndexOutOfBounds",82:"InvalidIdentifier",83:"InvalidArgument",84:"LoggedOut",90:"InvalidSegment",100:"GameRequestsNotLoaded",110:"AchievementsNotLoaded",111:"UnknownAchievement",120:"NotificationsNotLoaded",121:"InvalidNotificationsEndpoint",130:"NetworkIssue",131:"OneScoreNotLoaded",200:"PublishingNetworkNotAvailable",201:"PublishingNetworkNotLoaded",301:"DialogClosed",302:"AdTrackCheckCookie"}},function(){_pio.client=function(e,t,n,r){this.connectUserId=r,this.gameId=t,this.gameFS=new _pio.gameFS(t,n),this.errorLog=new _pio.errorLog(e),this.payVault=new _pio.payVault(e),this.bigDB=new _pio.bigDB(e),this.multiplayer=new _pio.multiplayer(e),this.gameRequests=new _pio.gameRequests(e),this.achievements=new _pio.achievements(e),this.playerInsight=new _pio.playerInsight(e),this.oneScore=new _pio.oneScore(e),this.leaderboards=new _pio.leaderboards(e,this.connectUserId),this.notifications=new _pio.notifications(e),this.publishingNetwork=new _pio.publishingNetwork(e,this.connectUserId)}}(),function(){var e={};_pio.gameFS=function(t,n){if("string"==typeof n&&n.length>0){var r=(n||"").split("|");if(r.length>=1)for(var i=e[t.toLowerCase()]={},o=0;o!=r.length;o++){var a=r[o];"alltoredirect"==a||"cdnmap"==a?i.baseUrl=r[o+1]:"alltoredirectsecure"==a||"cdnmapsecure"==a?i.secureBaseUrl=r[o+1]:i["."+a]=r[o+1]}}this.getUrl=function(n,r){if("/"==!n[0])throw _pio.error("The path given to getUrl must start with a slash, like: '/myfile.swf' or '/folder/file.jpg'");var i=e[t];return i?(r?i.secureBaseUrl:i.baseUrl)+(i["."+n]||n):(r?"https":"http")+"://r.playerio.com/r/"+t+n}}}(),function(){_pio.gameRequests=function(e){var t=[];this.waitingRequests="[ERROR: You tried to access gameRequests.waitingRequests before loading waiting requests. You have to call the refresh method first.]";var n=this;function r(e){if(null==e||0==e.length)return[];for(var t=[],n=0;n!=e.length;n++){var r=e[n];t.push(new _pio.gameRequest(r.id,r.type,r.senderuserid,r.created,r.data))}return t}this.send=function(t,n,r,i,o){e.gameRequestsSend(t,_pio.convertToKVArray(n),r,i,o,function(e){})},this.refresh=function(i,o){e.gameRequestsRefresh(t,i,o,function(e){n._playCodes=e.newplaycodes,n.waitingRequests=r(e.requests),e.morerequestswaiting})},this.delete=function(t,i,o){if("object"!=typeof t&&!t.length){var a=_pio.error("The first argument to delete should be an array: client.gameRequests.delete([requests], ...)");_pio.handleError(a,o,a.code,a.message);return}for(var s=[],l=0;l!=t.length;l++){var c=t[l].id;if(c)s.push(c);else{var a=_pio.error("No GameRequest id found on item#"+l+". You have to use requests from the gameRequests.waitingRequests array. For instance: client.gameRequests.delete(client.gameRequests.waitingRequests, ...)");_pio.handleError(a,o,a.code,a.message);return}}e.gameRequestsDelete(s,i,o,function(e){n.waitingRequests=r(e.requests),e.morerequestswaiting})}},_pio.gameRequest=function(e,t,n,r,i){this.id=e,this.type=t,this.senderUserId=n,this.created=new Date(r),this.data=_pio.convertFromKVArray(i)}}(),function(){_pio.errorLog=function(e){this.writeError=function(t,n,r,i){e.writeError("Javascript",t,n,r,_pio.convertToKVArray(i))}}}(),function(){_pio.quickConnect=function(){this.simpleGetCaptcha=function(e,t,n,r,i){new _pio.channel().simpleGetCaptcha(e,t,n,r,i,function(e){return new _pio.simpleGetCaptchaOutput(e.captchakey,e.captchaimageurl)})},this.simpleRecoverPassword=function(e,t,n,r){new _pio.channel().simpleRecoverPassword(e,t,n,r,function(e){})}},_pio.simpleGetCaptchaOutput=function(e,t){this.captchaKey=e,this.captchaImageUrl=t},PlayerIO.quickConnect=new _pio.quickConnect}(),function(){_pio.payVault=function(e){var t=null;this.coins="[ERROR: you tried to access payVault.coins before the vault was loaded. You have to refresh the vault before the .coins property is set to the right value]",this.items="[ERROR: you tried to access payVault.items before the vault was loaded. You have to refresh the vault before the .items property is set to the right value]",this.has=function(e){if(null==t)throw new PlayerIOError(PlayerIOErrorCode.VaultNotLoaded,"Cannot access items before vault has been loaded. Please refresh the vault first");for(var n=0;n!=this.items.length;n++)if(this.items[n].itemKey==e)return!0;return!1},this.first=function(e){if(null==t)throw new PlayerIOError(PlayerIOErrorCode.VaultNotLoaded,"Cannot access items before vault has been loaded. Please refresh the vault first");for(var n=0;n!=this.items.length;n++)if(this.items[n].itemKey==e)return this.items[n];return null},this.count=function(e){if(null==t)throw new PlayerIOError(PlayerIOErrorCode.VaultNotLoaded,"Cannot access items before vault has been loaded. Please refresh the vault first");for(var n=0,r=0;r!=this.items.length;r++)this.items[r].itemKey==e&&n++;return n},this.refresh=function(n,i){e.payVaultRefresh(t,null,n,i,function(e){r(e.vaultcontents)})},this.readHistory=function(t,n,r,i){e.payVaultReadHistory(t,n,null,r,i,function(e){for(var t=[],n=0;n!=e.entries.length;n++){var r=e.entries[n];t.push(new _pio.payVaultHistoryEntry(r.type,r.amount,r.timestamp,r.itemkeys||[],r.reason,r.providertransactionid,r.providerprice))}return t})},this.credit=function(t,n,i,o){e.payVaultCredit(t,n,null,i,o,function(e){r(e.vaultcontents)})},this.debit=function(t,n,i,o){e.payVaultDebit(t,n,null,i,o,function(e){r(e.vaultcontents)})},this.consume=function(t,n,i){if("object"!=typeof t&&!t.length){var o=_pio.error("The first argument to consume should be an array: client.payVault.consume([item], ...)");_pio.handleError(o,i,o.code,o.message);return}for(var a=[],s=0;s!=t.length;s++){var l=t[s].id;if(l)a.push(l);else{var o=_pio.error("No PayVault item id found on item#"+s+". You have to use items from the payVault.items array. For instance: client.payVault.consume([client.payVault.first('sportscar')], ...)");_pio.handleError(o,i,o.code,o.message);return}}e.payVaultConsume(a,null,n,i,function(e){r(e.vaultcontents)})},this.buy=function(t,n,i,o){e.payVaultBuy(_pio.convertBuyItems(t),n,null,i,o,function(e){r(e.vaultcontents)})},this.give=function(t,n,i){e.payVaultGive(_pio.convertBuyItems(t),null,n,i,function(e){r(e.vaultcontents)})},this.getBuyCoinsInfo=function(t,n,r,i){e.payVaultPaymentInfo(t,_pio.convertToKVArray(n),null,r,i,function(e){return _pio.convertFromKVArray(e.providerarguments)})},this.getBuyDirectInfo=function(t,n,r,i,o){e.payVaultPaymentInfo(t,_pio.convertToKVArray(n),_pio.convertBuyItems(r),i,o,function(e){return _pio.convertFromKVArray(e.providerarguments)})};var n=this;function r(e){if(null!=e&&(t=e.version,n.coins=e.coins||0,n.items=[],e.items&&e.items.length))for(var r=0;r!=e.items.length;r++){var i=e.items[r],o=n.items[r]=new _pio.vaultItem(i.id,i.itemkey,new Date().setTime(i.purchasedate));_pio.bigDBDeserialize(i.properties,o,!0)}}},_pio.convertBuyItems=function(e){if(null==e)return[];for(var t=[],n=0;n!=e.length;n++){var r=e[n].itemkey;if(!r)throw _pio.error("You have to specify an itemkey for the payvault item. Example:  {itemkey:'car'}");t.push({itemkey:r,payload:_pio.compareForChanges({itemkey:r},e[n],!0,!0)})}return t},_pio.vaultItem=function(e,t,n){this.id=e,this.itemKey=t,this.purchaseDate=n},_pio.payVaultHistoryEntry=function(e,t,n,r,i,o,a){this.type=e,this.amount=t,this.timestamp=new Date().setTime(n),this.itemKeys=r,this.reason=i,this.providerTransactionId=o,this.providerPrice=a}}(),function(){_pio.bigDB=function(e){var t=this,n=[];function r(){for(var e=0;e<n.length;e++){var t=n[e],r=!0;for(var i in t.objects)if(t.objects[i]._internal_("get-is-saving")){r=!1;break}if(r){for(var i in t.objects)for(var o=e+1;o<n.length;o++){futureSave=n[o];for(var a=0;a<futureSave.objects.length;a++)futureSave.objects[a]==t.objects[i]&&futureSave.fullOverwrite==t.fullOverwrite&&futureSave.useOptimisticLock==t.useOptimisticLock&&(t.changesets[i]=futureSave.changesets[a],t.futureSaves.push(futureSave))}n.splice(e,1),e--,t.execute()}}}function i(e,t){null==e?e=[]:e instanceof Array||(e=[e]),null!=t&&(e=e.concat([t]));for(var n=[],r=0;r!=e.length;r++){var i=e[r];switch(typeof i){case"boolean":n.push({valuetype:_pio.ValueType.Bool,bool:i});break;case"string":n.push({valuetype:_pio.ValueType.String,string:i});break;case"number":i%1!=0?n.push({valuetype:_pio.ValueType.Double,double:i}):i>-0x80000000&&i<0x7fffffff?n.push({valuetype:_pio.ValueType.Int,int:i}):i>0&&i<0xffffffff?n.push({valuetype:_pio.ValueType.UInt,uint:i}):n.push({valuetype:_pio.ValueType.Long,long:i});break;case"object":if(i.getTime&&i.getMilliseconds)n.push({valuetype:_pio.ValueType.DateTime,datetime:i.getTime()});else throw Error("Don't know how to serialize type '"+typeof i+"' for BigDB");break;default:throw Error("Don't know how to serialize type '"+typeof i+"' for BigDB")}}return n}this.createObject=function(n,r,i,o,a){var s=_pio.compareForChanges({},i||{},!0,!0);e.createObjects([{key:r,table:n,properties:s}],!1,o,a,function(e){if(1==e.objects.length)return new _pio.databaseobject(t,n,e.objects[0].key,e.objects[0].version,!1,s);throw new PlayerIOError(PlayerIOErrorCode.GeneralError,"Error creating object")})},this.loadMyPlayerObject=function(n,r){e.loadMyPlayerObject(n,r,function(e){return new _pio.databaseobject(t,"PlayerObjects",e.playerobject.key,e.playerobject.version,!0,e.playerobject.properties)})},this.load=function(n,r,i,o){e.loadObjects([{table:n,keys:[r]}],i,o,function(e){if(1==e.objects.length)return null==e.objects[0]?null:new _pio.databaseobject(t,n,e.objects[0].key,e.objects[0].version,!1,e.objects[0].properties);throw new PlayerIOError(PlayerIOErrorCode.GeneralError,"Error loading object")})},this.loadKeys=function(n,r,i,o){e.loadObjects([{table:n,keys:r}],i,o,function(e){for(var r=[],i=0;i!=e.objects.length;i++){var o=e.objects[i];r[i]=null==o?null:new _pio.databaseobject(t,n,o.key,o.version,!1,o.properties)}return r})},this.loadOrCreate=function(n,r,i,o){e.createObjects([{key:r,table:n,properties:[]}],!0,i,o,function(e){if(1==e.objects.length)return new _pio.databaseobject(t,n,e.objects[0].key,e.objects[0].version,!1,e.objects[0].properties);throw new PlayerIOError(PlayerIOErrorCode.GeneralError,"Error creating object")})},this.deleteKeys=function(t,n,r,i){e.deleteObjects([{table:t,keys:n}],r,i,function(e){return null})},this.loadKeysOrCreate=function(n,r,i,o){for(var a=[],s=0;s!=r.length;s++)a.push({key:r[s],table:n,properties:[]});e.createObjects(a,!0,i,o,function(e){for(var r=[],i=0;i!=e.objects.length;i++){var o=e.objects[i];r[i]=new _pio.databaseobject(t,n,o.key,o.version,!1,o.properties)}return r})},this.loadSingle=function(n,r,o,a,s){e.loadMatchingObjects(n,r,i(o),1,a,s,function(e){return 0==e.objects.length?null:new _pio.databaseobject(t,n,e.objects[0].key,e.objects[0].version,!1,e.objects[0].properties)})},this.loadRange=function(n,r,o,a,s,l,c,u){e.loadIndexRange(n,r,i(o,a),i(o,s),l,c,u,function(e){for(var r=[],i=0;i!=e.objects.length;i++){var o=e.objects[i];r[i]=null==o?null:new _pio.databaseobject(t,n,o.key,o.version,!1,o.properties)}return r})},this.deleteRange=function(t,n,r,o,a,s,l){e.deleteIndexRange(t,n,i(r,o),i(r,a),s,l,function(){})},this.saveChanges=function(t,i,o,a,s){var l=!0==arguments[5],c=[];for(var u in o){var d=o[u];if(!d.existsInDatabase||!d.key||!d.table||!d._internal_||!d.save){var h=_pio.error("You can only save database objects that exist in the database");_pio.handleError(h,s,h.code,h.message);return}var f=_pio.compareForChanges(i?{}:d._internal_("get-dbCurrent"),d,!0,!0);(i||f.length>0)&&c.push({key:d._internal_("get-key"),table:d._internal_("get-table"),fulloverwrite:i,onlyifversion:t?d._internal_("get-version"):null,changes:f})}n.push({objects:o,changesets:c,fullOverwrite:i,useOptimisticLock:t,futureSaves:[],setIsSavingOnAll:function(e){for(var t=0;t!=this.objects.length;t++)this.objects[t]._internal_("set-is-saving",e)},done:function(){this.setIsSavingOnAll(!1),r()},execute:function(){var t=this;t.setIsSavingOnAll(!0),t.changesets.length>0?e.saveObjectChanges(_pio.LockType.LockAll,t.changesets,l,a,function(e){t.done(),_pio.handleError(e,s,e.code,e.message)},function(e){for(var n=0;n!=t.objects.length;n++){var r=t.objects[n];r._internal_("set-version",e.versions[n]),r._internal_("change-dbCurrent",t.changesets[n].changes);for(var i=0;i!=t.futureSaves.length;i++)for(var o=t.futureSaves[i],a=0;a<o.objects.length;a++)o.objects[a]==r&&(o.changesets.splice(a,1),o.objects.splice(a,1),a--)}t.done()}):(t.done(),setTimeout(a,1))}}),r()}},_pio.databaseobject=function(e,t,n,r,i,o){var a={},s=!1;_pio.bigDBDeserialize(o,a,!0),this.table=t,this.key=n,this.existsInDatabase=!0,this.save=function(t,n,r,o){e.saveChanges(t,n,[this],r,o,i)},this._internal_=function(e,i){switch(e){case"get-table":return t;case"get-key":return n;case"set-is-saving":s=i;case"get-is-saving":return s;case"get-version":return r;case"set-version":r=i;case"get-dbCurrent":return a;case"change-dbCurrent":_pio.bigDBDeserialize(i,a,!0)}},_pio.bigDBDeserialize(o,this,!0)},_pio.compareForChanges=function(e,t,n,r){var i=[];for(var o in t){var a=t[o],s=e?e[o]:null;switch(o){case"table":if(r)continue;case"key":if(r)continue;case"save":if(r)continue;case"existsInDatabase":if(r)continue;case"_internal_":if(r)continue;case"_circular_reference_finder_":continue}if(null!=a){var l=n?{name:o}:{index:parseInt(o)};switch(typeof a){case"boolean":a!=s&&(l.value={valuetype:_pio.ValueType.Bool,bool:a},i.push(l));break;case"number":a!=s&&(isFinite(a)&&Math.floor(a)===a?a>=-0x80000000&&a<=0x7fffffff?l.value={valuetype:_pio.ValueType.Int,int:a}:a>0&&a<=0xffffffff?l.value={valuetype:_pio.ValueType.UInt,uint:a}:a>=-0x7ffffffffffffc00&&a<=0x7ffffffffffffc00?l.value={valuetype:_pio.ValueType.Long,long:a}:a>0&&a<=0xfffffffffffff800?l.value={valuetype:_pio.ValueType.ULong,ulong:a}:l.value={valuetype:_pio.ValueType.Double,double:a}:l.value={valuetype:_pio.ValueType.Double,double:a},i.push(l));break;case"string":a!=s&&(l.value={valuetype:_pio.ValueType.String,string:a},i.push(l));break;case"object":if(a.getTime&&a.getMilliseconds)a+""!=s+""&&(l.value={valuetype:_pio.ValueType.DateTime,datetime:a.getTime()},i.push(l));else{if(a._circular_reference_finder_)throw new PlayerIOError(PlayerIOErrorCode.CircularReference,"The object you're trying to save contains a circular reference for "+(n?"a property named":"the array entry")+"): "+o);a._circular_reference_finder_=!0;var c=a instanceof Array;if(c&&a.bytearray){for(var u=Array(a.length),d=0;d!=u.length;d++){var h=a[d];if(h>=0&&h<=255)u[d]=h;else throw new PlayerIOError(PlayerIOErrorCode.GeneralError,"The bytearray property '"+o+"' was supposed to only contain byte (0-255) values, but contained the value: "+h)}l.value={valuetype:_pio.ValueType.ByteArray,bytearray:u}}else{var f=_pio.compareForChanges(s,a,!c,!1);c?l.value={valuetype:_pio.ValueType.Array,arrayproperties:f}:l.value={valuetype:_pio.ValueType.Obj,objectproperties:f}}i.push(l),delete a._circular_reference_finder_}break;case"undefined":case"function":break;default:throw Error("Don't know how to serialize type '"+typeof a+"' for BigDB")}}}for(var o in e)(null==t[o]||void 0===t[o])&&i.push(n?{name:o}:{index:parseInt(o)});return i},_pio.bigDBDeserialize=function(e,t,n){for(var r in e){var i=e[r],o=n?i.name:i.index||0,a=i.value;if(a)switch(a.valuetype||0){case _pio.ValueType.String:t[o]=a.string||"";break;case _pio.ValueType.Int:t[o]=a.int||0;break;case _pio.ValueType.UInt:t[o]=a.uint||0;break;case _pio.ValueType.Long:t[o]=a.long||0;break;case _pio.ValueType.Bool:t[o]=a.bool||0;break;case _pio.ValueType.Float:t[o]=a.float||0;break;case _pio.ValueType.Double:t[o]=a.double||0;break;case _pio.ValueType.ByteArray:t[o]=a.bytearray,t[o].bytearray=!0;break;case _pio.ValueType.DateTime:t[o]=new Date(a.datetime||0);break;case _pio.ValueType.Array:var s=t[o]instanceof Array?t[o]:[];_pio.bigDBDeserialize(a.arrayproperties,s,!1),t[o]=s;break;case _pio.ValueType.Obj:var l="object"==typeof t[o]?t[o]:{};_pio.bigDBDeserialize(a.objectproperties,l,!0),t[o]=l}else delete t[o]}}}(),function(){var e=0,t=1,n=2,r=3,i=4,o=5,a=6,s=7,l=8;_pio.multiplayer=function(e){var t=this;this.developmentServer=null,this.useSecureConnections=!1,this.createRoom=function(n,r,i,o,a,s){e.createRoom(n,r,i,_pio.convertToKVArray(o),null!=t.developmentServer,a,s,function(e){return e.roomid})},this.joinRoom=function(n,r,i,o){clearTimeout(setTimeout(function(){i(new _pio.connection)},1e4));var a=Error();e.joinRoom(n,_pio.convertToKVArray(r),null!=t.developmentServer,t.useSecureConnections,function(){},o,function(e){return new _pio.connection(a,t.developmentServer,t.useSecureConnections,e.endpoints,e.joinkey,r||{},i,o)})},this.createJoinRoom=function(n,r,i,o,a,s,l){clearTimeout(setTimeout(function(){s(new _pio.connection)},1e4));var c=Error();e.createJoinRoom(n,r,i,_pio.convertToKVArray(o),_pio.convertToKVArray(a),null!=t.developmentServer,t.useSecureConnections,function(){},l,function(e){return new _pio.connection(c,t.developmentServer,t.useSecureConnections,e.endpoints,e.joinkey,a||{},s,l)})},this.listRooms=function(n,r,i,o,a,s){e.listRooms(n,_pio.convertToKVArray(r),i,o,null!=t.developmentServer,a,s,function(e){var t=[];if(e.rooms&&e.rooms.length>0)for(var n=0;n!=e.rooms.length;n++){var r=e.rooms[n];t.push(new _pio.roomInfo(r.id,r.roomtype,r.onlineusers,_pio.convertFromKVArray(r.roomdata)))}return t})}},_pio.websocketConnection=function(e,t,n,r,i,o,a){var s=this,l=!1,c=new _pio.messageSerializer,u=!1,d=null,h=(t?"wss://":"ws://")+n+"/";try{d="u">typeof MozWebSocket?new MozWebSocket(h):new WebSocket(h)}catch(e){i(!1,""+e);return}var f=setTimeout(function(){l||(l=!0,i(!1,"Connect attempt timed out"))},r);d.onopen=function(){l||(clearTimeout(f),l=!0,i(u=!0))},d.onclose=function(e){s.disconnect()},d.onerror=function(e){s.disconnect()},d.onmessage=function(t){if(u)if(e){var n=new FileReader;n.onloadend=function(){for(var e=new Uint8Array(n.result),t=Array(e.length),r=0;r!=e.length;r++)t[r]=e[r];a(c.deserializeMessage(t,0,t.length))},n.readAsArrayBuffer(t.data)}else{var r=_pio.base64decode(t.data);a(c.deserializeMessage(r,0,r.length))}},this.disconnect=function(){if(u){u=!1,o();try{d.close()}catch(e){_pio.debugLog(e)}}},this.sendMessage=function(t){var n=c.serializeMessage(t);if(e){for(var r=new Uint8Array(n.length),i=0;i<n.length;i++)r[i]=n[i];d.send(r.buffer)}else{var o=_pio.base64encode(n);d.send(o)}}},_pio.connection=function(e,t,n,r,i,o,a,s){var l=this,c=!0,u=[],d={},h=[],f=null,p=/(WebKit|Firefox|Trident)\/([0-9]+)/gi.exec(navigator.userAgent),g=p&&p.length>=3?p[1]:null,m=p&&p.length>=3?parseInt(p[2]):null;function v(h){var p=[];if(t)p.push(t);else for(var g=0;g!=r.length;g++)p.push(r[g].address+":"+r[g].port);function m(){if(p.length>0){var t=p[0];p.splice(0,1);var r=h(n,t,4e3,function(e,n){if(e){f=r,l.connected=!0;var a=l.createMessage("join");if(a.addString(i),null!=o)for(var s in o)a.addString(s),a.addString(""+o[s]);l.sendMessage(a)}else _pio.debugLog("Unable to connect to endpoint: "+t+'. reason: "'+n+(p.length>0?'". Trying next endpoint.':'". No more endpoints to try.')),m()},function(e){l.connected&&(l.connected=!1,setTimeout(function(){for(var e=0;e!=u.length;e++)_pio.runCallback(u[e].callback,l,u[e].stackSource)},100))},function(t){c?"playerio.joinresult"==t.type?(c=!1,t.getBoolean(0)?_pio.runCallback(a,l,null):_pio.handleError(e,s,t.getInt(1),t.getString(2))):_pio.handleError(e,s,PlayerIOErrorCode.GeneralError,"The expected inital messagetype is: playerio.joinresult, received: "+joinResult.getType()):(v(t.type,t),v("*",t))})}else _pio.handleError(e,s,PlayerIOErrorCode.GeneralError,"Could not establish a socket connection to any of the given endpoints for the room")}function v(e,t){var n=d[e];if(n)for(var r=0;r<n.length;r++)_pio.runCallback(n[r].callback,t,n[r].stackSource)}m()}window.FileReader&&"WebKit"==g&&m>=535||"Firefox"==g&&m>=11||"Trident"==g&&m>=6?v(function(e,t,n,r,i,o){return new _pio.websocketConnection(!0,e,t,n,r,i,o)}):_pio.isFlashFallbackEnabled(function(e){e?v(function(e,t,n,r,i,o){return new _pio.flashSocketConnection(t,n,r,i,o)}):v(function(e,t,n,r,i,o){return new _pio.websocketConnection(!1,e,t,n,r,i,o)})}),this.connected=!1,this.addDisconnectCallback=function(e){u.push({callback:e,stackSourc:Error()})},this.addMessageCallback=function(e,t){null==e&&(e="*");var n=d[e];n||(d[e]=n=[]),n.push({callback:t,stackSource:Error()})},this.removeDisconnectCallback=function(e){for(var t=0;t<u.length;t++)u[t].callback==e&&(u.splice(t,1),t--)},this.removeMessageCallback=function(e){for(var t in d)for(var n=d[t],r=0;r<n.length;r++)n[r].callback==e&&(n.splice(r,1),r--)},this.createMessage=function(e){for(var t=new _pio.message(e),n=1;n<arguments.length;n++)t.add(arguments[n]);return t},this.send=function(e){var t=this.createMessage.apply(this,arguments);this.sendMessage(t)},this.sendMessage=function(e){l.connected?f.sendMessage(e):h.push(e)},this.disconnect=function(){l.connected&&f.disconnect()}},_pio.message=function(c){var u=this,d=[],h=[];function f(e,t,n,r){if(e)h.push(t),d.push(n),u.length=h.length;else throw _pio.error("The given value ("+t+") is not "+r)}function p(e,t){if(e>h.length)throw _pio.error("this message ("+u.type+") only has "+h.length+" entries");if(d[e]==t)return h[e];throw _pio.error("Value at index:"+e+" is a "+g(d[e])+" and not a "+g(t)+" as requested. The value is: "+h[e])}function g(c){var u={};return u[e]="Integer",u[t]="Unsigned Integer",u[n]="Long",u[r]="Unsigned Long",u[i]="Double",u[o]="Float",u[a]="String",u[s]="ByteArray",u[l]="Boolean",u[c]}function m(e){var t="object"==typeof e&&void 0!==e.length;if(t){for(var n=0;n!=e.length;n++)if(e[n]>255||e[n]<0){t=!1;break}}return t}this.type=c,this.length=0,this.add=function(){for(var e=0;e<arguments.length;e++){var t=arguments[e];switch(typeof t){case"string":u.addString(t);break;case"boolean":u.addBoolean(t);break;case"number":if(isFinite(t)&&Math.floor(t)===t){if(t>=-0x80000000&&t<=0x7fffffff){u.addInt(t);break}else if(t>0&&t<=0xffffffff){u.addUInt(t);break}else if(t>=-0x7ffffffffffffc00&&t<=0x7ffffffffffffc00){u.addLong(t);break}else if(t>0&&t<=0xfffffffffffff800){u.addULong(t);break}}u.addDouble(t);break;case"object":if(m(t)){this.addByteArray(t);break}default:throw _pio.error("The type of the value ("+t+") cannot be inferred")}}},this.addInt=function(t){f(t>=-0x80000000&&t<=0x7fffffff,Math.trunc(t),e,"an integer (32bit)")},this.addUInt=function(e){f(e>=0&&e<=0xffffffff,Math.trunc(e),t,"an unsigned integer (32bit)")},this.addLong=function(e){f(e>=-0x7ffffffffffffc00&&e<=0x7ffffffffffffc00,Math.trunc(e),n,"a long (64bit)")},this.addULong=function(e){f(e>=0&&e<=0xfffffffffffff800,e,r,"an unsigned long (64bit)")},this.addBoolean=function(e){f(!0,!!e,l,"a boolean value")},this.addFloat=function(e){f(!0,Number(e),o,"a floating point value (32bit)")},this.addDouble=function(e){f(!0,Number(e),i,"a double floating point value (64bit)")},this.addByteArray=function(e){f(m(e),e,s,"a bytearray")},this.addString=function(e){f(!0,e+"",a,"a string")},this.getInt=function(t){return p(t,e)},this.getUInt=function(e){return p(e,t)},this.getLong=function(e){return p(e,n)},this.getULong=function(e){return p(e,r)},this.getBoolean=function(e){return p(e,l)},this.getDouble=function(e){return p(e,i)},this.getFloat=function(e){return p(e,o)},this.getByteArray=function(e){return p(e,s)},this.getString=function(e){return p(e,a)},this.toString=function(){for(var e="msg.Type = "+this.type,t=0;t!=this.length;t++)e+=", msg["+t+"] = "+h[t]+" ("+g(d[t])+")";return e},this._internal_=function(e,t){switch(e){case"get-objects":return h;case"get-types":return d}}},_pio.roomInfo=function(e,t,n,r){this.id=e,this.roomType=t,this.onlineUsers=n,this.roomData=r},_pio.byteWriter=function(){this.bytes=[],this.writeByte=function(e){if(e>=0&&e<=255)this.bytes.push(e);else throw Error("This is not a byte value: "+e)},this.writeBytes=function(e){for(var t=0;t!=e.length;t++)this.writeByte(e[t])},this.writeTagWithLength=function(e,t,n){e>63||e<0?this.writeBottomPatternAndBytes(n,_pio.binaryserializer.bytesFromInt(e)):this.writeByte(t|e)},this.writeBottomPatternAndBytes=function(e,t){var n=0;0!=t[0]?n=3:0!=t[1]?n=2:0!=t[2]&&(n=1),this.writeByte(e|n);for(var r=t.length-n-1;r!=t.length;r++)this.writeByte(t[r])},this.writeLongPattern=function(e,t,n){for(var r=0,i=0;7!=i;i++)if(0!=n[i]){r=7-i;break}r>3?this.writeByte(t|r-4):this.writeByte(e|r);for(var i=n.length-r-1;i!=n.length;i++)this.writeByte(n[i])}},_pio.messageSerializer=function(){var c=192,u=60,d=192,h=128,f=64,p=4,g=8,m=12,v=16,b=48,y=52,_=56,w=60,k=3,I=2,x=1,C=0;this.serializeMessage=function(c){var u=new _pio.byteWriter;u.length,u.writeTagWithLength(c.length,h,p);var R=_pio.binaryserializer.bytesFromString(c.type);u.writeTagWithLength(R.length,d,m),u.writeBytes(R);for(var E=0;E!=c.length;E++){var S=c._internal_("get-objects")[E];switch(c._internal_("get-types")[E]){case a:var R=_pio.binaryserializer.bytesFromString(S);u.writeTagWithLength(R.length,d,m),u.writeBytes(R);break;case e:u.writeTagWithLength(S,h,p);break;case t:u.writeBottomPatternAndBytes(g,_pio.binaryserializer.bytesFromUInt(S));break;case n:u.writeLongPattern(b,y,_pio.binaryserializer.bytesFromLong(S));break;case r:u.writeLongPattern(_,w,_pio.binaryserializer.bytesFromULong(S));break;case s:u.writeTagWithLength(S.length,f,v),u.writeBytes(S);break;case i:u.writeByte(k),u.writeBytes(_pio.binaryserializer.bytesFromDouble(S));break;case o:u.writeByte(I);var A=_pio.binaryserializer.bytesFromFloat(S);u.writeBytes(A);break;case l:u.writeByte(S?x:C)}}return u.bytes},this.deserializeMessage=function(e,t,n){for(var r=t,i=t+n,o=null,a=0;r<i;){var s=0,l=0,R=e[r];r++;var E=R&c;switch(0==E&&0==(E=R&u)&&(E=R),E){case m:case v:if(r+(s=(3&R)+1)>i)throw Error("Unexpected: Unfinished message");var S=s;s=_pio.binaryserializer.intFromBytes(e,r,s),r+=S;break;case d:s=63&R;break;case h:l=63&R;break;case f:s=63&R;break;case p:case g:case b:case _:s=(3&R)+1;break;case y:case w:s=(3&R)+5;break;case k:s=8;break;case I:s=4}if(r+s>i)throw Error("Unexpected: Unfinished message");switch(E){case m:case d:null==o?(o=new _pio.message(_pio.binaryserializer.stringFromBytes(e,r,s)),a++):o.addString(_pio.binaryserializer.stringFromBytes(e,r,s));break;case p:l=_pio.binaryserializer.intFromBytes(e,r,s);case h:0==a?a=l:o.addInt(l);break;case v:case f:o.addByteArray(e.slice(r,r+s));break;case g:o.addUInt(_pio.binaryserializer.uintFromBytes(e,r,s));break;case b:case y:o.addLong(_pio.binaryserializer.longFromBytes(e,r,s));break;case _:case w:o.addULong(_pio.binaryserializer.ulongFromBytes(e,r,s));break;case k:o.addDouble(_pio.binaryserializer.doubleFromBytes(e,r,s));break;case I:o.addFloat(_pio.binaryserializer.floatFromBytes(e,r,s));break;case x:o.addBoolean(!0);break;case C:o.addBoolean(!1)}if(r+=s,null!=o&&0==--a)return o}throw Error("Unexpected: Misaligned message")}},_pio.binaryserializer={pow2:function(e){return e>=0&&e<31?1<<e:this.pow2[e]||(this.pow2[e]=Math.pow(2,e))},_intEncode:function(e,t){var n=Array(t);if(4==t)n=[e>>>24&255,e>>>16&255,e>>>8&255,255&e];else if(e>=0){var r=Math.floor(e/this.pow2(32)),i=e-r*this.pow2(32);n=[r>>>24&255,r>>>16&255,r>>>8&255,255&r,i>>>24&255,i>>>16&255,i>>>8&255,255&i]}else{var r=Math.floor(e/this.pow2(32)),i=e-r*this.pow2(32);r+=this.pow2(32),n=[r>>>24&255,r>>>16&255,r>>>8&255,255&r,i>>>24&255,i>>>16&255,i>>>8&255,255&i]}return n},_floatEncode:function(e,t,n){var r,i,o=+(e<0),a=~(-1<<n-1),s=1-a;e<0&&(e=-e),0===e?(r=0,i=0):isNaN(e)?(r=2*a+1,i=1):e===1/0?(r=2*a+1,i=0):(r=Math.floor(Math.log(e)/Math.LN2))>=s&&r<=a?(i=Math.floor((e*this.pow2(-r)-1)*this.pow2(t)),r+=a):(i=Math.floor(e/this.pow2(s-t)),r=0);for(var l=[];t>=8;)l.push(i%256),i=Math.floor(i/256),t-=8;for(r=r<<t|i,n+=t;n>=8;)l.push(255&r),r>>>=8,n-=8;return l.push(o<<n|r),l.reverse(),l},bytesFromString:function(e){for(var t=[],n=0;n<e.length;n++)if(127>=e.charCodeAt(n))t.push(e.charCodeAt(n));else for(var r=encodeURIComponent(e.charAt(n)).substr(1).split("%"),i=0;i<r.length;i++)t.push(parseInt(r[i],16));return t},bytesFromInt:function(e){return this._intEncode(e,4)},bytesFromUInt:function(e){return this._intEncode(e,4)},bytesFromLong:function(e){return this._intEncode(e,8)},bytesFromULong:function(e){return this._intEncode(e,8)},bytesFromFloat:function(e){return this._floatEncode(e,23,8)},bytesFromDouble:function(e){return this._floatEncode(e,52,11)},_intDecode:function(e,t,n,r,i){for(var o=t+n-1,a=i&&n==r&&128&e[t],s=0,l=1,c=0;c<n;c++){var u=e[o-c];a&&(l=(u=(255^u)+l)>>8,u&=255),s+=u*this.pow2(8*c)}return a?-s:s},_float32Decode:function(e,t){var n=e.slice(t,t+4).reverse(),r=1-2*(n[3]>>7),i=(n[3]<<1&255|n[2]>>7)-127,o=(127&n[2])<<16|n[1]<<8|n[0];if(128===i)if(0!==o)return NaN;else return 1/0*r;return -127===i?r*o*this.pow2(-149):r*(1+o*this.pow2(-23))*this.pow2(i)},_float64Decode:function(e,t){var n=e.slice(t,t+8).reverse(),r=1-2*(n[7]>>7),i=((n[7]<<1&255)<<3|n[6]>>4)-1023,o=(15&n[6])*this.pow2(48)+n[5]*this.pow2(40)+n[4]*this.pow2(32)+n[3]*this.pow2(24)+n[2]*this.pow2(16)+n[1]*this.pow2(8)+n[0];if(1024===i)if(0!==o)return NaN;else return 1/0*r;return -1023===i?r*o*this.pow2(-1074):r*(1+o*this.pow2(-52))*this.pow2(i)},stringFromBytes:function(e,t,n){for(var r="",i=t;i<t+n;i++)r+=e[i]<=127?37===e[i]?"%25":String.fromCharCode(e[i]):"%"+e[i].toString(16).toUpperCase();return decodeURIComponent(r)},intFromBytes:function(e,t,n){return this._intDecode(e,t,n,4,!0)},uintFromBytes:function(e,t,n){return this._intDecode(e,t,n,4,!1)},longFromBytes:function(e,t,n){return this._intDecode(e,t,n,8,!0)},ulongFromBytes:function(e,t,n){return this._intDecode(e,t,n,8,!1)},floatFromBytes:function(e,t,n){return 4==n?this._float32Decode(e,t):NaN},doubleFromBytes:function(e,t,n){return 8==n?this._float64Decode(e,t):NaN}};for(var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=[],d=0;d!=c.length;d++)u[c.charCodeAt(d)]=d;_pio.base64encode=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],i=++n<=e.length?e[n]:NaN,o=++n<=e.length?e[n]:NaN,a=r>>2,s=(3&r)<<4|i>>4,l=(15&i)<<2|o>>6,u=63&o;isNaN(i)?l=u=64:isNaN(o)&&(u=64),t.push(c.charAt(a)),t.push(c.charAt(s)),t.push(c.charAt(l)),t.push(c.charAt(u))}return t.join("")},_pio.base64decode=function(e){for(var t=[],n=0;n<e.length;n++){var r=u[e.charCodeAt(n)],i=++n<e.length?u[e.charCodeAt(n)]:64,o=++n<e.length?u[e.charCodeAt(n)]:64,a=++n<e.length?u[e.charCodeAt(n)]:64,s=r<<2|i>>4,l=(15&i)<<4|o>>2,c=(3&o)<<6|a;t.push(s),64!=o&&(t.push(l),64!=a&&t.push(c))}return t}}(),function(){_pio.achievements=function(e){var t=null;this.myAchievements="[ERROR: You tried to access achievements.myAchievements before loading them. You have to call the refresh method first.]",this.onCompleteHandlers=[];var n=this;function r(e,t){var r=new _pio.achievement(e.identifier,e.title,e.description,e.imageurl,e.progress,e.progressgoal,e.lastupdated);if("string"!=typeof n.myAchievements)for(var i=0;i<n.myAchievements.length;i++)n.myAchievements[i].id==r.id&&(n.myAchievements[i]=r,n.currentVersion=null);if(t)for(var i=0;i<n.onCompleteHandlers.length;i++)(0,n.onCompleteHandlers[i])(r);return r}this.addOnComplete=function(e){if("function"==typeof e&&1==e.length)n.onCompleteHandlers.push(e);else throw new PlayerIOError(PlayerIOErrorCode.InvalidArgument,"Expects argument to be a function that takes an achievement as an argument.")},this.get=function(e){if("string"==typeof n.myAchievements)return null;for(var t=0;t<n.myAchievements.length;t++)if(n.myAchievements[t].id==e)return n.myAchievements[t];return null},this.refresh=function(r,i){e.achievementsRefresh(t,r,i,function(e){if(t!=e.version)if(t=e.version,null==e.achievements||0==e.achievements.length)n.myAchievements=[];else{for(var r=[],i=0;i<e.achievements.length;i++){var o=e.achievements[i];r.push(new _pio.achievement(o.identifier,o.title,o.description,o.imageurl,o.progress,o.progressgoal,o.lastupdated))}n.myAchievements=r}})},this.load=function(t,n,r){if("object"!=typeof t&&!requests.length){var i=_pio.error("The first argument to load should be an array: client.achievements.load(['user1', 'user2', ...], ...)");_pio.handleError(i,r,i.code,i.message);return}e.achievementsLoad(t,n,r,function(e){if(null==e||0==e.length)return{};for(var t={},n=0;n<e.userachievements.length;n++){for(var r=e.userachievements[n],i=[],o=0;o<r.achievements.length;o++){var a=r.achievements[o];i.push(new _pio.achievement(a.identifier,a.title,a.description,a.imageurl,a.progress,a.progressgoal,a.lastupdated))}t[r.userid]=i}return t})},this.progressSet=function(t,n,i,o){e.achievementsProgressSet(t,n,i,o,function(e){return r(e.achievement,e.completednow)})},this.progressAdd=function(t,n,i,o){e.achievementsProgressAdd(t,n,i,o,function(e){return r(e.achievement,e.completednow)})},this.progressMax=function(t,n,i,o){e.achievementsProgressMax(t,n,i,o,function(e){return r(e.achievement,e.completednow)})},this.progressComplete=function(t,n,i){e.achievementsProgressComplete(t,n,i,function(e){return r(e.achievement,e.completednow)})}},_pio.achievement=function(e,t,n,r,i,o,a){this.id=e,this.title=t,this.description=n,this.imageUrl=r,this.progress=void 0===i?0:i,this.progressGoal=o,this.lastUpdated=new Date(1e3*a),this.progressRatio=this.progress/this.progressGoal,this.completed=this.progress==this.progressGoal}}(),function(){_pio.playerInsight=function(e){this.playersOnline="[ERROR: You tried to access playerInsight.playersOnline before loading it. You have to call the refresh method first.]",this.segments={};var t=this;function n(e){-1==e.playersonline?t.playersOnline="[ERROR: The current connection does not have the rights required to read the playersonline variable.]":t.playersOnline=e.playersonline,t.segments=_pio.convertFromKVArray(e.segments)}this.refresh=function(t,r){e.playerInsightRefresh(t,r,function(e){n(e.state)})},this.setSegments=function(t,r,i){e.playerInsightSetSegments(_pio.convertToSegmentArray(t),r,i,function(e){n(e.state)})},this.trackInvitedBy=function(t,n,r,i){e.playerInsightTrackInvitedBy(t,n,r,i,function(e){})},this.trackEvent=function(t,n,r,i){e.playerInsightTrackEvents([{eventtype:t,value:n}],r,i,function(e){})},this.trackExternalPayment=function(t,n,r,i){e.playerInsightTrackExternalPayment(t,n,r,i,function(e){})},this.sessionKeepAlive=function(t,n){e.playerInsightSessionKeepAlive(t,n,function(e){})}}}(),function(){_pio.leaderboards=function(e,t){this.set=function(t,n,r,i,o){e.leaderboardsSet(t,n,r,i,o,function(e){return new _pio.leaderboardEntry(e.leaderboardentry.userid,e.leaderboardentry.rank,e.leaderboardentry.score)})},this.count=function(t,n,r,i){e.leaderboardsCount(t,n,r,i,function(e){return e.count})},this.getTop=function(t,n,r,i,o,a,s){e.leaderboardsGet(t,n,r,i,null,o,a,s,function(e){if(null==e||null==e.leaderboardentry||0==e.leaderboardentry.length)return[];for(var t=[],n=0;n<e.leaderboardentry.length;n++)t.push(new _pio.leaderboardEntry(e.leaderboardentry[n].userid,e.leaderboardentry[n].rank,e.leaderboardentry[n].score));return t})},this.getNeighbourhood=function(n,r,i,o,a,s,l){e.leaderboardsGet(n,r,i,o,t,a,s,l,function(e){if(null==e||null==e.leaderboardentry||0==e.leaderboardentry.length)return[];for(var t=[],n=0;n<e.leaderboardentry.length;n++)t.push(new _pio.leaderboardEntry(e.leaderboardentry[n].userid,e.leaderboardentry[n].rank,e.leaderboardentry[n].score));return t})}},_pio.leaderboardEntry=function(e,t,n){this.userId=e,this.rank=t,this.score=n}}(),function(){_pio.oneScore=function(e){this.percentile="[ERROR: You tried to access oneScore.percentile before loading the OneScore. You have to call the refresh method first.]",this.score="[ERROR: You tried to access oneScore.score before loading the OneScore. You have to call the refresh method first.]",this.topRank="[ERROR: You tried to access oneScore.topRank before loading the OneScore. You have to call the refresh method first.]";var t=this;this.refresh=function(n,r){e.oneScoreRefresh(n,r,function(e){var n=new _pio.oneScoreValue(e.onescore.percentile,e.onescore.score,e.onescore.toprank);t.percentile=n.percentile,t.score=n.score,t.topRank=n.toprank})},this.set=function(n,r,i){e.oneScoreSet(n,r,i,function(e){var n=new _pio.oneScoreValue(e.onescore.percentile,e.onescore.score,e.onescore.toprank);return t.percentile=n.percentile,t.score=n.score,t.topRank=n.toprank,n})},this.add=function(n,r,i){e.oneScoreAdd(n,r,i,function(e){var n=new _pio.oneScoreValue(e.onescore.percentile,e.onescore.score,e.onescore.toprank);return t.percentile=n.percentile,t.score=n.score,t.topRank=n.toprank,n})},this.load=function(t,n,r){if("object"!=typeof t&&!requests.length){var i=_pio.error("The first argument to load should be an array: client.oneScore.load(['user1', 'user2', ...], ...)");_pio.handleError(i,r,i.code,i.message);return}e.oneScoreLoad(t,n,r,function(e){if(null==e||null==e.onescores||0==e.onescores.length)return[];for(var n=[],r=0,i=0;i<t.length;i++){var o=e.onescores[r];o&&t[i]==o.userid?(n.push(new _pio.oneScoreValue(o.percentile,o.score,o.toprank)),r++):n.push(null)}return n})}},_pio.oneScoreValue=function(e,t,n){this.percentile=void 0===e?0:e,this.score=void 0===t?0:t,this.topRank=void 0===n?0:n}}(),function(){_pio.notifications=function(e){this.myEndpoints="[ERROR: You tried to access notifications.myEndpoints before calling refresh.]";var t=this,n="";function r(e){if(e.version!=n){var r=[];if(e.endpoints)for(var i=0;i!=e.endpoints.length;i++){var o=e.endpoints[i];r[i]=new _pio.notificationEndpoint(o.type,o.identifier,_pio.convertFromKVArray(o.configuration),!!o.enabled)}n=e.version,t.myEndpoints=r}}function i(e,t){return JSON.stringify(e)==JSON.stringify(t)}function o(e,r){if(""!=n)for(var i=0;i!=t.myEndpoints.length;i++){var o=t.myEndpoints[i];if(o.type==e&&o.identifier==r)return o}return null}function a(e){var t=[];if(e&&e.length>0)for(var n=0;n!=e.length;n++){var r=e[n];r.type&&r.identifier&&t.push({type:r.type,identifier:r.identifier})}return t}this.refresh=function(t,i){e.notificationsRefresh(n,t,i,r)},this.registerEndpoint=function(t,a,s,l,c,u){var d=o(t,a);null!=d&&d.enabled==l&&i(d.configuration,s)?c&&c():e.notificationsRegisterEndpoints(n,[{type:t,identifier:a,configuration:_pio.convertToKVArray(s),enabled:l}],c,u,r)},this.toggleEndpoints=function(t,i,o,s){var l=a(t);l.length>0?e.notificationsToggleEndpoints(n,l,!!i,o,s,r):o&&o()},this.deleteEndpoints=function(t,i,o){var s=a(t);s.length>0?e.notificationsDeleteEndpoints(n,s,i,o,r):i&&i()},this.send=function(t,n,r){for(var i=[],o=0;o!=t.length;o++){var a=t[o],s={recipient:a.recipientUserId,endpointtype:a.endpointType,data:{}};for(var l in(0==(s.recipient+"").length||0==(s.endpointtype+"").length)&&console.log("error"),a)"recipientUserId"!=l&&"endpointType"!=l&&(s.data[l]=a[l]);i[o]=s}i.length>0?e.notificationsSend(i,n,r,null):n&&n()}},_pio.notificationEndpoint=function(e,t,n,r){this.type=e,this.identifier=t,this.configuration=n,this.enabled=r}}(),function(){_pio.publishingNetwork=function(e,t){var n=this;this.profiles=new _pio.publishingNetworkProfiles(e),this.payments=new _pio.publishingNetworkPayments(e),this.relations=new _pio.publishingNetworkRelations(e,t,this),this.userToken="[ERROR: you tried to access publishingNetwork.userToken before calling publishingNetwork.refresh(callback)]",this.refresh=function(t,r){e.socialRefresh(t,r,function(e){n.userToken=e.myprofile.usertoken,n.profiles.myProfile=new _pio.publishingNetworkProfile(e.myprofile),void 0===_pio.friendLookup&&(_pio.friendLookup={},_pio.blockedLookup={});var t=_pio.friendLookup[n.profiles.myProfile.userId],r=_pio.blockedLookup[n.profiles.myProfile.userId];t||r||(t=_pio.friendLookup[n.profiles.myProfile.userId]={},r=_pio.blockedLookup[n.profiles.myProfile.userId]={}),n.relations.friends=[];for(var i=0;i!=e.friends.length;i++){var o=new _pio.publishingNetworkProfile(e.friends[i]);n.relations.friends.push(o),t[o.userId]=!0}for(var i=0;i!=e.blocked.length;i++)r[e.blocked[i]]=!0})}},_pio.showDialog=function(e,t,n,r){if(void 0===window.PublishingNetwork)throw new PlayerIOError(PlayerIOErrorCode.PublishingNetworkNotAvailable,"PublishingNetwork.js was not found on the current page. You have to include the 'piocdn.com/publishingnetwork.js' on the containing page to show dialogs. See http://playerio.com/documentation/ for more information.");n.__apitoken__=t.token,window.PublishingNetwork.dialog(e,n,r)}}(),function(){_pio.publishingNetworkPayments=function(e){this.showBuyCoinsDialog=function(t,n,r,i){n||(n={}),n.coinamount=t,e.payVaultPaymentInfo("publishingnetwork",_pio.convertToKVArray(n),null,function(t){_pio.showDialog("buy",e,t,function(e){e.error?i(new PlayerIOError(PlayerIOErrorCode.GeneralError,e.error)):r(e)})},i,function(e){return _pio.convertFromKVArray(e.providerarguments)})},this.showBuyItemsDialog=function(t,n,r,i){e.payVaultPaymentInfo("publishingnetwork",_pio.convertToKVArray(n||{}),_pio.convertBuyItems(t),function(t){_pio.showDialog("buy",e,t,function(e){e.error?i(new PlayerIOError(PlayerIOErrorCode.GeneralError,e.error)):r(e)})},i,function(e){return _pio.convertFromKVArray(e.providerarguments)})}}}(),function(){_pio.publishingNetworkProfiles=function(e){this.myProfile="[ERROR: you tried to access publishingNetworkProfiles.myProfile before calling publishingNetwork.refresh(callback)]",this.showProfile=function(t,n){_pio.showDialog("profile",e,{userId:t},n)},this.loadProfiles=function(t,n,r){e.socialLoadProfiles(t,n,r,function(e){for(var n=[],r=0;r!=t.length;r++){var i=t[r];n[r]=null;for(var o=0;o!=e.profiles.length;o++){var a=e.profiles[o];if(a&&a.userid==i){n[r]=new _pio.publishingNetworkProfile(e.profiles[o]);break}}}return n})}},_pio.publishingNetworkProfile=function(e){this.userId=e.userid,this.displayName=e.displayname,this.avatarUrl=e.avatarurl,this.lastOnline=new Date(e.lastonline),this.countryCode=e.countrycode}}(),function(){_pio.publishingNetworkRelations=function(e,t,n){this.friends="[ERROR: you tried to access publishingNetworkRelations.friends before calling publishingNetwork.refresh(callback)]",this.isFriend=function(e){if(void 0!==_pio.friendLookup&&void 0!==_pio.friendLookup[t])return _pio.friendLookup[t][e]||!1;throw new PlayerIOError(PlayerIOErrorCode.PublishingNetworkNotLoaded,"Cannot access profile, friends, ignored before Publishing Network has been loaded. Please refresh Publishing Network first")},this.isBlocked=function(e){if(void 0!==_pio.blockedLookup&&void 0!==_pio.blockedLookup[t])return _pio.blockedLookup[t][e]||!1;throw new PlayerIOError(PlayerIOErrorCode.PublishingNetworkNotLoaded,"Cannot access profile, friends, ignored before Publishing Network has been loaded. Please refresh Publishing Network first")},this.showRequestFriendshipDialog=function(t,n){_pio.showDialog("requestfriendship",e,{userId:t},n)},this.showRequestBlockUserDialog=function(t,r){_pio.showDialog("requestblockuser",e,{userId:t},function(){n.refresh(function(){r&&r()},function(){r&&r()})})},this.showFriendsManager=function(t){_pio.showDialog("friendsmanager",e,{},function(e){e.updated?n.refresh(function(){t&&t()},function(){t&&t()}):t&&t()})},this.showBlockedUsersManager=function(t){_pio.showDialog("blockedusersmanager",e,{},function(e){e.updated?n.refresh(function(){t&&t()},function(){t&&t()}):t&&t()})}}}()}}]);