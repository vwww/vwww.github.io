(()=>{"use strict";var e,t,r,s,a={146:function(e,t,r){let s;r(1);var a=r(2);function n(e,t,r=!1){let s=a.state(a.proxy(t));function l(e){return"undefined"===e?void 0:JSON.parse(e)}if(window.localStorage){let n=localStorage.getItem(e);null!==n&&a.set(s,l(n),!0),a.user_effect(()=>localStorage.setItem(e,void 0===a.get(s)?"undefined":JSON.stringify(a.get(s)))),r&&window.addEventListener("storage",r=>r.storageArea===localStorage&&r.key===e&&a.set(s,null==r.newValue?t:l(r.newValue),!0))}return{get value(){return a.get(s)},set value(newVal){a.set(s,newVal,!0)}}}var l=a.from_html('<div role="progressbar"></div>');function o(e,t){let r=a.derived(()=>Math.max(t.moment,0)/t.momentMax*100),s=a.derived(()=>20>=a.get(r)?"bg-success":40>=a.get(r)?"bg-info":60>=a.get(r)?"":80>=a.get(r)?"bg-warning":"bg-danger");var n=l();a.set_attribute(n,"aria-valuemin",0),a.template_effect(()=>{a.set_class(n,1,`progress-bar progress-bar-striped progress-bar-animated ${a.get(s)??""}`),a.set_attribute(n,"aria-valuenow",t.moment),a.set_attribute(n,"aria-valuemax",t.momentMax),a.set_style(n,`width: ${a.get(r)??""}%`)}),a.append(e,n)}let i=[[[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]],[[0,0,0,0],[0,0,0,0],[1,1,1,1],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]],[[[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]]],[[[0,0,1,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,1,0],[0,0,0,0]],[[0,0,0,0],[1,1,1,0],[1,0,0,0],[0,0,0,0]],[[1,1,0,0],[0,1,0,0],[0,1,0,0],[0,0,0,0]]],[[[1,0,0,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],[[0,1,1,0],[0,1,0,0],[0,1,0,0],[0,0,0,0]],[[0,0,0,0],[1,1,1,0],[0,0,1,0],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[1,1,0,0],[0,0,0,0]]],[[[0,1,0,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],[[0,1,0,0],[0,1,1,0],[0,1,0,0],[0,0,0,0]],[[0,0,0,0],[1,1,1,0],[0,1,0,0],[0,0,0,0]],[[0,1,0,0],[1,1,0,0],[0,1,0,0],[0,0,0,0]]],[[[1,1,0,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],[[0,0,1,0],[0,1,1,0],[0,1,0,0],[0,0,0,0]],[[0,0,0,0],[1,1,0,0],[0,1,1,0],[0,0,0,0]],[[0,1,0,0],[1,1,0,0],[1,0,0,0],[0,0,0,0]]],[[[0,1,1,0],[1,1,0,0],[0,0,0,0],[0,0,0,0]],[[0,1,0,0],[0,1,1,0],[0,0,1,0],[0,0,0,0]],[[0,0,0,0],[0,1,1,0],[1,1,0,0],[0,0,0,0]],[[1,0,0,0],[1,1,0,0],[0,1,0,0],[0,0,0,0]]]];function g(e,t,r,s){a.set(t,!a.get(t)),!a.get(t)&&a.get(r)&&s()}var c=a.from_html("<td></td>"),u=a.from_html('<tr class="svelte-gm3z5y"></tr>'),d=a.from_html('<td class="svelte-gm3z5y"></td>'),v=a.from_html('<tr class="svelte-gm3z5y"></tr>'),m=a.from_html('<div class="btn-group d-flex svelte-gm3z5y" role="group"><button class="btn btn-outline-primary w-100 svelte-gm3z5y">New Game</button> <button>Pause</button> <button>Ghost Piece</button> <button>Speedup</button></div> <p class="svelte-gm3z5y"> </p> <table class="svelte-gm3z5y"><tbody class="svelte-gm3z5y"></tbody></table> <div class="d-flex my-3 svelte-gm3z5y"><div class="progress w-50 svelte-gm3z5y" style="transform: scaleX(-1)"><!></div> <div class="progress w-50 svelte-gm3z5y"><!></div></div> <table class="svelte-gm3z5y"><tbody class="svelte-gm3z5y"></tbody></table>',1);let f={hash:"svelte-gm3z5y",code:"table.svelte-gm3z5y {margin:auto;}td.svelte-gm3z5y {width:3vmin;height:3vmin;&.ghost {opacity:0.2;}&.ghostLine {\n    animation: svelte-gm3z5y-blinker 0.5s linear infinite;}}\n\n@keyframes svelte-gm3z5y-blinker {\n  50% {\n    opacity: 0.4;\n  }\n}"};a.delegate(["click"]);var p=r(5);s=document.getElementById("app"),(0,p.Or)(function(e,t){a.push(t,!0),a.append_styles(e,f);let r=["#000","red","orangered","orange","yellow","chartreuse","yellowgreen","lime","limegreen","darkgreen","aquamarine","magenta","orchid"],s=n("game/sp/tetris/showGhost",!0),l=n("game/sp/tetris/speedup",!0),p=n("game/sp/tetris/highscore",0),h=[...i],b=a.state(0),y=a.derived(()=>h[a.get(b)][0]),w=a.state((Math.random()*(r.length-1)|0)+1),_=a.state(!1),k=a.state(!1),z=0,x=a.proxy(Array.from({length:20},()=>Array(10).fill(0))),O=a.state(0),$=a.state(0),M=a.state(0),S=!1,A=!1,P=!1,L=!1,C=a.state(-1),j=-1,E=a.state(-1),G=a.state(-1),I=a.state(20),K=a.state(void 0),T=a.state(-1),D=a.state(-1);function N(){a.set(_,!1),clearTimeout(z),z=0}function W(){let e;j=0,a.set(E,7*Math.random()|0),a.set(K,(e=h[a.get(b)],a.update(b),a.get(b)===h.length&&(a.set(b,0),function(e,t=0,r=e.length){for(let s=r-1-t;s!==t;--s){let r=Math.floor(Math.random()*(s+1)),a=e[t+s];e[t+s]=e[t+r],e[t+r]=a}}(h)),e),!0),a.set(T,0),a.set(D,a.get(w),!0),a.set(w,(Math.random()*(r.length-1)|0)+1),J(),q(),a.get(G)||N()}function B(){let e=j;for(let t=0;t<4;t++,e++){let r=e<0||e>=20,s=a.get(E);for(let n=0;n<4;n++,s++){let l=s<0||s>=10;if((r||l||0!==x[e][s])&&a.get(K)[a.get(T)][t][n])return!1}}return!0}function J(){let e=j;do if(j++,!B()){j--;break}while(j<20);for(a.set(G,j,!0),q(),a.set(I,20);a.get(I)&&x[a.get(I)-1].every(e=>0!==e);)a.update(I,-1);V(0),j=e}function V(e){let t=j;for(let r=0;r<4;r++,t++){if(t<0||t>=20)continue;let s=a.get(E);for(let n=0;n<4;n++,s++)s<0||s>=10||!a.get(K)[a.get(T)][r][n]||(x[t][s]=e)}}function q(){V(a.get(D))}function H(){a.get(k)||(l.value&&(a.set(C,a.get(C)-25e-6*(a.get(C)*a.get(C))),1>a.get(C)&&a.set(C,1)),z=window.setTimeout(H,0|a.get(C)),function(){a.set($,a.get($)+1),V(0);let e=!1;P&&(a.set(T,(a.get(T)+1)%a.get(K).length),B()?e=!0:a.set(T,(a.get(T)||a.get(K).length)-1)),S!==A&&(a.set(E,a.get(E)+(S?-1:1)),B()?e=!0:a.set(E,a.get(E)+(S?1:-1))),e&&J();let t=a.get(G)-j;if(j+=Math.min(t,L?3:1),q(),!t&&!e){let e=j;for(let t=0;t<4;t++,e++){if(e<0||e>=20)continue;let r=a.get(E);for(let e=0;e<4;e++,r++)r<0||r>=10||!a.get(K)[a.get(T)][t][e]||a.set(O,a.get(O)+(5-r-(r>=5)))}a.set($,a.get($)+100);let t=19;for(let e=t;-1!==e;e--)if(x[e].every(e=>0!==e))a.set($,a.get($)+1e3),a.update(M);else{if(t!==e)for(let r=0;r<10;r++)x[t][r]=x[e][r];t--}for(;-1!==t;t--)for(let e=0;e<10;e++)x[t][e]=0;(-69>a.get(O)||a.get(O)>69?N:W)()}p.value<a.get($)&&(p.value=a.get($))}())}function R(e,t){if(!e.defaultPrevented){switch(e.code){case"KeyS":case"ArrowDown":L=t;break;case"KeyW":case"ArrowUp":P=t;break;case"KeyA":case"ArrowLeft":S=t;break;case"KeyD":case"ArrowRight":A=t;break;default:return}e.preventDefault()}}var U=m();a.event("keyup",a.window,e=>R(e,!1)),a.event("keydown",a.window,e=>R(e,!0));var X=a.first_child(U),F=a.child(X);F.__click=function(){for(let e=0;e<20;e++){let t=x[e];for(let e=0;e<10;e++)t[e]=0}a.set(O,0),a.set($,0),a.set(M,0),a.set(_,!0),a.set(k,!1),W(),z&&clearTimeout(z),z=window.setTimeout(H,0),a.set(C,200)};var Q=a.sibling(F,2);Q.__click=[g,k,_,H];var Y=a.sibling(Q,2);Y.__click=()=>s.value=!s.value;var Z=a.sibling(Y,2);Z.__click=()=>l.value=!l.value,a.reset(X);var ee=a.sibling(X,2),et=a.child(ee);a.reset(ee);var er=a.sibling(ee,2),es=a.child(er);a.each(es,21,()=>x,a.index,(e,t,n)=>{var l=u();a.each(l,21,()=>a.get(t),a.index,(e,t,l)=>{let o,i=a.derived(()=>s.value&&!a.get(t)&&function(e,t,r,s,a,n){if(x[a][n]||!e)return!1;let l=e[t],o=a-r;if(o<0||o>=l.length)return!1;let i=l[o],g=n-s;return!(g<0)&&!(g>=i.length)&&!!i[g]}(a.get(K),a.get(T),a.get(G),a.get(E),n,l));var g=c();a.template_effect(e=>{a.set_style(g,`background-color:${r[a.get(t)||(a.get(i)?a.get(D):0)]??""}`),o=a.set_class(g,1,"svelte-gm3z5y",null,o,e)},[()=>({ghost:a.get(i),ghostLine:s.value&&n>=a.get(I)})]),a.append(e,g)}),a.reset(l),a.append(e,l)}),a.reset(es),a.reset(er);var ea=a.sibling(er,2),en=a.child(ea);o(a.child(en),{get moment(){return a.get(O)},momentMax:69}),a.reset(en);var el=a.sibling(en,2),eo=a.child(el);{let e=a.derived(()=>-a.get(O));o(eo,{get moment(){return a.get(e)},momentMax:69})}a.reset(el),a.reset(ea);var ei=a.sibling(ea,2),eg=a.child(ei);a.each(eg,21,()=>a.get(y),a.index,(e,t)=>{var s=v();a.each(s,21,()=>a.get(t),a.index,(e,t)=>{var s=d();a.template_effect(()=>a.set_style(s,`background-color:${r[a.get(t)?a.get(w):0]??""}`)),a.append(e,s)}),a.reset(s),a.append(e,s)}),a.reset(eg),a.reset(ei),a.template_effect(e=>{a.set_class(Q,1,`btn w-100 btn-${a.get(k)?"":"outline-"}warning`,"svelte-gm3z5y"),a.set_class(Y,1,`btn w-50 btn-${s.value?"":"outline-"}success`,"svelte-gm3z5y"),a.set_class(Z,1,`btn w-50 btn-${l.value?"primary":"outline-secondary"}`,"svelte-gm3z5y"),a.set_text(et,`(${e??""}) |
  Score: ${a.get($)??""} | High Score: ${p.value??""} | Lines cleared: ${a.get(M)??""} | Moment: ${!a.get(O)?"0":a.get(O)>0?a.get(O)+" CCW":-a.get(O)+" CW"} (69 max)`),a.set_style(er,`backface-visibility: hidden; transform: rotate(${-a.get(O)/69*45}deg)`)},[()=>a.get(_)?a.get(k)?"Paused":(200/(0|a.get(C))).toPrecision(3)+"x":"Game over"]),a.append(e,U),a.pop()},{target:s}),document.getElementById("appLoading")?.remove()}},n={};function l(e){var t=n[e];if(void 0!==t)return t.exports;var r=n[e]={exports:{}};return a[e](r,r.exports,l),r.exports}l.m=a,l.d=(e,t)=>{for(var r in t)l.o(t,r)&&!l.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e=[],l.O=(t,r,s,a)=>{if(r){a=a||0;for(var n=e.length;n>0&&e[n-1][2]>a;n--)e[n]=e[n-1];e[n]=[r,s,a];return}for(var o=1/0,n=0;n<e.length;n++){for(var[r,s,a]=e[n],i=!0,g=0;g<r.length;g++)(!1&a||o>=a)&&Object.keys(l.O).every(e=>l.O[e](r[g]))?r.splice(g--,1):(i=!1,a<o&&(o=a));if(i){e.splice(n--,1);var c=s();void 0!==c&&(t=c)}}return t},l.rv=()=>"1.5.8",t={90:0},l.O.j=e=>0===t[e],r=(e,r)=>{var s,a,[n,o,i]=r,g=0;if(n.some(e=>0!==t[e])){for(s in o)l.o(o,s)&&(l.m[s]=o[s]);if(i)var c=i(l)}for(e&&e(r);g<n.length;g++)a=n[g],l.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return l.O(c)},(s=self.webpackChunkvwww=self.webpackChunkvwww||[]).forEach(r.bind(null,0)),s.push=r.bind(null,s.push.bind(s)),l.ruid="bundler=rspack@1.5.8";var o=l.O(void 0,["1","4","9","2","6","5","7","44","41","43"],function(){return l(146)});o=l.O(o)})();