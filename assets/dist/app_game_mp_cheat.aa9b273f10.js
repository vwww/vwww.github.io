(()=>{"use strict";var e,t,s,i,n={137:function(e,t,s){s(1);var i,n,r,a,o,l,d,c,p,h,u=s(2),m=s(120),g=s(121),v=s(122),_=s(123),f=s(124),k=s(125),C=s(126),b=s(127),I=s(130);function y(e){return e.reduce((e,t)=>e+t,0n)}var x=s(131),R=s(134),M=s(133);class T extends I.wG{}class N{#e=u.state(-1);get owner(){return u.get(this.#e)}set owner(e){u.set(this.#e,e,!0)}}class E{isMe;ownerName=""}class A extends I.Nd{#t=u.state(u.proxy([]));get playerInfo(){return u.get(this.#t)}set playerInfo(e){u.set(this.#t,e,!0)}#s=u.state(0);get turnIndex(){return u.get(this.#s)}set turnIndex(e){u.set(this.#s,e,!0)}#i=u.state(u.proxy([]));get playerDiscInfo(){return u.get(this.#i)}set playerDiscInfo(e){u.set(this.#i,e,!0)}discIndex=0;#n=u.derived(()=>this.playing&&this.playerIsMe(this.playerInfo[this.turnIndex]));get canMove(){return u.get(this.#n)}set canMove(e){u.set(this.#n,e)}formatPlayerName(e,t){return e?(0,x.M0)(this.clients[e.owner],e.owner):`<unknown${void 0===t?"":" pn#"+t}>`}playerIsMe(e){return e?.owner===this.localClient.cn}processWelcomeGame(e){super.processWelcomeGame(e),this.processPlayerInfos(e),this.processDiscInfos(e),this.processRoundInfo(e)}processPlayerInfos(e){let t=[];for(let s=0;s<=this.clients.length;s++){let s=e.getCN();if(s<0)break;let i=new this.PlayerInfoType;i.owner=s,this.processPlayerInfo(e,i),t.push(i)}if((this.playerInfo=t).length){if(this.turnIndex=e.getInt(),this.turnIndex<0||this.turnIndex>=t.length)throw Error("bad turnIndex")}else this.turnIndex=0}processDiscInfos(e){let t=[];for(let s=0;s<=this.clients.length;s++){let s=e.getString(20);if(!s)break;let i=e.getCN(),n=new this.PlayerDiscType;n.ownerName=`${s} (${i})`,this.processDiscInfo(e,n),t.push(n)}if(this.playerDiscInfo=t,this.discIndex=e.getInt(),this.discIndex<0||this.discIndex>this.playerDiscInfo.length)throw Error("bad discIndex")}processRoundStart(e){super.processRoundStart(e);let t=[];for(let s=0;s<=this.clients.length;s++){let s=e.getCN();if(s<0)break;let i=new this.PlayerInfoType;i.owner=s,t.push(i)}this.playerInfo=t,this.playerDiscInfo=[],this.turnIndex=0,this.discIndex=0,this.processRoundStartInfo(e)}processEliminateBase(e,t){let s=e.getInt(),i=this.playerInfo[s];if(!i)throw Error("invalid eliminate pn "+s);let n=new this.PlayerDiscType,r=this.clients[i.owner];if(!r)throw Error(`invalid owner ${i.owner} of pn ${s}`);n.ownerName=(0,x.M0)(r,i.owner),n.isMe=r===this.localClient;let a=this.eliminatePlayer(e,n,s,i,r,t);this.playerInfo.splice(s,1),this.playerDiscInfo.splice(this.discIndex,0,n),a&&this.discIndex++}processEliminate(e){this.processEliminateBase(e,!1)}processEliminateEarly(e){this.processEliminateBase(e,!0)}nextTurn(){++this.turnIndex==this.playerInfo.length&&(this.turnIndex=0)}}let w=[["optTurnTime","i",2e4,"Turn Time / ms","duration of each turn, in milliseconds",5e3,6e4],["optCallTime","i",3e3,"Call Time / ms","guaranteed time to call cheat, in milliseconds",2e3,1e4],["optDecks","I",1,"Decks","number of decks",1,0x8000000000000],["optCheck","e",2,"Check","how to resolve challenges",["arbiter","caller","public","public+"]],["optTricks","e",0,"Tricks","passing in tricks",["forced (no passing)","pass turn","pass trick","single turn"]],["optCountSame","b",!0,"Count (same)","can play same count as previous move"],["optCountMore","b",!0,"Count (more)","can play more cards than previous move"],["optCountLess","b",!0,"Count (less)","can play fewer cards than previous move, but not zero"],["optCountZero","b",!0,"Count (zero)","can play zero cards"],["optRankStartA","b",!0,"Trick Rank Start (Ace)","can start with Ace"],["optRankStartO","b",!0,"(others)","can start with rank other than Ace or King"],["optRankStartK","b",!0,"(King)","can start with King"],["optRank0","b",!0,"Trick Rank Subsequent (same)","can play same rank as previous move"],["optRank1u","b",!0,"(up 1)","previous plus one, when not wrapping"],["optRank1uw","b",!0,"(up 1 wrap)","previous plus one, when wrapping"],["optRank1d","b",!0,"(down 1)","previous minus one, when not wrapping"],["optRank1dw","b",!0,"(down 1 wrap)","previous minus one, when wrapping"],["optRank2u","b",!1,"(up 2)","previous plus two, when not wrapping"],["optRank2uw","b",!1,"(up 2 wrap)","previous plus two, when wrapping"],["optRank2d","b",!1,"(down 2)","previous minus two, when not wrapping"],["optRank2dw","b",!1,"(down 2 wrap)","previous minus two, when wrapping"],["optRankother","b",!1,"(others)","other ranks not covered above"]];function S(e){let t=e.optCountLess?e.optCountSame?e.optCountMore?"*":"≤":e.optCountMore?"≠":"<":e.optCountSame?e.optCountMore?"≥":"=":">";return e.optCallTime+"/"+e.optTurnTime+"/"+e.optDecks+"/"+e.optCheck+"/"+t+e.optTricks+(e.optRank1uw?"U":"u")+(e.optRank2uw?"U":"u")+(e.optRank2d?"D":"d")+(e.optRank1d?"D":"d")+(e.optRank0?"S":"s")+(e.optRank1u?"U":"u")+(e.optRank2u?"U":"u")+(e.optRank2dw?"D":"d")+(e.optRank1dw?"D":"d")+(e.optRankother?"O":"o")}(i=l||(l={}))[i.WELCOME=0]="WELCOME",i[i.JOIN=1]="JOIN",i[i.LEAVE=2]="LEAVE",i[i.RESET=3]="RESET",i[i.RENAME=4]="RENAME",i[i.PING=5]="PING",i[i.PING_TIME=6]="PING_TIME",i[i.CHAT=7]="CHAT",i[i.ACTIVE=8]="ACTIVE",i[i.ROUND_WAIT=9]="ROUND_WAIT",i[i.ROUND_INTERM=10]="ROUND_INTERM",i[i.ROUND_START=11]="ROUND_START",i[i.READY=12]="READY",i[i.END_ROUND=13]="END_ROUND",i[i.MOVE_CONFIRM=14]="MOVE_CONFIRM",i[i.END_TURN=15]="END_TURN",i[i.CALL_WIN=16]="CALL_WIN",i[i.CALL_FAIL=17]="CALL_FAIL",i[i.PLAYER_ELIMINATE=18]="PLAYER_ELIMINATE",i[i.PLAYER_ELIMINATE_EARLY=19]="PLAYER_ELIMINATE_EARLY",i[i.PLAYER_PRIVATE_INFO_HAND=20]="PLAYER_PRIVATE_INFO_HAND",i[i.PLAYER_PRIVATE_INFO_MOVE=21]="PLAYER_PRIVATE_INFO_MOVE",i[i.PLAYER_PRIVATE_INFO_PENALTY=22]="PLAYER_PRIVATE_INFO_PENALTY",i[i.PLAYER_PRIVATE_INFO_REVEAL=23]="PLAYER_PRIVATE_INFO_REVEAL",(n=d||(d={}))[n.RESET=0]="RESET",n[n.RENAME=1]="RENAME",n[n.PONG=2]="PONG",n[n.CHAT=3]="CHAT",n[n.ACTIVE=4]="ACTIVE",n[n.READY=5]="READY",n[n.MOVE=6]="MOVE",n[n.MOVE_CALL=7]="MOVE_CALL",n[n.MOVE_END=8]="MOVE_END";class O extends T{#r=u.state(0);get score(){return u.get(this.#r)}set score(e){u.set(this.#r,e,!0)}#a=u.state(0);get streak(){return u.get(this.#a)}set streak(e){u.set(this.#a,e,!0)}#o=u.state(0);get wins(){return u.get(this.#o)}set wins(e){u.set(this.#o,e,!0)}#l=u.state(0);get losses(){return u.get(this.#l)}set losses(e){u.set(this.#l,e,!0)}#d=u.state(0);get rankLast(){return u.get(this.#d)}set rankLast(e){u.set(this.#d,e,!0)}#c=u.state(0);get rankBest(){return u.get(this.#c)}set rankBest(e){u.set(this.#c,e,!0)}#p=u.state(0);get rankWorst(){return u.get(this.#p)}set rankWorst(e){u.set(this.#p,e,!0)}updateScore(e,t){this.rankLast=e,this.rankLast=e,this.rankBest=Math.min(this.rankBest||e,e),this.rankWorst=Math.max(this.rankWorst,e),this.score+=t-e+1,1===e?(this.streak<0&&(this.streak=0),this.streak++,this.wins++):(this.streak>0&&(this.streak=0),this.streak--,this.losses++)}resetScore(){this.score=0,this.streak=0,this.wins=0,this.losses=0,this.rankLast=0,this.rankBest=0,this.rankWorst=0}readWelcome(e){super.readWelcome(e),this.score=e.getInt(),this.streak=e.getInt(),this.wins=e.getInt(),this.losses=e.getInt(),this.rankLast=e.getInt(),this.rankBest=e.getInt(),this.rankWorst=e.getInt()}}class P extends N{#h=u.state(u.proxy(U()));get discardClaim(){return u.get(this.#h)}set discardClaim(e){u.set(this.#h,e,!0)}#u=u.state(0n);get handSize(){return u.get(this.#u)}set handSize(e){u.set(this.#u,e,!0)}#m=u.state(!1);get passed(){return u.get(this.#m)}set passed(e){u.set(this.#m,e,!0)}}class L extends E{handSize=0n;trickNum=0;duration=0n}(r=c||(c={}))[r.ARBITER=0]="ARBITER",r[r.CALLER=1]="CALLER",r[r.PUBLIC=2]="PUBLIC",r[r.PUBLIC_ALL=3]="PUBLIC_ALL",r[r.NUM=4]="NUM",(a=p||(p={}))[a.FORCED=0]="FORCED",a[a.PASS_TURN=1]="PASS_TURN",a[a.PASS_TRICK=2]="PASS_TRICK",a[a.SINGLE_TURN=3]="SINGLE_TURN",a[a.NUM=4]="NUM";let D=1n<<51n;class $ extends A{PlayerInfoType=P;PlayerDiscType=L;#g=u.state(u.proxy((0,C.q)(w)));get mode(){return u.get(this.#g)}set mode(e){u.set(this.#g,e,!0)}#v=u.state(!1);get canChallenge(){return u.get(this.#v)}set canChallenge(e){u.set(this.#v,e,!0)}#_=u.state(!1);get shouldChallenge(){return u.get(this.#_)}set shouldChallenge(e){u.set(this.#_,e,!0)}#f=u.state(0);get trickNum(){return u.get(this.#f)}set trickNum(e){u.set(this.#f,e,!0)}#k=u.state(0);get trickTurn(){return u.get(this.#k)}set trickTurn(e){u.set(this.#k,e,!0)}#C=u.state(0n);get trickCount(){return u.get(this.#C)}set trickCount(e){u.set(this.#C,e,!0)}#b=u.state(0);get trickRank(){return u.get(this.#b)}set trickRank(e){u.set(this.#b,e,!0)}#I=u.state(0);get callTimerStart(){return u.get(this.#I)}set callTimerStart(e){u.set(this.#I,e,!0)}#y=u.state(0);get callTimerEnd(){return u.get(this.#y)}set callTimerEnd(e){u.set(this.#y,e,!0)}#x=u.state(0);get passIndex(){return u.get(this.#x)}set passIndex(e){u.set(this.#x,e,!0)}#R=u.state(u.proxy(U()));get cardCountTotal(){return u.get(this.#R)}set cardCountTotal(e){u.set(this.#R,e,!0)}#M=u.state(u.proxy(U()));get cardCountHandMine(){return u.get(this.#M)}set cardCountHandMine(e){u.set(this.#M,e,!0)}#T=u.state(u.proxy(U()));get cardCountAllMine(){return u.get(this.#T)}set cardCountAllMine(e){u.set(this.#T,e,!0)}#N=u.derived(()=>this.cardCountTotal.map((e,t)=>e-this.cardCountHandMine[t]));get cardCountAllOthers(){return u.get(this.#N)}set cardCountAllOthers(e){u.set(this.#N,e)}#E=u.state(u.proxy(U()));get cardCountClaimMine(){return u.get(this.#E)}set cardCountClaimMine(e){u.set(this.#E,e,!0)}#A=u.state(u.proxy(U()));get cardCountClaimOthers(){return u.get(this.#A)}set cardCountClaimOthers(e){u.set(this.#A,e,!0)}#w=u.state(u.proxy(U()));get cardCountClaimRemain(){return u.get(this.#w)}set cardCountClaimRemain(e){u.set(this.#w,e,!0)}#S=u.state(u.proxy([]));get moveHistory(){return u.get(this.#S)}set moveHistory(e){u.set(this.#S,e,!0)}#O=u.state(u.proxy(V()));get pendingMoveNum(){return u.get(this.#O)}set pendingMoveNum(e){u.set(this.#O,e,!0)}#P=u.derived(()=>this.pendingMoveNum.map(BigInt));get pendingMoveNumB(){return u.get(this.#P)}set pendingMoveNumB(e){u.set(this.#P,e)}#L=u.derived(()=>y(this.pendingMoveNumB));get pendingMoveTotal(){return u.get(this.#L)}set pendingMoveTotal(e){u.set(this.#L,e)}#D=u.state(u.proxy(U()));get pendingMoveAck(){return u.get(this.#D)}set pendingMoveAck(e){u.set(this.#D,e,!0)}#$=u.state(0);get pendingMoveClaim(){return u.get(this.#$)}set pendingMoveClaim(e){u.set(this.#$,e,!0)}#U=u.state(0);get pendingMoveClaimAck(){return u.get(this.#U)}set pendingMoveClaimAck(e){u.set(this.#U,e,!0)}get ROUND_TIME(){return this.mode.optTurnTime}INTERMISSION_TIME=3e4;newClient(){return new O}enterGame(e,t){this.setupGame(e),this.sendf("is",this.PROTOCOL_VERSION,t)}sendReset(){this.sendf("i",d.RESET)}sendRename(e){this.sendf("is",d.RENAME,e)}sendPong(e){this.sendf("i2",d.PONG,e)}sendChat(e,t,s=-1){this.sendf("i3s",d.CHAT,t,s,(0,M.JK)(e))}sendActive(){this.sendf("i",d.ACTIVE)}sendReady(){this.sendf("i",d.READY)}sendMove(){var e;let t=new R.U().putInt(d.MOVE).putInt(this.pendingMoveClaim);e=t,this.pendingMoveNumB.forEach(t=>e.putUint64(t)),this.room?.send(t.toArray())}sendMoveCallCheat(){this.sendf("i",d.MOVE_CALL)}sendMoveEnd(){this.sendf("i",d.MOVE_END)}MESSAGE_HANDLERS={[l.WELCOME]:this.processWelcome,[l.JOIN]:this.processJoin,[l.LEAVE]:this.processLeave,[l.RESET]:this.processReset,[l.RENAME]:this.processRename,[l.PING]:this.processPing,[l.PING_TIME]:this.processPingTime,[l.CHAT]:this.processChat,[l.ACTIVE]:this.processActive,[l.ROUND_WAIT]:this.processRoundWait,[l.ROUND_INTERM]:this.processRoundInterm,[l.ROUND_START]:this.processRoundStart,[l.READY]:this.processReady,[l.END_ROUND]:this.processEndRound,[l.MOVE_CONFIRM]:this.processMoveConfirm,[l.END_TURN]:this.processEndTurn,[l.CALL_WIN]:this.processCallWin,[l.CALL_FAIL]:this.processCallFail,[l.PLAYER_ELIMINATE]:this.processEliminate,[l.PLAYER_ELIMINATE_EARLY]:this.processEliminateEarly,[l.PLAYER_PRIVATE_INFO_HAND]:this.processPrivateInfoHand,[l.PLAYER_PRIVATE_INFO_MOVE]:this.processPrivateInfoMove,[l.PLAYER_PRIVATE_INFO_PENALTY]:this.processPrivateInfoPenalty,[l.PLAYER_PRIVATE_INFO_REVEAL]:this.processPrivateInfoResult};processWelcomeMode(e){var t;this.mode.optTurnTime=e.getInt(),this.mode.optCallTime=e.getInt(),this.mode.optDecks=(t=e.getUint64(),1n>t?1n:t<D?t:D);let s=e.get(),i=e.get(),n=e.get();this.mode.optCheck=3&s,this.mode.optTricks=s>>2&3,this.mode.optCountSame=!!(16&s),this.mode.optCountMore=!!(32&s),this.mode.optCountLess=!!(64&s),this.mode.optCountZero=!!(128&s),this.mode.optRankStartA=!!(1&i),this.mode.optRankStartO=!!(2&i),this.mode.optRankStartK=!!(4&i),this.mode.optRank0=!!(8&i),this.mode.optRank1u=!!(16&i),this.mode.optRank1uw=!!(32&i),this.mode.optRank1d=!!(64&i),this.mode.optRank1dw=!!(128&i),this.mode.optRank2u=!!(1&n),this.mode.optRank2uw=!!(2&n),this.mode.optRank2d=!!(4&n),this.mode.optRank2dw=!!(8&n),this.mode.optRankother=!!(16&n)}processPlayerInfo(e,t){t.discardClaim=B(e);let s=e.getUint64();t.handSize=s>>1n,t.passed=!!(1n&s)}processDiscInfo(e,t){t.handSize=e.getUint64(),t.trickNum=e.getInt(),t.duration=e.getUint64()}processRoundStartInfo(e){let t=54n*this.mode.optDecks,s=BigInt(this.roundPlayers.length),i=t/s,n=t%s;this.playerInfo.forEach((e,t)=>{e.discardClaim=U(),e.handSize=i,t<n&&e.handSize++,e.passed=!1}),this.canChallenge=!1,this.trickNum=this.trickTurn=0,this.trickCount=0n,this.cardCountClaimMine=U(),this.cardCountClaimOthers=U(),this.cardCountClaimRemain=H(this.mode.optDecks),this.cardCountTotal=H(this.mode.optDecks),this.moveHistory=[],this.turnIndex=e.getInt(),this.passIndex=-1,this.resetMove()}processRoundInfo(e){if(this.moveHistory=[],this.cardCountHandMine=U(),this.cardCountClaimMine=U(),this.cardCountTotal=H(this.mode.optDecks),this.roundState!==I.mk.ACTIVE){this.canChallenge=!1,this.trickNum=this.trickTurn=0,this.trickCount=0n,this.cardCountClaimOthers=U(),this.cardCountClaimRemain=H(this.mode.optDecks);return}let t=e.getInt();this.trickNum=t>>1,this.canChallenge=!!(1&t),(this.trickTurn=e.getInt())&&(this.trickRank=e.getInt(),this.trickCount=e.getUint64());let s=B(e);this.cardCountClaimOthers=s,this.cardCountClaimRemain=this.cardCountTotal.map((e,t)=>e-s[t]),this.setCallTimer(this.canChallenge?e.getInt():0),this.passIndex=this.mode.optTricks!==p.FORCED?e.getInt():-1}processMoveConfirm(e){this.pendingMoveClaimAck=e.getInt(),this.pendingMoveAck=B(e)}processEndTurn(e){let t=this.playerInfo[this.turnIndex],s=this.clients[t.owner],i=(0,x.M0)(s,t.owner),n=s===this.localClient,r=e.getInt();if(r<0)this.moveHistory.push({type:"pass",playerName:i,playerIsMe:n}),this.mode.optTricks!==p.FORCED&&this.nextTurnAfterPass(t)&&this.nextTrick(),this.canChallenge=!1;else{let s=e.getUint64(),a=!this.nextRankPossible(r)||this.nextCountImpossible(s),o=a;if(this.mode.optTricks!==p.FORCED){this.passIndex=-1;let e=this.nextUnpassed(this.turnIndex);e===this.turnIndex&&(o=!0),o?t.handSize||this.nextTurn():this.mode.optTricks===p.SINGLE_TURN&&this.trickTurn?o=this.nextTurnAfterPass(t):(this.mode.optTricks===p.PASS_TURN&&this.unsetPassed(),this.turnIndex=e)}if(o?this.nextTrick(a):(this.trickCount=s,this.trickRank=r,this.trickTurn++),s){t.discardClaim[r]+=s,t.discardClaim[h.NUM]+=s,t.handSize-=s;let e=n?this.cardCountClaimMine:this.cardCountClaimOthers;e[r]+=s,e[h.NUM]+=s,this.cardCountClaimRemain[r]-=s,this.cardCountClaimRemain[h.NUM]-=s,this.shouldChallenge=(this.canChallenge=!n)&&s>this.cardCountAllOthers[r]+this.cardCountAllOthers[h.Joker],this.setCallTimer(this.mode.optCallTime)}else this.canChallenge=!1;this.moveHistory.push({type:"move",playerName:i,playerIsMe:n,rank:r,count:s})}this.mode.optTricks===p.FORCED&&this.nextTurn(),this.setTimer(this.mode.optTurnTime),this.resetMove()}nextTrick(e=!1){this.moveHistory.push({type:"tEnd",trick:this.trickNum,turn:this.trickTurn,move:e}),this.unsetPassed(),this.trickNum++,this.trickTurn=0}nextTurnAfterPass(e){let t=this.nextUnpassed(this.turnIndex);return t===this.turnIndex||this.passIndex<0&&this.nextUnpassed(t)===this.turnIndex?(this.turnIndex=this.passIndex<0?t:this.passIndex,this.passIndex=-1,!0):(this.turnIndex=t,e.passed=!0,!1)}nextUnpassed(e){let t=e;do++t===this.playerInfo.length&&(t=0);while(t!==e&&this.playerInfo[t].passed);return t}unsetPassed(){this.playerInfo.forEach(e=>e.passed=!1)}resetMove(){this.pendingMoveNum=V(),this.pendingMoveAck=U(),this.pendingMoveClaim=this.pendingMoveClaimAck=-1}processCall(e,t){let s=e.getCN(),i=this.playerInfo[s],n=this.clients[i.owner],r=t?i:this.playerInfo[(this.turnIndex||this.playerInfo.length)-1],a=t?n:this.clients[r.owner];for(let e of(this.moveHistory.push({type:t?"callFail":"callSuccess",playerName:(0,x.M0)(n,i.owner),playerIsMe:n===this.localClient,victimName:(0,x.M0)(a,r.owner),victimIsMe:a===this.localClient}),r.handSize+=this.cardCountClaimMine[h.NUM]+this.cardCountClaimOthers[h.NUM],this.playerInfo))e.discardClaim=U();this.cardCountAllMine=this.cardCountHandMine.slice(),this.cardCountClaimMine=U(),this.cardCountClaimOthers=U(),this.cardCountClaimRemain=H(this.mode.optDecks),this.canChallenge=!1,this.setTimer(this.mode.optTurnTime),this.setCallTimer(0)}processCallWin(e){this.processCall(e,!1)}processCallFail(e){this.processCall(e,!0)}processEndRound(e){let t=e.getUint64(),s={duration:t,trickNum:this.trickNum,players:this.playerDiscInfo.map(e=>({...e,name:e.ownerName}))},[i]=this.playerInfo,n=this.clients[i.owner],r=this.discIndex+1,a=1+this.playerDiscInfo.length;n.updateScore(r,a),s.players.splice(this.discIndex,0,{name:n.formatName(),isMe:n===this.localClient,trickNum:this.trickNum,duration:t}),this.addHistory(s)}eliminatePlayer(e,t,s,i,n,r){t.duration=e.getUint64(),t.trickNum=this.trickNum,r&&(this.cardCountClaimOthers[h.Joker]+=t.handSize=i.handSize,this.cardCountClaimOthers[h.NUM]+=t.handSize,this.cardCountClaimRemain[h.Joker]-=t.handSize,this.cardCountClaimRemain[h.NUM]-=t.handSize,s+1===(this.turnIndex||this.playerInfo.length)?this.canChallenge=!1:this.mode.optTricks!==p.FORCED&&s===this.turnIndex&&this.nextTurnAfterPass(i)&&this.nextTrick(),this.moveHistory.push({type:"leave",playerName:n.formatName(),playerIsMe:n===this.localClient,handSize:t.handSize}),this.setTimer(this.mode.optTurnTime));let a=this.playerInfo.length+this.playerDiscInfo.length,o=this.discIndex+(r?this.playerInfo.length:1);n.updateScore(o,a);let l=this.playerInfo.length-1;return this.turnIndex>s?this.turnIndex--:this.turnIndex===l&&(this.turnIndex=0),this.mode.optTricks!==p.FORCED&&(r?this.passIndex>s?this.passIndex--:this.passIndex===l&&(this.passIndex=0):this.passIndex=this.turnIndex),!r}processPrivateInfoHand(e){let t=B(e);this.cardCountHandMine=t,this.cardCountAllMine=t.slice()}processPrivateInfoMove(e){let t=B(e);for(let e=0;e<=h.NUM;e++)e<h.NUM&&(this.pendingMoveNum[e]=Number(t[e])),this.cardCountHandMine[e]-=t[e];this.moveHistory.push({type:"play",cards:t})}processPrivateInfoPenalty(e){let t=B(e);this.moveHistory.push({type:"penalty",cards:t});for(let e=0;e<=h.NUM;e++)this.cardCountHandMine[e]+=t[e]}processPrivateInfoResult(e){let t=B(e);if(this.moveHistory.push({type:"reveal",cards:t}),this.mode.optCheck===c.PUBLIC_ALL){let t=B(e);if(!t[h.NUM])return;this.moveHistory.push({type:"reveal2",cards:t})}}setCallTimer(e){let t=Date.now()+e;this.callTimerStart=t-Math.max(this.mode.optCallTime,e),this.callTimerEnd=t}allowRank(e){return this.trickTurn?this.checkRank(e,this.trickRank):this.checkRankStart(e)}allowCount(e){return this.trickTurn?e?e===this.trickCount?this.mode.optCountSame:e<this.trickCount?this.mode.optCountLess:this.mode.optCountMore&&e<=6n*this.mode.optDecks:this.mode.optCountZero:!!e}checkRankStart(e){return e===h.Ace?this.mode.optRankStartA:e===h.FKing?this.mode.optRankStartK:this.mode.optRankStartO}checkRank(e,t){if(e===t)return this.mode.optRank0;if(e===t+1)return this.mode.optRank1u;if(e===t+2)return this.mode.optRank2u;if(e===t-1)return this.mode.optRank1d;if(e===t-2)return this.mode.optRank2d;else if(e===h.Joker-1&&0===t)return this.mode.optRank1uw;else if(0===e&&t===h.Joker-1)return this.mode.optRank1dw;else if(e===h.Joker-1&&1===t||e===h.Joker-2&&0===t)return this.mode.optRank2uw;else if(0===e&&t===h.Joker-2||1===e&&t===h.Joker-1)return this.mode.optRank2dw;else return this.mode.optRankother}nextRankPossible(e){return this.mode.optRank0||this.mode.optRankother||(e===h.Joker-1?this.mode.optRank1uw:this.mode.optRank1u)||(0===e?this.mode.optRank1dw:this.mode.optRank1d)||(e===h.Joker-2?this.mode.optRank2uw:this.mode.optRank2u)||(1===e?this.mode.optRank2dw:this.mode.optRank2d)}nextCountImpossible(e){return!this.mode.optCountSame&&(e<=1n&&!this.mode.optCountMore||e===6n*this.mode.optDecks&&!this.mode.optCountLess)}playersSortProps=[e=>e.score,e=>e.wins,e=>e.streak]}function U(){return[0n,0n,0n,0n,0n,0n,0n,0n,0n,0n,0n,0n,0n,0n,0n]}function V(){return[0,0,0,0,0,0,0,0,0,0,0,0,0,0]}function H(e){let t=e+e,s=t+t;return[s,s,s,s,s,s,s,s,s,s,s,s,s,t,54n*e]}function B(e){let t=Array.from({length:h.NUM},()=>e.getUint64());return t.push(y(t)),t}(o=h||(h={}))[o.Ace=0]="Ace",o[o.N2=1]="N2",o[o.N3=2]="N3",o[o.N4=3]="N4",o[o.N5=4]="N5",o[o.N6=5]="N6",o[o.N7=6]="N7",o[o.N8=7]="N8",o[o.N9=8]="N9",o[o.N10=9]="N10",o[o.FJack=10]="FJack",o[o.FQueen=11]="FQueen",o[o.FKing=12]="FKing",o[o.Joker=13]="Joker",o[o.NUM=14]="NUM";var Y=u.from_html(' <div class="d-inline-block"> <span> </span> </div>',1),F=u.from_html('<li class="list-group-item"><div> <!></div></li>'),z=u.from_html('<li class="list-group-item">No past games!</li>'),W=u.from_html('<ul class="list-group list-group-flush overflow-auto" style="max-height: 15rem"></ul>'),G=u.from_html('<span class="badge text-bg-light"> </span><!>,',1),J=u.from_html('<div class="progress"><div class="progress-bar"></div></div>'),K=u.from_html('<div class="progress-stacked my-1"><div class="progress" style="width: 3.125%"><div class="progress-bar bg-info"></div></div> <!></div>'),j=u.from_html('<div class="progress bg-primary"></div>'),q=u.from_html('<tr><td> </td><td class="w-100"><!></td><td> </td></tr>'),Q=u.from_html('<!> <table class="table table-sm"><tbody></tbody></table>',1);function Z(e,t){u.push(t,!0);let s=u.derived(()=>t.cards.at(-1));var i=u.comment(),n=u.first_child(i),r=e=>{let i=u.derived(()=>t.cards.length-2),n=u.derived(()=>t.cards[u.get(i)]),r=u.derived(()=>t.cards.slice(0,-2)),a=u.derived(()=>BigInt(u.get(r).filter(e=>e).reduce((e,t)=>e<t?e:t))),o=u.derived(()=>BigInt(u.get(r).reduce((e,t)=>e>t?e:t))),l=u.derived(()=>u.get(o)-u.get(a));var d=Q(),c=u.first_child(d),p=e=>{var s=G(),r=u.first_child(s),a=u.child(r,!0);u.reset(r);var o=u.sibling(r),l=e=>{var t=u.text();u.template_effect(()=>u.set_text(t,` \xd7${u.get(n)??""}`)),u.append(e,t)};u.if(o,e=>{u.get(n)>1&&e(l)}),u.next(),u.template_effect(()=>u.set_text(a,t.ranks[u.get(i)])),u.append(e,s)};u.if(c,e=>{u.get(n)&&e(p)});var h=u.sibling(c),m=u.sibling(h),g=u.child(m);u.each(g,21,()=>u.get(r),u.index,(e,s,i)=>{var n=u.comment(),r=u.first_child(n),o=e=>{var n=q(),r=u.child(n),o=u.child(r,!0);u.reset(r);var d=u.sibling(r),c=u.child(d),p=e=>{var t=K(),i=u.sibling(u.child(t),2),n=e=>{var t=J();u.template_effect(e=>u.set_style(t,`width:${e??""}%`),[()=>Number((BigInt(u.get(s))-u.get(a))*96875n/u.get(l))/1e3]),u.append(e,t)};u.if(i,e=>{u.get(s)>u.get(a)&&e(n)}),u.reset(t),u.append(e,t)},h=e=>{var t=j();u.append(e,t)};u.if(c,e=>{u.get(l)?e(p):e(h,!1)}),u.reset(d);var m=u.sibling(d),g=u.child(m,!0);u.reset(m),u.reset(n),u.template_effect(()=>{u.set_text(o,t.ranks[i]),u.set_text(g,u.get(s))}),u.append(e,n)};u.if(r,e=>{u.get(s)&&e(o)}),u.append(e,n)}),u.reset(g),u.reset(m),u.template_effect(()=>u.set_text(h,` ${u.get(s)??""} total.   `)),u.append(e,d)};u.if(n,e=>{u.get(s)&&e(r)}),u.append(e,i),u.pop()}var X=u.from_html('<span class="badge text-bg-light"> </span><!> ',1);function ee(e,t){u.push(t,!0);var s=u.comment(),i=u.first_child(s);u.each(i,17,()=>t.cards,u.index,(e,s,i)=>{var n=u.comment(),r=u.first_child(n),a=e=>{var n=u.comment(),r=u.first_child(n),a=e=>{var t=u.text();u.template_effect(()=>u.set_text(t,` ${u.get(s)??""} total.`)),u.append(e,t)},o=e=>{var n=X(),r=u.first_child(n),a=u.child(r,!0);u.reset(r);var o=u.sibling(r),l=e=>{var t=u.text();u.template_effect(()=>u.set_text(t,` \xd7${u.get(s)??""}`)),u.append(e,t)};u.if(o,e=>{u.get(s)>1&&e(l)}),u.sibling(o).nodeValue=", ",u.template_effect(()=>u.set_text(a,t.ranks[i])),u.append(e,n)};u.if(r,e=>{i+1==t.cards.length?e(a):e(o,!1)}),u.append(e,n)};u.if(r,e=>{u.get(s)&&e(a)}),u.append(e,n)}),u.append(e,s),u.pop()}var et=u.from_html('<th scope="col"> </th>'),es=u.from_html("<td> </td>"),ei=u.from_html('<tr><th scope="row"> </th><!></tr>'),en=u.from_html('<div class="table-responsive"><table class="table table-sm"><thead><tr><th></th><!></tr></thead><tbody></tbody></table></div>');function er(e,t){var s=en(),i=u.child(s),n=u.child(i),r=u.child(n),a=u.sibling(u.child(r));u.each(a,17,()=>t.ranks,u.index,(e,t)=>{var s=et(),i=u.child(s,!0);u.reset(s),u.template_effect(()=>u.set_text(i,u.get(t))),u.append(e,s)}),u.reset(r),u.reset(n);var o=u.sibling(n);u.each(o,21,()=>t.counts,u.index,(e,t)=>{var s=ei(),i=u.child(s),n=u.child(i,!0);u.reset(i);var r=u.sibling(i);u.each(r,17,()=>u.get(t)[1],u.index,(e,t)=>{var s=es(),i=u.child(s,!0);u.reset(s),u.template_effect(()=>u.set_text(i,u.get(t))),u.append(e,s)}),u.reset(s),u.template_effect(()=>u.set_text(n,u.get(t)[0])),u.append(e,s)}),u.reset(o),u.reset(i),u.reset(s),u.append(e,s)}var ea=s(128),eo=s(135),el=u.from_html('<span> </span> played <span class="badge text-bg-light"> </span><!>.',1),ed=u.from_html("<span> </span> passed.",1),ec=u.from_html("<span> </span> called cheat successfully on <span> </span>.",1),ep=u.from_html("<span> </span> called cheat wrongfully.",1),eh=u.from_html(" <!>",1),eu=u.from_html("<span> </span> ",1),em=u.from_html("<div><!></div> ",1),eg=u.from_html('<b>Move History</b> <label class="form-check d-inline-block"><input type="checkbox" class="form-check-input"/> <span class="form-check-label">compact</span></label> <div class="overflow-auto" style="max-height: 20rem"></div>',1);let ev=["A","2","3","4","5","6","7","8","9","10","J","Q","K","*","Total"];var e_=u.from_html("<!> <!>",1),ef=u.from_html(' <span class="badge text-bg-light"> </span> ',1),ek=(e,t)=>t().sendMoveCallCheat(),eC=u.from_html("<span>PASS</span>"),eb=u.from_html('<span class="badge text-bg-outline-danger">IMPOSSIBLE</span>'),eI=u.from_html("<span>HONEST</span>"),ey=u.from_html("<span>BLUFF</span>"),ex=u.from_html("<span> </span> <!>",1),eR=(e,t)=>(t().pendingMoveClaim=-1,t().sendMove()),eM=u.from_html("<button> </button>"),eT=(e,t)=>t().sendMove(),eN=(e,t)=>t().sendMove(),eE=u.from_html('<div class="col-4 col-md-3 col-lg-2"> <input type="number" min="0"/> <input type="range" class="form-range" min="0"/></div>'),eA=u.from_html("Passing is not allowed<!>.",1),ew=u.from_html(" <!>.",1),eS=u.from_html("<!> <!>",1),eO=u.from_html('<div class="alert alert-danger"><!></div>'),eP=(e,t)=>t().sendMoveEnd(),eL=u.from_html('<div class="mb-2 text-center">Your move: <!></div> <div class="btn-group d-flex mb-3" role="group"><button>Pass</button> <!></div> <div class="row"></div> <!> <div class="col-12 mb-2"><button class="btn btn-primary d-block w-100 mb-2">End Move</button></div>',1),eD=u.from_html('<button>Call Cheat</button> <div class="my-2"><label class="form-check d-inline-block"><input type="checkbox" class="form-check-input"/> <span class="form-check-label">Your hand:</span></label> <!></div> <!>',1),e$=u.from_html("<!> <!>",1),eU=u.from_html('<li><span class="badge text-bg-outline-success">IN</span></li>'),eV=u.from_html("<span>MOVE</span>"),eH=u.from_html("<span>OUT</span>"),eB=u.from_html("<!> <li><span> </span> <!> <!> </li>",1),eY=u.from_html("<li>No players!</li>"),eF=u.from_html("<li> <span> </span> </li>"),ez=u.from_html("<li>No leavers yet!</li>"),eW=u.from_html("<div>Your cards <!></div> <div>Actual cards <!></div> <div>Claimed cards <!></div>",1),eG=u.from_html('<!> <div class="row"><div class="col-12"><div class="mb-2 text-center"> <!></div> <!></div> <div class="col-12 col-sm-4"><b>Active Players</b> <ol class="list-unstyled"></ol> <b>Done Players</b> <ol class="list-unstyled"></ol></div> <div class="col-12 col-sm-8"><!></div> <div class="col mt-2"><!> <!></div></div> <div> </div> <b>Lobby</b> <!>',1);u.delegate(["click","change"]);var eJ=s(102),eK=u.from_html('<!> <!> <!> <div class="row"><div class="col-12 col-xl-8"><!> <!></div> <div class="col-12 col-xl-4 mb-3"><!></div></div>',1);(0,s(96).A)(function(e,t){let s;u.push(t,!0);let i=new g.Ay,n=new $(i),r=u.derived(()=>n.pastGames),a=u.derived(()=>n.leaderboard),o=u.derived(()=>n.localClient),l=u.derived(()=>n.roundState),d=(0,eJ.C)("game/mp/_shared/name","");var c=eK(),y=u.first_child(c);(0,f.A)(y,{get value(){return d.value},set value($$value){d.value=$$value}});var R=u.sibling(y,2);u.bind_this((0,b.A)(R,{gameId:"cheat-zoded3ozqeqvek0bpz3fow",roomType:"CheatRoom",get gameRoom(){return n.room},onJoinedRoom:e=>n.enterGame(e,d.value),formatGameMode:e=>S((0,C.e)(w,e)),get roomCreateOptions(){return w}}),e=>s=e,()=>s);var M=u.sibling(R,2);{let e=u.derived(()=>u.get(l)===I.mk.INTERMISSION);(0,k.A)(M,{get inGame(){return n.room},get isActive(){return n.localClient.active},get canReady(){return u.get(e)},get isReady(){return n.localClient.ready},onActive:()=>n.sendActive(),onReady:()=>n.sendReady(),onReset:()=>n.sendReset(),onDisconnect:()=>(n.leaveGame(),s.refreshRooms()),children:(e,t)=>{var s,i,r,a,o,l,d,c,m,g,v,_,f,k,C,b,y,R,M,T,N,E,A,w,O,P,L,D,$,U,V,H,B;let Y,F,z,W,G,J,K,j,q,Q,X;s={get gameState(){return n}},u.push(s,!0),Y=u.prop(s,"gameState",7),F=u.derived(()=>Y().localClient),z=u.derived(()=>Y().roundState),W=u.derived(()=>Y().playerInfo),G=u.derived(()=>Y().turnIndex),J=u.derived(()=>Y().playing),K=u.derived(()=>Y().canMove),j=u.derived(()=>Y().playerDiscInfo),q=u.derived(()=>Y().moveHistory),Q=u.state(!1),i=eG(),r=u.first_child(i),a=e=>{var t=u.text("Waiting for players…");u.append(e,t)},o=e=>{var t=e_(),s=u.first_child(t),i=e=>{var t=u.text("Intermission:");u.append(e,t)},n=e=>{var t=u.comment(),s=u.first_child(t),i=e=>{var t=u.text("Make a move:");u.append(e,t)},n=e=>{var t=u.comment(),s=u.first_child(t),i=e=>{var t=u.text("Waiting for opponent to move…");u.append(e,t)},n=e=>{var t=u.text("Spectating:");u.append(e,t)};u.if(s,e=>{u.get(F).inRound?e(i):e(n,!1)},!0),u.append(e,t)};u.if(s,e=>{u.get(K)?e(i):e(n,!1)},!0),u.append(e,t)};u.if(s,e=>{u.get(z)===I.mk.INTERMISSION?e(i):e(n,!1)});var r=u.sibling(s,2);(0,ea.A)(r,{get startTime(){return Y().roundTimerStart},get endTime(){return Y().roundTimerEnd},get active(){return Y().room}}),u.append(e,t)},u.if(r,e=>{u.get(z)==I.mk.WAITING?e(a):e(o,!1)}),l=u.sibling(r,2),d=u.child(l),c=u.child(d),m=u.child(c),g=u.sibling(m),v=e=>{var t=ef(),s=u.first_child(t),i=u.sibling(s),n=u.child(i,!0);u.reset(i);var r=u.sibling(i);u.template_effect(()=>{u.set_text(s,`Move ${Y().trickTurn??""}: `),u.set_text(n,ev[Y().trickRank]),u.set_text(r,` \xd7${Y().trickCount??""}`)}),u.append(e,t)},_=e=>{var t=u.text("Move 0");u.append(e,t)},u.if(g,e=>{Y().trickTurn?e(v):e(_,!1)}),u.reset(c),f=u.sibling(c,2),k=e=>{var t=e$(),s=u.first_child(t),i=e=>{let t,s=u.derived(()=>u.get(Q)?Z:ee);var i=eD(),n=u.first_child(i);n.__click=[ek,Y];var r=u.sibling(n,2),a=u.child(r),o=u.child(a);u.remove_input_defaults(o),u.next(2),u.reset(a);var l=u.sibling(a,2);u.component(l,()=>u.get(s),(e,t)=>{t(e,{get ranks(){return ev},get cards(){return Y().cardCountHandMine}})}),u.reset(r);var d=u.sibling(r,2),c=e=>{let t,s=u.derived(()=>Y().mode.optTricks!==p.FORCED&&Y().trickTurn),i=u.derived(()=>Y().pendingMoveClaim<0),n=u.derived(()=>u.get(i)?u.get(s):Y().allowRank(Y().pendingMoveClaim)),r=u.derived(()=>u.get(i)||Y().allowCount(Y().pendingMoveTotal)),a=u.derived(()=>u.get(n)?"":"outline-"),o=u.derived(()=>u.get(r)?"":"outline-");var l=eL(),d=u.first_child(l),c=u.sibling(u.child(d)),m=e=>{var t=eC();u.template_effect(()=>u.set_class(t,1,`badge text-bg-${u.get(s)?"":"outline-"}danger`)),u.append(e,t)},g=e=>{var t=ex(),s=u.first_child(t),i=u.child(s,!0);u.reset(s);var n=u.sibling(s),r=u.sibling(n),l=e=>{var t=eb();u.append(e,t)},d=e=>{var t=u.comment(),s=u.first_child(t),i=e=>{var t=eI();u.template_effect(()=>u.set_class(t,1,`badge text-bg-${u.get(o)??""}success`)),u.append(e,t)},n=e=>{var t=ey();u.template_effect(()=>u.set_class(t,1,`badge text-bg-${u.get(o)??""}warning`)),u.append(e,t)};u.if(s,e=>{Y().pendingMoveTotal==BigInt(Y().pendingMoveNum[Y().pendingMoveClaim])+BigInt(Y().pendingMoveNum[h.Joker])?e(i):e(n,!1)},!0),u.append(e,t)};u.if(r,e=>{Y().pendingMoveTotal>6n*Y().mode.optDecks?e(l):e(d,!1)}),u.template_effect(()=>{u.set_class(s,1,`badge text-bg-${u.get(a)??""}light`),u.set_text(i,ev[Y().pendingMoveClaim]),u.set_text(n,` \xd7${Y().pendingMoveTotal??""} `)}),u.append(e,t)};u.if(c,e=>{u.get(i)?e(m):e(g,!1)}),u.reset(d);var v=u.sibling(d,2),_=u.child(v);_.__click=[eR,Y];var f=u.sibling(_,2);u.each(f,17,()=>({length:h.NUM-1}),u.index,(e,t,s)=>{let i;var n=eM();n.__click=()=>(Y().pendingMoveClaim=s,Y().sendMove());var r=u.child(n,!0);u.reset(n),u.template_effect((e,t)=>{i=u.set_class(n,1,`fw-bold w-100 btn btn-${Y().pendingMoveClaimAck==s?"":"outline-"}${e??""}`,null,i,t),u.set_text(r,ev[s])},[()=>Y().allowRank(s)?"primary":"secondary",()=>({active:Y().pendingMoveClaim==s})]),u.append(e,n)}),u.reset(v);var k=u.sibling(v,2);u.each(k,21,()=>({length:h.NUM}),u.index,(e,t,s)=>{var i=u.comment(),n=u.first_child(i),r=e=>{let t=u.derived(()=>Y().cardCountHandMine[s].toString());var i=eE(),n=u.child(i),r=u.sibling(n);u.remove_input_defaults(r),r.__change=[eT,Y];var a=u.sibling(r,2);u.remove_input_defaults(a),a.__change=[eN,Y],u.reset(i),u.template_effect(e=>{u.set_text(n,`${ev[s]??""} `),u.set_class(r,1,`form-control is-${e??""}valid`),u.set_attribute(r,"max",u.get(t)),u.set_attribute(a,"max",u.get(t))},[()=>Y().pendingMoveNum[s]===Number(Y().pendingMoveAck[s])?"":"in"]),u.bind_value(r,()=>Y().pendingMoveNum[s],e=>Y().pendingMoveNum[s]=e),u.bind_value(a,()=>Y().pendingMoveNum[s],e=>Y().pendingMoveNum[s]=e),u.append(e,i)};u.if(n,e=>{Y().cardCountHandMine[s]&&e(r)}),u.append(e,i)}),u.reset(k);var C=u.sibling(k,2),b=e=>{var t=eO(),s=u.child(t),a=e=>{var t=eA(),s=u.sibling(u.first_child(t)),i=e=>{var t=u.text();t.nodeValue=" on a new trick",u.append(e,t)};u.if(s,e=>{Y().mode.optTricks!==p.FORCED&&e(i)}),u.next(),u.append(e,t)},o=e=>{var t=eS(),s=u.first_child(t),i=e=>{var t=u.text();u.template_effect(()=>u.set_text(t,`Rank ${ev[Y().pendingMoveClaim]??""} is not allowed.`)),u.append(e,t)};u.if(s,e=>{u.get(n)||e(i)});var a=u.sibling(s,2),o=e=>{var t=ew(),s=u.first_child(t),i=u.sibling(s),n=e=>{var t=u.text();t.nodeValue=" on a new trick",u.append(e,t)};u.if(i,e=>{!Y().pendingMoveTotal&&Y().mode.optCountZero&&e(n)}),u.next(),u.template_effect(()=>u.set_text(s,`Count ${Y().pendingMoveTotal??""} is not allowed`)),u.append(e,t)};u.if(a,e=>{u.get(r)||e(o)}),u.append(e,t)};u.if(s,e=>{u.get(i)?e(a):e(o,!1)}),u.reset(t),u.append(e,t)};u.if(C,e=>{u.get(n)&&u.get(r)||e(b)});var I=u.sibling(C,2);u.child(I).__click=[eP,Y],u.reset(I),u.template_effect(e=>t=u.set_class(_,1,`fw-bold w-100 btn btn-${Y().pendingMoveClaimAck<0?"":"outline-"}${u.get(s)?"danger":"secondary"}`,null,t,e),[()=>({active:u.get(i)})]),u.append(e,l)};u.if(d,e=>{u.get(K)&&e(c)}),u.template_effect(e=>t=u.set_class(n,1,`btn btn-${Y().canChallenge&&Y().shouldChallenge?"":"outline-"}danger d-block w-100 mb-2`,null,t,e),[()=>({disabled:!Y().canChallenge})]),u.bind_checked(o,()=>u.get(Q),e=>u.set(Q,e)),u.append(e,i)};u.if(s,e=>{u.get(J)&&e(i)});var n=u.sibling(s,2);(0,ea.A)(n,{get startTime(){return Y().callTimerStart},get endTime(){return Y().callTimerEnd},get active(){return Y().room}}),u.append(e,t)},u.if(f,e=>{u.get(z)===I.mk.ACTIVE&&e(k)}),u.reset(d),C=u.sibling(d,2),b=u.sibling(u.child(C),2),u.each(b,21,()=>u.get(W),u.index,(e,t,s)=>{let i=u.derived(()=>Y().playerIsMe(u.get(t))),n=u.derived(()=>u.get(i)?"":"-outline");var r=eB(),a=u.first_child(r),o=e=>{var t=eU();u.append(e,t)};u.if(a,e=>{s===Y().passIndex&&u.get(W).length>1&&e(o)});var l=u.sibling(a,2),d=u.child(l),c=u.child(d,!0);u.reset(d);var p=u.sibling(d,2),h=e=>{var t=eV();u.template_effect(()=>u.set_class(t,1,`badge text-bg${u.get(n)??""}-primary`)),u.append(e,t)};u.if(p,e=>{s===u.get(G)&&e(h)});var m=u.sibling(p,2),g=e=>{var t=eH();u.template_effect(()=>u.set_class(t,1,`badge text-bg${u.get(n)??""}-danger`)),u.append(e,t)};u.if(m,e=>{u.get(t).passed&&e(g)});var v=u.sibling(m);u.reset(l),u.template_effect(e=>{u.set_class(d,1,`badge text-bg${u.get(n)??""}-${I.mk.ACTIVE&&s===u.get(G)?"primary":"secondary"}`),u.set_text(c,e),u.set_text(v,` ${u.get(t).handSize??""}`)},[()=>Y().formatPlayerName(u.get(t))]),u.append(e,r)},e=>{var t=eY();u.append(e,t)}),u.reset(b),y=u.sibling(b,4),u.each(y,21,()=>u.get(j),u.index,(e,t,s)=>{let i=u.derived(()=>u.get(t).isMe?"":"-outline");var n=eF(),r=u.child(n),a=u.sibling(r),o=u.child(a,!0);u.reset(a);var l=u.sibling(a);u.reset(n),u.template_effect(e=>{u.set_text(r,`#${s+(s>=Y().discIndex?1+u.get(W).length:1)}: `),u.set_class(a,1,`badge text-bg${u.get(i)??""}-${u.get(t).handSize?"danger":"success"}`),u.set_text(o,u.get(t).ownerName),u.set_text(l,` (${u.get(t).handSize?"left "+u.get(t).handSize:"won"}) on trick ${u.get(t).trickNum??""} in ${e??""}`)},[()=>(0,x.a3)(u.get(t).duration)]),u.append(e,n)},e=>{var t=ez();u.append(e,t)}),u.reset(y),u.reset(C),R=u.sibling(C,2),M=u.child(R),T={get moves(){return u.get(q)}},u.push(T,!0),X=u.state(!0),N=eg(),E=u.sibling(u.first_child(N),2),A=u.child(E),u.remove_input_defaults(A),u.next(2),u.reset(E),w=u.sibling(E,2),u.each(w,21,()=>T.moves,u.index,(e,t)=>{let s;var i=em(),n=u.first_child(i),r=u.child(n),a=e=>{var s=u.text();u.template_effect(()=>u.set_text(s,`[${u.get(t).trick??""}:${u.get(t).turn??""} end${u.get(t).move?" by pass":""}]`)),u.append(e,s)},o=e=>{var s=u.comment(),i=u.first_child(s),n=e=>{let s=u.derived(()=>u.get(t).playerIsMe?"":"-outline");var i=el(),n=u.first_child(i),r=u.child(n,!0);u.reset(n);var a=u.sibling(n,2),o=u.child(a,!0);u.reset(a);var l=u.sibling(a),d=e=>{var s=u.text();u.template_effect(()=>u.set_text(s,` \xd7${u.get(t).count??""}`)),u.append(e,s)};u.if(l,e=>{1n!=u.get(t).count&&e(d)}),u.next(),u.template_effect(()=>{u.set_class(n,1,`badge text-bg${u.get(s)??""}-primary`),u.set_text(r,u.get(t).playerName),u.set_text(o,ev[u.get(t).rank])}),u.append(e,i)},r=e=>{var s=u.comment(),i=u.first_child(s),n=e=>{let s=u.derived(()=>u.get(t).playerIsMe?"":"-outline");var i=ed(),n=u.first_child(i),r=u.child(n,!0);u.reset(n),u.next(),u.template_effect(()=>{u.set_class(n,1,`badge text-bg${u.get(s)??""}-primary`),u.set_text(r,u.get(t).playerName)}),u.append(e,i)},r=e=>{var s=u.comment(),i=u.first_child(s),n=e=>{let s=u.derived(()=>u.get(t).playerIsMe?"":"-outline"),i=u.derived(()=>u.get(t).victimIsMe?"":"-outline");var n=ec(),r=u.first_child(n),a=u.child(r,!0);u.reset(r);var o=u.sibling(r,2),l=u.child(o,!0);u.reset(o),u.next(),u.template_effect(()=>{u.set_class(r,1,`badge text-bg${u.get(s)??""}-success`),u.set_text(a,u.get(t).playerName),u.set_class(o,1,`badge text-bg${u.get(i)??""}-danger`),u.set_text(l,u.get(t).victimName)}),u.append(e,n)},r=e=>{var s=u.comment(),i=u.first_child(s),n=e=>{let s=u.derived(()=>u.get(t).playerIsMe?"":"-outline");var i=ep(),n=u.first_child(i),r=u.child(n,!0);u.reset(n),u.next(),u.template_effect(()=>{u.set_class(n,1,`badge text-bg${u.get(s)??""}-danger`),u.set_text(r,u.get(t).playerName)}),u.append(e,i)},r=e=>{var s=u.comment(),i=u.first_child(s),n=e=>{var s=eh(),i=u.first_child(s);ee(u.sibling(i),{get ranks(){return ev},get cards(){return u.get(t).cards}}),u.template_effect(()=>u.set_text(i,`${{play:"You played",penalty:"You took",reveal:"Previous move",reveal2:"Cards under previous move"}[u.get(t).type]??""}: `)),u.append(e,s)},r=e=>{var s=u.comment(),i=u.first_child(s),n=e=>{let s=u.derived(()=>u.get(t).playerIsMe?"":"-outline");var i=eu(),n=u.first_child(i),r=u.child(n,!0);u.reset(n);var a=u.sibling(n);u.template_effect(()=>{u.set_class(n,1,`badge text-bg${u.get(s)??""}-secondary`),u.set_text(r,u.get(t).playerName),u.set_text(a,` left, discarding \xd7${u.get(t).handSize??""}.`)}),u.append(e,i)},r=e=>{var s=u.text();u.template_effect(()=>u.set_text(s,`[unknown move ${u.get(t)??""}]`)),u.append(e,s)};u.if(i,e=>{"leave"==u.get(t).type?e(n):e(r,!1)},!0),u.append(e,s)};u.if(i,e=>{"play"==u.get(t).type||"penalty"==u.get(t).type||"reveal"==u.get(t).type||"reveal2"==u.get(t).type?e(n):e(r,!1)},!0),u.append(e,s)};u.if(i,e=>{"callFail"==u.get(t).type?e(n):e(r,!1)},!0),u.append(e,s)};u.if(i,e=>{"callSuccess"==u.get(t).type?e(n):e(r,!1)},!0),u.append(e,s)};u.if(i,e=>{"pass"==u.get(t).type?e(n):e(r,!1)},!0),u.append(e,s)};u.if(i,e=>{"move"==u.get(t).type?e(n):e(r,!1)},!0),u.append(e,s)};u.if(r,e=>{"tEnd"==u.get(t).type?e(a):e(o,!1)}),u.reset(n),u.sibling(n).nodeValue="  ",u.template_effect(e=>s=u.set_class(n,1,"",null,s,e),[()=>({"d-inline-block":u.get(X)})]),u.append(e,i)},e=>{u.next();var t=u.text("No moves yet!");u.append(e,t)}),u.reset(w),u.bind_checked(A,()=>u.get(X),e=>u.set(X,e)),u.append(M,N),u.pop(),u.reset(R),O=u.sibling(R,2),P=u.child(O),L=e=>{var t=eW(),s=u.first_child(t),i=u.sibling(u.child(s));{let e=u.derived(()=>[["Hand",Y().cardCountHandMine],["Played",Y().cardCountAllMine.map((e,t)=>e-Y().cardCountHandMine[t])],["Yours",Y().cardCountAllMine]]);er(i,{get ranks(){return ev},get counts(){return u.get(e)}})}u.reset(s);var n=u.sibling(s,2),r=u.sibling(u.child(n));{let e=u.derived(()=>[["Yours",Y().cardCountAllMine],["Others",Y().cardCountTotal.map((e,t)=>e-Y().cardCountAllMine[t])],["Total",Y().cardCountTotal]]);er(r,{get ranks(){return ev},get counts(){return u.get(e)}})}u.reset(n);var a=u.sibling(n,2),o=u.sibling(u.child(a));{let e=u.derived(()=>[["Your Claim",Y().cardCountClaimMine],["Others Claim",Y().cardCountClaimOthers],["Remaining Claim",Y().cardCountClaimRemain],["Total",Y().cardCountTotal]]);er(o,{get ranks(){return ev},get counts(){return u.get(e)}})}u.reset(a),u.append(e,t)},D=e=>{{let t=u.derived(()=>[["Others Claim",Y().cardCountClaimOthers],["Remaining Claim",Y().cardCountClaimRemain],["Total",Y().cardCountTotal]]);er(e,{get ranks(){return ev},get counts(){return u.get(t)}})}},u.if(P,e=>{u.get(z)===I.mk.ACTIVE&&u.get(J)?e(L):e(D,!1)}),$=u.sibling(P,2),U=e=>{{let t=u.derived(()=>u.get(W).map(e=>[Y().formatPlayerName(e),e.discardClaim]));er(e,{get ranks(){return ev},get counts(){return u.get(t)}})}},u.if($,e=>{u.get(W).length&&e(U)}),u.reset(O),u.reset(l),V=u.sibling(l,2),H=u.child(V),u.reset(V),B=u.sibling(V,4),(0,eo.A)(B,{get localClient(){return Y().localClient},get inGame(){return Y().roundPlayers},get inQueue(){return Y().roundPlayerQueue}}),u.template_effect(e=>{u.set_text(m,`Trick ${Y().trickNum??""} `),u.set_text(H,`Game Mode: ${e??""}`)},[()=>S(Y().mode)]),u.append(e,i),u.pop()},$$slots:{default:!0}})}var T=u.sibling(M,2),N=u.child(T),E=u.child(N);(0,v.A)(E,{get canClear(){return u.get(r).length},onClear:()=>n.clearHistory(),children:(e,t)=>{var s,i;s={get results(){return u.get(r)}},u.push(s,!0),i=W(),u.each(i,21,()=>s.results,u.index,(e,t)=>{var s=F(),i=u.child(s),n=u.child(i),r=u.sibling(n);u.each(r,17,()=>u.get(t).players,u.index,(e,t,s)=>{u.next();var i=Y(),n=u.first_child(i);n.nodeValue="  ";var r=u.sibling(n),a=u.child(r);a.nodeValue=`#${s+1} `;var o=u.sibling(a);u.set_class(o,1,`badge text-bg-${s?"secondary":"primary"}`);var l=u.child(o,!0);u.reset(o);var d=u.sibling(o);u.reset(r),u.template_effect(e=>{u.set_text(l,u.get(t).name),u.set_text(d,` (on ${u.get(t).trickNum??""} in ${e??""})`)},[()=>(0,x.a3)(u.get(t).duration)]),u.append(e,i)}),u.reset(i),u.reset(s),u.template_effect(e=>u.set_text(n,`Trick ${u.get(t).trickNum??""} in ${e??""}: `),[()=>(0,x.a3)(u.get(t).duration)]),u.append(e,s)},e=>{var t=z();u.append(e,t)}),u.reset(i),u.append(e,i),u.pop()},$$slots:{default:!0}});var A=u.sibling(E,2);(0,_.A)(A,{get leaderboard(){return u.get(a)},get localClient(){return u.get(o)},columns:[["Score",e=>e.score],["Wins",e=>e.wins],["Loss",e=>e.losses],["Streak",e=>e.streak],["Best Rank",e=>e.rankBest],["Worst Rank",e=>e.rankWorst],["Last Rank",e=>e.rankLast]]}),u.reset(N);var O=u.sibling(N,2),P=u.child(O);(0,m.A)(P,{get chatState(){return i},onInput:e=>(0,g.Oo)(n,e)}),u.reset(O),u.reset(T),u.append(e,c),u.pop()})},131:function(e,t,s){s.d(t,{M0:()=>l,a3:()=>d,iq:()=>n,iw:()=>r,yh:()=>o,yn:()=>a});var i=s(132);let n=64;function r(e){return(e=e.replace(/[^a-zA-Z_ ]/,"").replace(/ {2,}/," ").trim().slice(0,20))||"unnamed"}function a(){let e=new i.k(new Uint8Array([0,1,2,3,4,5,6,7]));console.log("%cMultiplayer Game Bug Report Guide","font-family:helvetica; font-size:20px"),console.log("You're probably trying to debug a network error or file a bug report for it."),console.log("If you see an error like this, your report must contain the packet values:"),console.log("example",e.debugBuf,e),console.log("In the example above, you would have to submit at least [0, 1, 2, 3, 4, 5, 6, 7] (expand stuff as needed)")}function o(e,t){let s=e.filter(e=>e).sort((e,s)=>{for(let i of t){let t=i(e),n=i(s);if(t<n)return 1;if(t>n)return -1}return e.cn-s.cn}),i=1;return s.forEach((e,n)=>{if(n){let r=s[n-1];t.some(t=>t(e)!==t(r))&&(i=n+1)}s[n].rank=i}),s.sort((e,t)=>t.active-e.active)}function l(e,t){return e?`${e.name} (${e.cn})`:`<unknown${void 0===t?"":` (${t})`}>`}function d(e){let t=Number(e%1000n);return`${e/1000n}${(t/1e3+"").slice(1)}s`}},2:function(e,t,s){s.r(t),s.d(t,{CLASS:()=>A.tp,FILENAME:()=>n.Uh,HMR:()=>n.OM,NAMESPACE_SVG:()=>n.pQ,STYLE:()=>A.Y,aborted:()=>ee.QH,action:()=>N.X,active_effect:()=>eo.Fg,add_legacy_event_listener:()=>j.oe,add_locations:()=>l.D,add_svelte_meta:()=>r.G7,animation:()=>L.l,append:()=>q.BC,append_styles:()=>T.k,apply:()=>S.Bb,assign:()=>a.kp,assign_and:()=>a._R,assign_nullish:()=>a.Sc,assign_or:()=>a.im,async:()=>m.b,async_body:()=>Q.cZ,async_derived:()=>X.zx,attach:()=>E.K,attachment:()=>i.r,attr:()=>eu.CF,attribute_effect:()=>A.p_,autofocus:()=>O.wC,await:()=>v.x,bind_active_element:()=>D.m,bind_buffered:()=>U.w$,bind_checked:()=>$.mS,bind_content_editable:()=>z.b1,bind_current_time:()=>U.M$,bind_element_size:()=>Y.B,bind_ended:()=>U.$T,bind_files:()=>$.md,bind_focused:()=>z.oP,bind_group:()=>$.CJ,bind_muted:()=>U.iX,bind_online:()=>V.s,bind_paused:()=>U.lY,bind_playback_rate:()=>U.hc,bind_played:()=>U.YL,bind_prop:()=>H.E,bind_property:()=>z.IY,bind_ready_state:()=>U.mM,bind_resize_observer:()=>Y.y,bind_seekable:()=>U.xx,bind_seeking:()=>U.Je,bind_select_value:()=>B.$t,bind_this:()=>F.L,bind_value:()=>$.oJ,bind_volume:()=>U.Jo,bind_window_scroll:()=>W.f,bind_window_size:()=>W.r,boundary:()=>en.pP,bubble_event:()=>j.Ib,check_target:()=>p.X,child:()=>eh.jf,cleanup_styles:()=>o.O,clsx:()=>eu.$z,comment:()=>q.Im,component:()=>x.s,create_custom_element:()=>ep.Q,create_ownership_validator:()=>c.a,css_props:()=>k.d,deep_read:()=>eo.o1,deep_read_state:()=>eo.iT,delegate:()=>S.Mm,derived:()=>X.eO,derived_safe_equal:()=>X.Xd,document:()=>eh.gk,each:()=>C.__,effect:()=>ee.QZ,effect_root:()=>ee.Fc,effect_tracking:()=>ee.oJ,element:()=>R.N,equals:()=>e_.aI,event:()=>S.f0,exclude_from_object:()=>eo.SE,fallback:()=>eg.Np,first_child:()=>eh.es,flush:()=>Z.qX,for_await_track_reactivity_loss:()=>Q.IP,from_html:()=>q.vU,from_mathml:()=>q.$N,from_svg:()=>q._i,from_tree:()=>q.el,get:()=>eo.Jt,head:()=>M.d,hmr:()=>d.c,html:()=>b.q,hydrate_template:()=>G.PK,if:()=>_.A,index:()=>C.Pe,init:()=>K.T,init_select:()=>B.wf,inspect:()=>u.N,invalid_default_snippet:()=>ev.y8,invalidate_inner_signals:()=>er.p,invalidate_store:()=>ei.qB,invoke_error_boundary:()=>ek.n,key:()=>f.E,legacy_api:()=>p.j,legacy_pre_effect:()=>ee.M3,legacy_pre_effect_reset:()=>ee.iq,legacy_rest_props:()=>es.gj,log_if_contains_state:()=>ef.f,mark_store_binding:()=>ei.io,mutable_source:()=>et.zg,mutate:()=>et.Tk,next:()=>G.K2,noop:()=>eg.lQ,once:()=>J.Oo,pending:()=>en.Ub,pop:()=>r.uY,preventDefault:()=>J.wo,prevent_snippet_stringification:()=>ev.bk,prop:()=>es._w,props_id:()=>q.zA,proxy:()=>ec.B,push:()=>r.VC,raf:()=>ed.e,reactive_import:()=>j.Iu,remove_input_defaults:()=>A.R0,remove_textarea_child:()=>O.VU,render_effect:()=>ee.VB,replay_events:()=>S.ES,reset:()=>G.cL,rest_props:()=>es.iR,safe_get:()=>eo.$i,sanitize_slots:()=>I.i,save:()=>Q.UN,select_option:()=>B.fs,self:()=>J.bg,set:()=>et.hZ,set_attribute:()=>A.aI,set_checked:()=>A.BY,set_class:()=>w.y,set_custom_element_data:()=>A.p,set_default_checked:()=>A.V$,set_default_value:()=>A.xp,set_selected:()=>A.$Z,set_style:()=>P.h,set_text:()=>ea.j,set_value:()=>A.to,set_xlink_attribute:()=>A.To,setup_stores:()=>ei.DZ,sibling:()=>eh.hg,slot:()=>I.N,snapshot:()=>em.P,snippet:()=>y.UA,spread_props:()=>es.Du,state:()=>et.wk,stopImmediatePropagation:()=>J.CA,stopPropagation:()=>J.dG,store_get:()=>ei.Hz,store_mutate:()=>ei.hY,store_set:()=>ei.fT,store_unsub:()=>ei.QK,strict_equals:()=>e_.IP,tag:()=>h.Tc,tag_proxy:()=>h._e,template_effect:()=>ee.vN,text:()=>q.Qq,tick:()=>eo.io,to_array:()=>eg._N,trace:()=>h.uP,track_reactivity_loss:()=>Q.t_,transition:()=>L.k,trusted:()=>J.IZ,untrack:()=>eo.vz,update:()=>et.yo,update_legacy_props:()=>j.hp,update_pre:()=>et.cE,update_pre_prop:()=>es.CB,update_pre_store:()=>ei.IL,update_prop:()=>es.k$,update_store:()=>ei.yb,user_effect:()=>ee.MW,user_pre_effect:()=>ee.Go,validate_binding:()=>el.R,validate_dynamic_element_tag:()=>ev.Bm,validate_each_keys:()=>el.e,validate_snippet_args:()=>g.j,validate_store:()=>ev.T3,validate_void_dynamic_element:()=>ev.zA,window:()=>eh.Lk,with_script:()=>q.jB,wrap_snippet:()=>y.DK});var i=s(3),n=s(4),r=s(22),a=s(42),o=s(43),l=s(44),d=s(45),c=s(46),p=s(47),h=s(20),u=s(48),m=s(49),g=s(105),v=s(50),_=s(51),f=s(52),k=s(53),C=s(54),b=s(55),I=s(56),y=s(39),x=s(57),R=s(58),M=s(35),T=s(59),N=s(60),E=s(61),A=s(62),w=s(64),S=s(34),O=s(31),P=s(65),L=s(67),D=s(70),$=s(71),U=s(72),V=s(73),H=s(74),B=s(66),Y=s(75),F=s(76),z=s(77),W=s(78),G=s(13),J=s(79),K=s(80),j=s(81),q=s(36),Q=s(29),Z=s(23),X=s(26),ee=s(8),et=s(17),es=s(82),ei=s(83),en=s(27),er=s(32),ea=s(33),eo=s(6),el=s(86),ed=s(68),ec=s(16),ep=s(87),eh=s(12),eu=s(63),em=s(21),eg=s(7),ev=s(40),e_=s(15),ef=s(89),ek=s(25)}},r={};function a(e){var t=r[e];if(void 0!==t)return t.exports;var s=r[e]={exports:{}};return n[e](s,s.exports,a),s.exports}a.m=n,a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e=[],a.O=(t,s,i,n)=>{if(s){n=n||0;for(var r=e.length;r>0&&e[r-1][2]>n;r--)e[r]=e[r-1];e[r]=[s,i,n];return}for(var o=1/0,r=0;r<e.length;r++){for(var[s,i,n]=e[r],l=!0,d=0;d<s.length;d++)(!1&n||o>=n)&&Object.keys(a.O).every(e=>a.O[e](s[d]))?s.splice(d--,1):(l=!1,n<o&&(o=n));if(l){e.splice(r--,1);var c=i();void 0!==c&&(t=c)}}return t},a.rv=()=>"1.5.8",t={81:0},a.O.j=e=>0===t[e],s=(e,s)=>{var i,n,[r,o,l]=s,d=0;if(r.some(e=>0!==t[e])){for(i in o)a.o(o,i)&&(a.m[i]=o[i]);if(l)var c=l(a)}for(e&&e(s);d<r.length;d++)n=r[d],a.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return a.O(c)},(i=self.webpackChunkvwww=self.webpackChunkvwww||[]).forEach(s.bind(null,0)),i.push=s.bind(null,i.push.bind(i)),a.ruid="bundler=rspack@1.5.8";var o=a.O(void 0,["11","17","34","36","35","33"],function(){return a(137)});o=a.O(o)})();