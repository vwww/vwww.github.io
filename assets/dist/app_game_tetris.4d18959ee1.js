(()=>{"use strict";var e,t,r,s,a={163(e,t,r){let s;r(1);var a=r(2);function l(e,t,r=!1){let s=a.state(a.proxy(t));function n(e){return"undefined"===e?void 0:JSON.parse(e)}if(window.localStorage){let l=localStorage.getItem(e);null!==l&&a.set(s,n(l),!0),a.user_effect(()=>localStorage.setItem(e,void 0===a.get(s)?"undefined":JSON.stringify(a.get(s)))),r&&window.addEventListener("storage",r=>r.storageArea===localStorage&&r.key===e&&a.set(s,null==r.newValue?t:n(r.newValue),!0))}return{get value(){return a.get(s)},set value(newVal){a.set(s,newVal,!0)}}}var n=a.from_html('<div role="progressbar"></div>');function o(e,t){let r=a.derived(()=>Math.max(t.moment,0)/t.momentMax*100),s=a.derived(()=>20>=a.get(r)?"bg-success":40>=a.get(r)?"bg-info":60>=a.get(r)?"":80>=a.get(r)?"bg-warning":"bg-danger");var l=n();a.set_attribute(l,"aria-valuemin",0),a.template_effect(()=>{a.set_class(l,1,`progress-bar progress-bar-striped progress-bar-animated ${a.get(s)??""}`),a.set_attribute(l,"aria-valuenow",t.moment),a.set_attribute(l,"aria-valuemax",t.momentMax),a.set_style(l,`width: ${a.get(r)??""}%`)}),a.append(e,l)}let i=[[[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]],[[0,0,0,0],[0,0,0,0],[1,1,1,1],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]],[[[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]]],[[[0,0,1,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,1,0],[0,0,0,0]],[[0,0,0,0],[1,1,1,0],[1,0,0,0],[0,0,0,0]],[[1,1,0,0],[0,1,0,0],[0,1,0,0],[0,0,0,0]]],[[[1,0,0,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],[[0,1,1,0],[0,1,0,0],[0,1,0,0],[0,0,0,0]],[[0,0,0,0],[1,1,1,0],[0,0,1,0],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[1,1,0,0],[0,0,0,0]]],[[[0,1,0,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],[[0,1,0,0],[0,1,1,0],[0,1,0,0],[0,0,0,0]],[[0,0,0,0],[1,1,1,0],[0,1,0,0],[0,0,0,0]],[[0,1,0,0],[1,1,0,0],[0,1,0,0],[0,0,0,0]]],[[[1,1,0,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],[[0,0,1,0],[0,1,1,0],[0,1,0,0],[0,0,0,0]],[[0,0,0,0],[1,1,0,0],[0,1,1,0],[0,0,0,0]],[[0,1,0,0],[1,1,0,0],[1,0,0,0],[0,0,0,0]]],[[[0,1,1,0],[1,1,0,0],[0,0,0,0],[0,0,0,0]],[[0,1,0,0],[0,1,1,0],[0,0,1,0],[0,0,0,0]],[[0,0,0,0],[0,1,1,0],[1,1,0,0],[0,0,0,0]],[[1,0,0,0],[1,1,0,0],[0,1,0,0],[0,0,0,0]]]];var g=a.from_html("<td></td>"),c=a.from_html('<tr class="svelte-gm3z5y"></tr>'),d=a.from_html('<td class="svelte-gm3z5y"></td>'),u=a.from_html('<tr class="svelte-gm3z5y"></tr>'),v=a.from_html('<div class="btn-group d-flex svelte-gm3z5y" role="group"><button class="btn btn-outline-primary w-100 svelte-gm3z5y">New Game</button> <button>Pause</button> <button>Ghost Piece</button> <button>Speedup</button></div> <p class="svelte-gm3z5y"> </p> <table class="svelte-gm3z5y"><tbody class="svelte-gm3z5y"></tbody></table> <div class="d-flex my-3 svelte-gm3z5y"><div class="progress w-50 svelte-gm3z5y" style="transform: scaleX(-1)"><!></div> <div class="progress w-50 svelte-gm3z5y"><!></div></div> <table class="svelte-gm3z5y"><tbody class="svelte-gm3z5y"></tbody></table>',1);let m={hash:"svelte-gm3z5y",code:"table.svelte-gm3z5y {margin:auto;}td.svelte-gm3z5y {width:3vmin;height:3vmin;&.ghost {opacity:0.2;}&.ghostLine {\n    animation: svelte-gm3z5y-blinker 0.5s linear infinite;}}\n\n@keyframes svelte-gm3z5y-blinker {\n  50% {\n    opacity: 0.4;\n  }\n}"};a.delegate(["click"]);var f=r(5);s=document.getElementById("app"),(0,f.Or)(function(e,t){a.push(t,!0),a.append_styles(e,m);let r=["#000","red","orangered","orange","yellow","chartreuse","yellowgreen","lime","limegreen","darkgreen","aquamarine","magenta","orchid"],s=l("game/sp/tetris/showGhost",!0),n=l("game/sp/tetris/speedup",!0),f=l("game/sp/tetris/highscore",0),p=[...i],h=a.state(0),b=a.derived(()=>p[a.get(h)][0]),y=a.state((Math.random()*(r.length-1)|0)+1),w=a.state(!1),_=a.state(!1),k=0,z=a.proxy(Array.from({length:20},()=>Array(10).fill(0))),x=a.state(0),O=a.state(0),$=a.state(0),M=!1,S=!1,A=!1,P=!1,L=a.state(-1),C=-1,j=a.state(-1),E=a.state(-1),G=a.state(20),I=a.state(void 0),K=a.state(-1),T=a.state(-1);function D(){a.set(w,!1),clearTimeout(k),k=0}function N(){let e;C=0,a.set(j,7*Math.random()|0),a.set(I,(e=p[a.get(h)],a.update(h),a.get(h)===p.length&&(a.set(h,0),function(e,t=0,r=e.length){for(let s=r-1-t;s!==t;--s){let r=Math.floor(Math.random()*(s+1)),a=e[t+s];e[t+s]=e[t+r],e[t+r]=a}}(p)),e),!0),a.set(K,0),a.set(T,a.get(y),!0),a.set(y,(Math.random()*(r.length-1)|0)+1),B(),V(),a.get(E)||D()}function W(){let e=C;for(let t=0;t<4;t++,e++){let r=e<0||e>=20,s=a.get(j);for(let l=0;l<4;l++,s++){let n=s<0||s>=10;if((r||n||0!==z[e][s])&&a.get(I)[a.get(K)][t][l])return!1}}return!0}function B(){let e=C;do if(C++,!W()){C--;break}while(C<20);for(a.set(E,C,!0),V(),a.set(G,20);a.get(G)&&z[a.get(G)-1].every(e=>0!==e);)a.update(G,-1);J(0),C=e}function J(e){let t=C;for(let r=0;r<4;r++,t++){if(t<0||t>=20)continue;let s=a.get(j);for(let l=0;l<4;l++,s++)s<0||s>=10||!a.get(I)[a.get(K)][r][l]||(z[t][s]=e)}}function V(){J(a.get(T))}function q(){a.get(_)||(n.value&&(a.set(L,a.get(L)-25e-6*(a.get(L)*a.get(L))),1>a.get(L)&&a.set(L,1)),k=window.setTimeout(q,0|a.get(L)),function(){a.set(O,a.get(O)+1),J(0);let e=!1;A&&(a.set(K,(a.get(K)+1)%a.get(I).length),W()?e=!0:a.set(K,(a.get(K)||a.get(I).length)-1)),M!==S&&(a.set(j,a.get(j)+(M?-1:1)),W()?e=!0:a.set(j,a.get(j)+(M?1:-1))),e&&B();let t=a.get(E)-C;if(C+=Math.min(t,P?3:1),V(),!t&&!e){let e=C;for(let t=0;t<4;t++,e++){if(e<0||e>=20)continue;let r=a.get(j);for(let e=0;e<4;e++,r++)r<0||r>=10||!a.get(I)[a.get(K)][t][e]||a.set(x,a.get(x)+(5-r-(r>=5)))}a.set(O,a.get(O)+100);let t=19;for(let e=t;-1!==e;e--)if(z[e].every(e=>0!==e))a.set(O,a.get(O)+1e3),a.update($);else{if(t!==e)for(let r=0;r<10;r++)z[t][r]=z[e][r];t--}for(;-1!==t;t--)for(let e=0;e<10;e++)z[t][e]=0;(-69>a.get(x)||a.get(x)>69?D:N)()}f.value<a.get(O)&&(f.value=a.get(O))}())}function H(e,t){if(!e.defaultPrevented){switch(e.code){case"KeyS":case"ArrowDown":P=t;break;case"KeyW":case"ArrowUp":A=t;break;case"KeyA":case"ArrowLeft":M=t;break;case"KeyD":case"ArrowRight":S=t;break;default:return}e.preventDefault()}}var R=v();a.event("keyup",a.window,e=>H(e,!1)),a.event("keydown",a.window,e=>H(e,!0));var U=a.first_child(R),X=a.child(U);X.__click=function(){for(let e=0;e<20;e++){let t=z[e];for(let e=0;e<10;e++)t[e]=0}a.set(x,0),a.set(O,0),a.set($,0),a.set(w,!0),a.set(_,!1),N(),k&&clearTimeout(k),k=window.setTimeout(q,0),a.set(L,200)};var F=a.sibling(X,2);F.__click=function(){a.set(_,!a.get(_)),!a.get(_)&&a.get(w)&&q()};var Q=a.sibling(F,2);Q.__click=()=>s.value=!s.value;var Y=a.sibling(Q,2);Y.__click=()=>n.value=!n.value,a.reset(U);var Z=a.sibling(U,2),ee=a.child(Z);a.reset(Z);var et=a.sibling(Z,2),er=a.child(et);a.each(er,21,()=>z,a.index,(e,t,l)=>{var n=c();a.each(n,21,()=>a.get(t),a.index,(e,t,n)=>{let o,i=a.derived(()=>s.value&&!a.get(t)&&function(e,t,r,s,a,l){if(z[a][l]||!e)return!1;let n=e[t],o=a-r;if(o<0||o>=n.length)return!1;let i=n[o],g=l-s;return!(g<0)&&!(g>=i.length)&&!!i[g]}(a.get(I),a.get(K),a.get(E),a.get(j),l,n));var c=g();a.template_effect(()=>{a.set_style(c,`background-color:${r[a.get(t)||(a.get(i)?a.get(T):0)]??""}`),o=a.set_class(c,1,"svelte-gm3z5y",null,o,{ghost:a.get(i),ghostLine:s.value&&l>=a.get(G)})}),a.append(e,c)}),a.reset(n),a.append(e,n)}),a.reset(er),a.reset(et);var es=a.sibling(et,2),ea=a.child(es);o(a.child(ea),{get moment(){return a.get(x)},momentMax:69}),a.reset(ea);var el=a.sibling(ea,2),en=a.child(el);{let e=a.derived(()=>-a.get(x));o(en,{get moment(){return a.get(e)},momentMax:69})}a.reset(el),a.reset(es);var eo=a.sibling(es,2),ei=a.child(eo);a.each(ei,21,()=>a.get(b),a.index,(e,t)=>{var s=u();a.each(s,21,()=>a.get(t),a.index,(e,t)=>{var s=d();a.template_effect(()=>a.set_style(s,`background-color:${r[a.get(t)?a.get(y):0]??""}`)),a.append(e,s)}),a.reset(s),a.append(e,s)}),a.reset(ei),a.reset(eo),a.template_effect(e=>{a.set_class(F,1,`btn w-100 btn-${a.get(_)?"":"outline-"}warning`,"svelte-gm3z5y"),a.set_class(Q,1,`btn w-50 btn-${s.value?"":"outline-"}success`,"svelte-gm3z5y"),a.set_class(Y,1,`btn w-50 btn-${n.value?"primary":"outline-secondary"}`,"svelte-gm3z5y"),a.set_text(ee,`(${e??""}) |
  Score: ${a.get(O)??""} | High Score: ${f.value??""} | Lines cleared: ${a.get($)??""} | Moment: ${!a.get(x)?"0":a.get(x)>0?a.get(x)+" CCW":-a.get(x)+" CW"} (69 max)`),a.set_style(et,`backface-visibility: hidden; transform: rotate(${-a.get(x)/69*45}deg)`)},[()=>a.get(w)?a.get(_)?"Paused":(200/(0|a.get(L))).toPrecision(3)+"x":"Game over"]),a.append(e,R),a.pop()},{target:s}),document.getElementById("appLoading")?.remove()}},l={};function n(e){var t=l[e];if(void 0!==t)return t.exports;var r=l[e]={exports:{}};return a[e](r,r.exports,n),r.exports}n.m=a,n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e=[],n.O=(t,r,s,a)=>{if(r){a=a||0;for(var l=e.length;l>0&&e[l-1][2]>a;l--)e[l]=e[l-1];e[l]=[r,s,a];return}for(var o=1/0,l=0;l<e.length;l++){for(var[r,s,a]=e[l],i=!0,g=0;g<r.length;g++)(!1&a||o>=a)&&Object.keys(n.O).every(e=>n.O[e](r[g]))?r.splice(g--,1):(i=!1,a<o&&(o=a));if(i){e.splice(l--,1);var c=s();void 0!==c&&(t=c)}}return t},n.rv=()=>"1.7.3",t={106:0},n.O.j=e=>0===t[e],r=(e,r)=>{var s,a,[l,o,i]=r,g=0;if(l.some(e=>0!==t[e])){for(s in o)n.o(o,s)&&(n.m[s]=o[s]);if(i)var c=i(n)}for(e&&e(r);g<l.length;g++)a=l[g],n.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return n.O(c)},(s=self.webpackChunkvwww=self.webpackChunkvwww||[]).forEach(r.bind(null,0)),s.push=r.bind(null,s.push.bind(s)),n.ruid="bundler=rspack@1.7.3";var o=n.O(void 0,["1","2","5","3","9","10","7","6","56","52","55"],()=>n(163));o=n.O(o)})();